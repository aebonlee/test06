<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Permissions-Policy" content="notifications()">
    <title>SSALWorks Dashboard - 프로젝트 관리</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Main Theme - Organic Growth: Emerald Green */
            --primary: #10B981;
            --primary-dark: #059669;

            /* Secondary Theme - Organic Growth: Amber Gold */
            --secondary: #F59E0B;
            --secondary-dark: #D97706;

            /* Tertiary Theme - Organic Growth: Navy Blue */
            --tertiary: #2C4A8A;
            --tertiary-dark: #1F3563;

            /* Status Colors */
            --success: #10B981;
            --warning: #ffc107;
            --danger: #EF4444;
            --info: #3B82F6;
            --neutral: #64748B;

            /* Background */
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
            --border-color: #dee2e6;

            /* Misc */
            --border-radius: 8px;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        /* Footer Styles */
        .footer {
            width: 100%;
            background: white;
            border-top: 1px solid var(--border-color);
            font-size: 12px;
            color: #495057;
            z-index: 10;
        }

        .footer-inner {
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 32px;
        }

        .footer-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .footer-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #f1f3f5;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            color: #495057;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .footer-btn:hover {
            background: #e9ecef;
            color: var(--primary);
            border-color: var(--primary);
        }

        .footer-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        body {
            font-family: 'Malgun Gothic', '맑은 고딕', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #212529;
            background: var(--bg-light);
            margin: 0;
            padding: 0;
        }

        /* ========== Typography Hierarchy ========== */
        /* H1: 로고 (SSAL Works) - 최상위 등급 */
        h1 {
            font-size: 26px;
            font-weight: 800;
            line-height: 1.2;
            color: white;
            margin: 0;
            letter-spacing: -0.5px;
        }

        /* H2: 워크스페이스, 프로젝트, SAL Grid 등 주요 섹션 타이틀 */
        h2 {
            font-size: 20px;
            font-weight: 700;
            line-height: 1.3;
            color: var(--primary-dark);
            margin-bottom: 16px;
            letter-spacing: -0.3px;
        }

        /* H3: 사이드바 1단계 (Project, 진행 프로세스, 학습용 콘텐츠 등), 헤더 태그라인 */
        h3 {
            font-size: 14px;
            font-weight: 700;
            line-height: 1.4;
            color: #495057;
            margin-bottom: 12px;
        }

        /* H4: 사이드바 2단계 (사업계획, 기획 등), 헤더/푸터 버튼 */
        h4 {
            font-size: 13px;
            font-weight: 700;
            line-height: 1.5;
            color: #495057;
            margin-bottom: 8px;
        }

        /* H5: 사이드바 3단계, 강조 텍스트 */
        h5 {
            font-size: 12px;
            font-weight: 700;
            line-height: 1.5;
            color: #495057;
            margin-bottom: 6px;
        }

        /* H6: 사이드바 4단계, 설명 텍스트, 워크스페이스 버튼, 프로세스 퍼센트 */
        h6 {
            font-size: 12px;
            font-weight: 500;
            line-height: 1.5;
            color: #495057;
            margin-bottom: 4px;
        }

        /* ========== Layout Grid ========== */
        .page-wrapper {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .layout-container {
            display: grid;
            grid-template-columns: 220px minmax(500px, 900px) 280px;
            flex: 1;
            gap: 0;
            width: 100%;
            justify-content: center;
        }

        /* ========== Header ========== */
        .header {
            width: 100%;
            background: linear-gradient(135deg, var(--tertiary) 0%, var(--tertiary-dark) 100%);
            color: white;
            box-shadow: var(--shadow-md);
            z-index: 100;
            position: relative;
        }

        .header-inner {
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            height: 70px;
        }

        .logo {
            font-size: 28px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Segoe UI', 'Arial', sans-serif;
            letter-spacing: -0.5px;
        }

        .rice-logo {
            display: flex;
            align-items: center;
            gap: 3px;
            transform: rotate(-15deg);
        }

        .rice-grain {
            width: 10px;
            height: 18px;
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            border-radius: 40%;
            box-shadow: 0 2px 4px rgba(217, 119, 6, 0.4), inset 0 1px 2px rgba(255, 255, 255, 0.3);
            display: inline-block;
        }

        .rice-grain:nth-child(1) {
            transform: rotate(-5deg);
        }

        .rice-grain:nth-child(2) {
            transform: rotate(5deg);
            margin-top: 2px;
        }

        .rice-grain:nth-child(3) {
            transform: rotate(-3deg);
            margin-top: -1px;
        }

        .header-center {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .header-tagline {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 0.3px;
            opacity: 0.95;
            white-space: nowrap;
            color: white;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-btn {
            padding: 7px 18px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 6px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.6);
            color: white;
        }

        .header-btn:last-child {
            border-color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
        }

        .header-btn:last-child:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.7);
        }

        .notification-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        .notification-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .notification-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            border: 2px solid var(--primary);
        }

        /* ========== Left Sidebar: Process ========== */
        .left-sidebar {
            grid-column: 1;
            grid-row: 2;
            overflow-y: auto;
            background: var(--bg-white);
            border-right: 1px solid var(--border-color);
            padding: 16px 8px 16px 12px;
            display: flex;
            flex-direction: column;
        }

        .sidebar-title {
            /* H3 스타일 적용 */
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #495057;
        }

        .project-menu {
            margin-bottom: 8px;
        }

        .project-menu-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            margin-bottom: 4px;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 12px;
            font-weight: 600;
            color: #495057;
        }

        .project-menu-item:hover {
            background: rgba(32, 128, 141, 0.15);
            border-color: #20808D;
            color: #20808D;
            transform: translateX(3px);
        }

        .project-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 12px;
        }

        .project-list-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            background: #f8f9fa;
            border-left: 3px solid var(--primary);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 12px;
        }

        .project-list-item:hover {
            background: #e9ecef;
            transform: translateX(2px);
        }

        .project-list-item.selected {
            background: rgba(16, 185, 129, 0.05);
            border-left-color: var(--primary);
            border-left-width: 4px;
        }

        .project-list-item .project-icon {
            font-size: 14px;
        }

        .project-list-item .project-name {
            flex: 1;
            font-size: 12px;
            font-weight: 600;
            color: #212529;
        }

        .project-list-item .project-status {
            font-size: 11px;
            padding: 3px 7px;
            border-radius: 8px;
            background: var(--success);
            color: white;
            font-weight: 600;
            letter-spacing: -0.3px;
        }

        .project-menu-item span:first-child {
            font-size: 12px;
            color: var(--success);
            font-weight: 600;
        }

        .process-list {
            flex: 1;
        }

        .process-item {
            margin-bottom: 2px;
        }

        .process-major {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding: 6px 10px;
            background: rgba(16, 185, 129, 0.08); border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 6px;
            transition: all 0.2s;
            cursor: pointer;
            margin-bottom: 6px;
        }

        /* 진행률이 0일 때는 기본 회색 배경 유지 */
        .process-major[data-progress="0"] {
            background: rgba(16, 185, 129, 0.08); border: 1px solid rgba(16, 185, 129, 0.2);
        }

        /* 진행률이 0보다 클 때만 연한 틸색 배경 (더 진하게) */
        .process-major[data-progress]:not([data-progress="0"]):not(.completed) {
            background: rgba(16, 185, 129, 0.12);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        /* 호버 시 진한 초록색 (가장 높은 우선순위) */
        .process-major:hover {
            background: var(--success) !important;
            color: white !important;
        }

        .process-major:hover .process-icon,
        .process-major:hover .process-status {
            filter: brightness(2);
        }

        .process-major.completed {
            background: rgba(16, 185, 129, 0.25); border: 1px solid rgba(16, 185, 129, 0.5);
        }

        .process-header {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        .process-icon {
            font-size: 12px;
            min-width: 18px;
            text-align: center;
        }

        .process-name {
            flex: 1;
            font-size: 12px;
            font-weight: 600;
            color: #212529;
        }

        .process-progress-container {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        .process-percent {
            font-size: 12px;
            font-weight: 500;
            color: #495057;
            min-width: 35px;
            text-align: right;
        }

        /* 진행률 > 0%일 때 퍼센티지 진한 녹색 */
        .process-major[data-progress]:not([data-progress="0"]):not(.completed) .process-percent {
            color: var(--success);
            font-weight: 600;
        }

        .process-major.completed .process-percent {
            color: var(--success);
        }

        .process-arrow {
            font-size: 10px;
            transition: transform 0.3s;
            margin-right: 4px;
        }

        .process-arrow.expanded {
            transform: rotate(90deg);
        }

        .process-small-list {
            margin-left: 4px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .process-small-list.expanded {
            max-height: 600px;
        }

        .process-small {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px 8px;
            font-size: 12px;
            font-weight: 700;
            color: #495057;
            margin-bottom: 2px;
            border-radius: 4px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .process-small:hover {
            background: rgba(16, 185, 129, 0.15);
            color: #333;
        }

        .process-small-content {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .process-small-bullet {
            font-size: 7px;
            color: var(--primary);
        }

        .process-small-arrow {
            font-size: 7px;
            transition: transform 0.3s;
            opacity: 0.5;
        }

        .process-small-arrow.expanded {
            transform: rotate(90deg);
        }

        .process-tiny-list {
            margin-left: 6px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .process-tiny-list.expanded {
            max-height: 200px;
        }

        .process-tiny {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            font-size: 12px;
            font-weight: 500;
            color: #495057;
            cursor: pointer;
            border-radius: 3px;
            margin-bottom: 1px;
            transition: all 0.2s;
        }

        .process-tiny:hover {
            background: rgba(16, 185, 129, 0.15);
            color: #333;
        }
        .process-tiny-bullet {
            font-size: 5px;
            color: var(--primary);
        }

        /* Process Progress Bar */
        .process-progress {
            flex: 1;
            height: 6px;
            background: #e9ecef;
            border-radius: 2px;
            overflow: hidden;
        }

        .process-progress-fill {
            height: 100%;
            background: #34D399;
            transition: width 0.3s ease;
        }

        /* 진행률 > 0%일 때 진행률 바 진한 녹색 */
        .process-major[data-progress]:not([data-progress="0"]):not(.completed) .process-progress-fill {
            background: var(--success);
        }

        .process-major.completed .process-progress-fill {
            background: var(--success);
        }

        /* ========== 특별단계/준비단계 스타일 ========== */
        /* ☆ 특별단계: 네이비색 계열 */
        .process-special {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 8px;
            background: rgba(30, 58, 138, 0.1);
            border: 1px solid rgba(30, 58, 138, 0.3);
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 6px;
            transition: all 0.2s;
        }
        .process-special-name {
            font-size: 12px;
            font-weight: 600;
            color: #212529;
        }
        .process-special:hover {
            background: #1e3a8a;
            color: white;
        }
        .process-special:hover .process-special-icon,
        .process-special:hover .process-special-name {
            color: white;
        }
        .process-special-icon {
            font-size: 14px;
            color: #1e3a8a;
            font-weight: bold;
            position: relative;
            top: -2px;
        }

        /* ○ 준비단계: 초록색 계열 */
        .process-prep {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding: 6px 10px;
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 6px;
            transition: all 0.2s;
        }
        .process-prep:hover {
            background: var(--success);
            color: white;
        }
        .process-prep:hover .process-prep-icon,
        .process-prep:hover .process-prep-name,
        .process-prep:hover .process-arrow {
            color: white;
        }
        .process-prep-header {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }
        .process-prep-icon {
            font-size: 14px;
            color: var(--success);
            font-weight: bold;
        }
        .process-prep-name {
            flex: 1;
            font-size: 12px;
            font-weight: 600;
            color: #212529;
        }

        /* 구분선: 네이비색 - 더 선명하게 */
        .process-divider {
            height: 0;
            border: none;
            border-top: 2px dashed #94a3b8;
            margin: 12px 0;
        }

        /* ========== Center Workspace ========== */
        .center-workspace {
            grid-column: 2;
            grid-row: 2;
            display: flex;
            flex-direction: column;
            background: var(--bg-light);
            overflow: hidden;
        }

        .workspace-top {
            height: 75%;
            background: white;
            border-bottom: 2px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .workspace-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }

        /* Outbox 알림 박스 */
        .outbox-notification {
            position: absolute;
            top: 70px;
            right: 24px;
            background: white;
            border: 2px solid var(--success);
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(40, 167, 69, 0.2);
            z-index: 1000;
            animation: slideInDown 0.3s ease-out;
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .outbox-notification-content {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            min-width: 320px;
        }

        .outbox-notification-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .outbox-notification-text {
            flex: 1;
        }

        .outbox-notification-title {
            font-size: 13px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 2px;
        }

        .outbox-notification-message {
            font-size: 12px;
            color: var(--neutral);
        }

        .outbox-notification-btn {
            padding: 6px 12px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .outbox-notification-btn:hover {
            background: #218838;
            transform: scale(1.05);
        }

        .outbox-notification-close {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--neutral);
            cursor: pointer;
            padding: 0 4px;
            line-height: 1;
            transition: color 0.2s;
        }

        .outbox-notification-close:hover {
            color: var(--primary-dark);
        }

        .workspace-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .workspace-actions {
            display: flex;
            gap: 12px;
        }

        .action-btn {
            padding: 8px 12px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--primary);
            color: #333;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 12px;
            width: 85px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            white-space: nowrap;
        }

        .action-btn:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .action-btn.secondary {
            background: rgba(16, 185, 129, 0.1);
            color: #333;
            border: 1px solid var(--primary);
        }

        .action-btn.secondary:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
        }

        .action-btn.success {
            background: rgba(16, 185, 129, 0.1);
            color: #333;
            border: 1px solid var(--primary);
        }

        .action-btn.success:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
        }

        .workspace-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 12px;
            overflow-y: auto;
            flex: 1;
            max-height: 100%;
            font-family: 'Malgun Gothic', '맑은 고딕', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            font-size: 12px;
        }

        .translation-section {
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding: 10px 14px;
            margin-bottom: 16px;
            background: #f8f9fa;
            border-radius: var(--border-radius);
            border-left: 3px solid var(--tertiary);
            flex-shrink: 0;
        }

        .translation-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }

        .translation-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--tertiary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .translation-toggle {
            font-size: 13px;
            color: var(--neutral);
            cursor: pointer;
            padding: 4px 8px;
            background: white;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .translation-toggle:hover {
            background: var(--secondary);
            color: white;
        }

        .translation-preview {
            background: white;
            padding: 8px 10px;
            border-radius: 6px;
            font-size: 12px;
            line-height: 1.4;
            color: #495057;
            max-height: 100px;
            overflow-y: auto;
            display: none;
        }

        .translation-preview.expanded {
            max-height: 200px;
            overflow-y: auto;
        }

        .translation-preview pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .translation-info {
            font-size: 13px;
            color: #868e96;
            padding: 6px 0;
            line-height: 1.4;
        }

        .text-editor {
            width: 100%;
            flex: 1;
            min-height: 300px;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-family: 'Malgun Gothic', '맑은 고딕', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            font-size: 12px;
            font-weight: 400;
            line-height: 1.6;
            resize: none;
            outline: none;
            transition: border-color 0.2s;
        }

        .text-editor:focus {
            border-color: #495057;
        }

        .text-editor::placeholder {
            color: #adb5bd;
        }

        .workspace-bottom {
            height: 25%;
            background: white;
            display: flex;
            flex-direction: column;
            min-height: 200px;
        }

        .grid-viewer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-bottom: 1px solid var(--border-color);
        }

        .grid-viewer-title {
            /* H2 스타일 적용 */
            font-size: 22px;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .view-toggle {
            display: flex;
            gap: 8px;
        }

        .view-btn {
            padding: 6px 14px;
            border: 1px solid var(--border-color);
            background: white;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .view-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .view-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .grid-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .stats-bar {
            display: flex;
            gap: 12px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: var(--border-radius);
            margin-bottom: 16px;
        }

        .stat-item {
            flex: 1;
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 6px;
            box-shadow: var(--shadow-sm);
        }

        .stat-label {
            display: block;
            font-size: 12px;
            color: var(--neutral);
            margin-bottom: 4px;
        }

        .stat-value {
            display: block;
            font-size: 14px;
            font-weight: 600;
        }

        .stat-value.completed {
            color: var(--success);
        }

        .stat-value.in-progress {
            color: var(--warning);
        }

        .stat-value.pending {
            color: var(--neutral);
        }

        .grid-area {
            margin-bottom: 20px;
        }

        .area-header {
            background: var(--success);
            color: white;
            padding: 10px 14px;
            border-radius: var(--border-radius);
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 13px;
        }

        .task-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }

        .task-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 14px;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
            border-left: 4px solid;
        }

        .task-card.completed {
            border-left-color: var(--success);
        }

        .task-card.in-progress {
            border-left-color: var(--warning);
        }

        .task-card.pending {
            border-left-color: var(--neutral);
        }

        .task-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .task-id {
            font-weight: 700;
            color: var(--secondary);
            font-size: 12px;
        }

        .status-badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.completed {
            background: #d4edda;
            color: #155724;
        }

        .status-badge.in-progress {
            background: #fff3cd;
            color: #856404;
        }

        .status-badge.pending {
            background: #e2e3e5;
            color: #383d41;
        }

        .task-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #212529;
            font-size: 12px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            line-height: 1.4;
        }

        .task-progress {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .progress-bar {
            flex: 1;
            height: 5px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 12px;
            font-weight: 600;
            color: var(--neutral);
        }

        /* ========== Right Sidebar ========== */
        .right-sidebar {
            grid-column: 3;
            grid-row: 2;
            overflow-y: auto;
            background: var(--bg-white);
            border-left: 1px solid var(--border-color);
            padding: 16px;
        }

        .sidebar-section {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* 좌측 사이드바 섹션 간격 (우측과 동일) */
        .left-sidebar-section {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }

        .left-sidebar-section:first-child {
            margin-top: 0;
            padding-top: 0;
            border-top: none;
        }

        .sidebar-section h3 {
            /* H3 스타일 적용 */
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .knowledge-item {
            margin-bottom: 4px;
        }

        .knowledge-major {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            background: rgba(245, 158, 11, 0.08); border: 1px solid rgba(245, 158, 11, 0.2);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .knowledge-major:hover {
            background: var(--secondary); border-color: var(--secondary);
            color: white;
        }

        .knowledge-icon {
            font-size: 14px;
        }

        .knowledge-name {
            flex: 1;
            /* H5 스타일 적용 (사용자 요청: 2단계 크기 축소) */
            font-size: 12px;
            font-weight: 700;
            color: #495057;
        }

        .knowledge-arrow {
            font-size: 10px;
            transition: transform 0.3s;
        }

        .knowledge-arrow.expanded {
            transform: rotate(90deg);
        }

        .knowledge-medium-list {
            margin-left: 12px;
            margin-top: 4px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .knowledge-medium-list.expanded {
            max-height: 400px;
        }

        .knowledge-medium {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px 8px;
            /* H5 스타일 적용 */
            font-size: 12px;
            font-weight: 700;
            color: #495057;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 2px;
            transition: all 0.2s;
        }

        .knowledge-medium:hover {
            background: rgba(245, 158, 11, 0.15);
            color: #333;
        }

        .knowledge-medium-content {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .knowledge-medium-bullet {
            font-size: 7px;
            color: var(--primary);
        }

        .knowledge-medium-arrow {
            font-size: 7px;
            transition: transform 0.3s;
            opacity: 0.5;
        }

        .knowledge-medium-arrow.expanded {
            transform: rotate(90deg);
        }

        .knowledge-small-list {
            margin-left: 12px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .knowledge-small-list.expanded {
            max-height: 300px;
        }

        .knowledge-small {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            /* H6 스타일 적용 */
            font-size: 12px;
            font-weight: 500;
            color: #495057;
            cursor: pointer;
            border-radius: 3px;
            margin-bottom: 1px;
            transition: all 0.2s;
        }

        .knowledge-small:hover {
            background: rgba(245, 158, 11, 0.15);
            color: #333;
        }

        .knowledge-small-bullet {
            font-size: 5px;
            color: var(--primary);
        }

        /* ========== Quick Links Section ========== */
        .quick-links {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .quick-link-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            text-decoration: none;
            color: #495057;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
        }

        .quick-link-btn:hover {
            background: var(--bg-light);
            border-color: var(--success);
            transform: translateX(2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .quick-link-btn.vscode:hover {
            border-color: #007ACC;
            background: rgba(0, 122, 204, 0.05);
        }

        .quick-link-btn.github:hover {
            border-color: #24292e;
            background: rgba(36, 41, 46, 0.05);
        }

        .quick-link-btn.vercel:hover {
            border-color: #000;
            background: rgba(0, 0, 0, 0.05);
        }

        .quick-link-btn.supabase:hover {
            border-color: #3ECF8E;
            background: rgba(62, 207, 142, 0.05);
        }

        .quick-link-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* AI Selector 버튼 스타일 */
        .ai-selector-btn {
            flex: 1;
            min-width: 60px;
            padding: 6px 8px;
            border: 1px solid #999;
            border-radius: var(--border-radius);
            background: rgba(245, 158, 11, 0.08);
            color: #333;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .ai-selector-btn:hover {
            border-color: var(--secondary);
            background: rgba(245, 158, 11, 0.05);
            transform: translateY(-1px);
        }

        .ai-selector-btn.active {
            border-color: var(--secondary);
            background: var(--secondary);
            color: white;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
        }

        .quick-link-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .quick-link-name {
            flex: 1;
            font-weight: 600;
        }

        .ai-input-area {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .ai-input-area textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 12px;
            resize: vertical;
            line-height: 1.5;
            color: #333;
        }

        .ai-input-area textarea::placeholder {
            color: #999;
            font-size: 12px;
        }

        .ai-input-area button {
            padding: 10px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .ai-input-area button:hover {
            background: var(--secondary-dark);
        }

        .credit-info {
            font-size: 12px;
            color: var(--neutral);
            text-align: center;
        }

        .credit-info span {
            font-weight: 700;
            color: var(--primary);
        }

        .support-input-area {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .support-input-area textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 12px;
            resize: vertical;
            line-height: 1.5;
            color: #333;
        }

        .support-input-area textarea::placeholder {
            color: #999;
            font-size: 12px;
        }

        .support-placeholder {
            font-size: 12px;
            color: var(--neutral);
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .support-input-area button {
            padding: 10px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .support-input-area button:hover {
            background: var(--secondary-dark);
        }

        /* Support Response Area */
        .support-response {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            margin-top: 12px;
        }

        .support-response.show {
            max-height: 400px;
            overflow-y: auto;
        }

        .response-header {
            background: var(--success);
            color: white;
            padding: 8px 12px;
            border-radius: 6px 6px 0 0;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .response-content {
            background: #f8f9fa;
            padding: 12px;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 6px 6px;
            font-size: 13px;
            line-height: 1.6;
            color: #212529;
        }

        .response-meta {
            font-size: 12px;
            color: #495057;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #dee2e6;
        }

        /* ========== Footer ========== */
        .footer {
            width: 100%;
            background: linear-gradient(135deg, var(--tertiary) 0%, var(--tertiary-dark) 100%);
            color: white;
            position: relative;
        }

        .footer-inner {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 44px 32px 44px 32px;
            font-size: 12px;
            gap: 9px;
        }

        .footer-links {
            display: flex;
            align-items: center;
            gap: 32px;
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.95);
            text-decoration: none;
            transition: color 0.2s;
            font-size: 14px;
            font-weight: 600;
        }

        .footer-link:hover {
            color: white;
        }

        .footer-copyright {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
            opacity: 0.7;
        }

        .admin-link {
            position: absolute;
            right: 32px;
            bottom: 12px;
            opacity: 0.15;
            font-size: 9px;
            transition: opacity 0.3s;
            color: rgba(255, 255, 255, 0.95);
            text-decoration: none;
        }

        .admin-link:hover {
            opacity: 0.6;
        }

        /* ========== Scrollbar ========== */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        ::-webkit-scrollbar-track {
            background: #e9ecef;
        }

        ::-webkit-scrollbar-thumb {
            background: #adb5bd;
            border-radius: 6px;
            border: 2px solid #e9ecef;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #868e96;
        }

        /* Status Indicator */
        .server-status {
            position: fixed !important;
            bottom: 20px;
            right: 300px;
            padding: 10px 16px;
            background: var(--secondary);
            color: white;
            border-radius: 6px;
            font-size: 12px;
            z-index: 1000;
            display: none;
        }

        .server-status.show {
            display: block;
        }

        .server-status.success {
            background: var(--secondary);
        }

        .server-status.error {
            background: var(--danger);
        }

        /* Project Grid Fullscreen Modal */
        .grid-fullscreen-modal {
            display: none;
            position: fixed !important;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            padding: 20px;
        }

        .grid-fullscreen-modal.active {
            display: flex;
            flex-direction: column;
        }

        .grid-fullscreen-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 8px 8px 0 0;
            margin-bottom: 16px;
        }

        .grid-fullscreen-title {
            font-size: 24px;
            font-weight: 700;
            color: white;
        }

        .grid-fullscreen-close {
            padding: 10px 20px;
            background: #495057;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .grid-fullscreen-close:hover {
            background: #5a6268;
            transform: scale(1.05);
        }

        .grid-fullscreen-content {
            flex: 1;
            background: white;
            border-radius: 8px;
            overflow-y: auto;
            padding: 24px;
        }

        .grid-viewer-title-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            width: 100%;
        }

        .expand-btn-inline {
            padding: 8px 12px;
            border: 1px solid var(--primary);
            background: rgba(16, 185, 129, 0.1);
            color: #333;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            width: 85px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            white-space: nowrap;
        }

        .expand-btn-inline:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .manual-btn-inline {
            padding: 8px 12px;
            border: 1px solid var(--primary);
            background: rgba(16, 185, 129, 0.1);
            color: #333;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            width: 85px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            white-space: nowrap;
        }

        .manual-btn-inline:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* 공지사항 스타일 */
        .notice-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 5px 8px;
            font-size: 12px;
            font-weight: 700;
            color: #495057;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 2px;
            transition: all 0.2s;
            background: rgba(245, 158, 11, 0.08);
        }

        .notice-item:hover {
            background: rgba(245, 158, 11, 0.15) !important;
            color: #333;
        }

        .notice-bullet {
            font-size: 7px;
            color: #D97706;
        }

        .notice-title {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.4;
            flex: 1;
        }


        /* ========== Responsive Design ========== */

        /* 사이드바 오버레이 (모바일용) */
        .sidebar-overlay {
            display: none;
            position: fixed !important;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .sidebar-overlay.active {
            display: block;
            opacity: 1;
        }

        /* 모바일 메뉴 버튼 */
        .mobile-menu-btn {
            display: none;
            width: 44px;
            height: 44px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: white;
            font-size: 20px;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .mobile-menu-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        /* 사이드바 닫기 버튼 */
        .sidebar-close-btn {
            display: none;
            position: absolute;
            top: 12px;
            right: 12px;
            width: 36px;
            height: 36px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            color: var(--text-secondary);
            font-size: 18px;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .sidebar-close-btn:hover {
            background: var(--danger);
            color: white;
        }

        /* FAB 컨테이너 */
        .fab-container {
            display: none;
            position: fixed !important;
            bottom: 20px;
            right: 20px;
            flex-direction: column;
            gap: 12px;
            z-index: 1000;
        }

        .fab-btn {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .fab-btn:hover { transform: scale(1.1); }
        .fab-btn.fab-menu { background: var(--primary); }
        .fab-btn.fab-info { background: var(--info); }

        /* Large Desktop: 1400px+ */
        @media (min-width: 1400px) {
            .layout-container { grid-template-columns: 280px 1fr 320px; }
        }

        /* Desktop: 1024-1399px */
        @media (max-width: 1399px) and (min-width: 1024px) {
            .layout-container { grid-template-columns: 240px 1fr 280px; }
            .header-tagline { font-size: 13px; }
            .logo h1 { font-size: 22px; }
        }

        /* Tablet Landscape: 769-1023px */
        @media (max-width: 1023px) and (min-width: 769px) {
            .layout-container { grid-template-columns: 220px 1fr; }
            .header-inner { padding: 0 16px; }
            .header-tagline { font-size: 12px; }
            .logo h1 { font-size: 20px; }

            .right-sidebar {
                position: fixed !important;
                right: -320px !important;
                top: 0;
                bottom: 0;
                width: 300px;
                z-index: 1001;
                background: #f8f9fa !important;
                box-shadow: -4px 0 20px rgba(0, 0, 0, 0.15);
                transition: right 0.3s ease;
                overflow-y: auto;
                padding-top: 20px;
            }

            .right-sidebar.open { right: 0 !important; }
            .right-sidebar .sidebar-close-btn { display: flex; }
            .fab-container { display: flex; }
            .fab-container .fab-menu { display: none; }

            .left-sidebar { padding: 12px 10px; }
            .workspace-header { padding: 12px 16px; }
            .workspace-title { font-size: 18px; }
            .action-btn { padding: 8px 12px; font-size: 12px; min-height: 44px; }
        }

        /* Tablet Portrait: 768px 이하 */
        @media (max-width: 768px) {
            .layout-container { display: grid !important; grid-template-columns: 1fr !important; grid-template-rows: 1fr !important; }
            .mobile-menu-btn { display: flex; }
            .header-inner { height: 60px; padding: 0 12px; }
            .header-center { display: none; }
            .header-right { display: none; }
            .logo h1 { font-size: 20px; }

            .left-sidebar {
                position: fixed !important;
                left: -320px !important;
                top: 0;
                bottom: 0;
                width: 300px;
                z-index: 1001;
                background: #f8f9fa !important;
                box-shadow: 4px 0 20px rgba(0, 0, 0, 0.15);
                transition: left 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
                -webkit-overflow-scrolling: touch;
                grid-column: unset !important;
                grid-row: unset !important;
            }

            .left-sidebar.open { left: 0 !important; }
            .left-sidebar .sidebar-close-btn { display: flex; top: 16px; }

            .right-sidebar {
                position: fixed !important;
                right: -320px !important;
                top: 0;
                bottom: 0;
                width: 300px;
                z-index: 1001;
                background: #f8f9fa !important;
                box-shadow: -4px 0 20px rgba(0, 0, 0, 0.15);
                transition: right 0.3s ease;
                overflow-y: auto;
                padding-top: 60px;
                -webkit-overflow-scrolling: touch;
                grid-column: unset !important;
                grid-row: unset !important;
            }

            .right-sidebar.open { right: 0 !important; }
            .right-sidebar .sidebar-close-btn { display: flex; top: 16px; }
            .fab-container { display: flex; }

            .center-workspace { grid-column: 1 !important; grid-row: 1 !important; min-height: calc(100vh - 60px - 50px); display: flex !important; width: 100% !important; overflow-y: auto !important; }
            .workspace-top { height: auto; min-height: 30vh; max-height: 50vh; }
            .workspace-header { flex-direction: column; gap: 12px; align-items: stretch; padding: 12px; }
            .workspace-actions { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; width: 100%; }
            .action-btn { min-height: 44px; padding: 10px 8px; font-size: 12px; justify-content: center; width: 100%; }

            .footer-inner { flex-direction: column; gap: 12px; padding: 12px 16px; }
            .footer-left, .footer-right { width: 100%; justify-content: center; flex-wrap: wrap; }
            .footer-btn { min-height: 44px; }
            .text-editor { min-height: 200px; }
            .translation-section { padding: 8px 10px; }
            .translation-title { font-size: 14px; }
        }

        /* Mobile: 480px 이하 */
        @media (max-width: 480px) {
            .header-inner { padding: 0 10px; height: 56px; }
            .logo { gap: 8px; }
            .logo h1 { font-size: 18px; }
            .rice-grain { width: 8px; height: 14px; }
            .mobile-menu-btn { width: 40px; height: 40px; font-size: 18px; }

            .left-sidebar, .right-sidebar { width: 280px; }
            .left-sidebar { left: -290px; }
            .right-sidebar { right: -290px; }

            .sidebar-title, .sidebar-section h3 { font-size: 13px; }
            .process-major, .process-prep, .process-special { padding: 10px 12px; min-height: 44px; }
            .process-name, .process-prep-name, .process-special-name { font-size: 12px; }

            .workspace-header { padding: 10px; }
            .workspace-title { font-size: 16px; }
            .workspace-actions { grid-template-columns: repeat(2, 1fr); gap: 6px; }
            .action-btn { padding: 8px 6px; font-size: 11px; min-height: 44px; }
            .workspace-content { padding: 8px; }
            .text-editor { min-height: 150px; padding: 10px; font-size: 13px; }

            .translation-section { padding: 6px 8px; }
            .translation-title { font-size: 13px; }
            .translation-preview { font-size: 12px; }

            .footer-inner { padding: 10px; }
            .footer-btn { padding: 10px 12px; font-size: 12px; min-height: 44px; }

            .knowledge-major, .knowledge-medium, .knowledge-small { padding: 10px 12px; min-height: 44px; }
            .knowledge-name { font-size: 12px; }
            .quick-link-btn { padding: 12px; min-height: 44px; }
            .project-list-item { padding: 10px 12px; min-height: 44px; }
            .project-name { font-size: 12px; }
            .project-status { font-size: 10px; padding: 3px 6px; }

            .fab-btn { width: 52px; height: 52px; font-size: 18px; }

            .outbox-notification { top: auto; right: 10px; left: 10px; bottom: 80px; }
            .outbox-notification-content { min-width: auto; padding: 12px; }
            .outbox-notification-icon { font-size: 20px; }
            .outbox-notification-title { font-size: 13px; }
            .outbox-notification-message { font-size: 12px; }
        }

        /* Touch-friendly */
        @media (hover: none) and (pointer: coarse) {
            .process-major, .process-small, .process-tiny, .process-prep, .process-special,
            .knowledge-major, .knowledge-medium, .knowledge-small,
            .quick-link-btn, .project-menu-item, .project-list-item {
                min-height: 44px;
                display: flex;
                align-items: center;
            }
            .action-btn, .header-btn, .footer-btn, .mobile-menu-btn, .sidebar-close-btn, .fab-btn { min-height: 44px; }
            .left-sidebar, .right-sidebar, .workspace-content { -webkit-overflow-scrolling: touch; }
        }

        /* 텍스트 오버플로우 */
        .process-name, .process-prep-name, .process-special-name,
        .knowledge-name, .project-name, .notice-title {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .workspace-title {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 100%;
        }

        /* Print styles */
        @media print {
            .header, .footer, .left-sidebar, .right-sidebar, .fab-container, .sidebar-overlay, .mobile-menu-btn { display: none !important; }
            .layout-container { display: block; }
            .center-workspace { width: 100%; }
        }

    </style>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- DOMPurify -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
</head>

<body>
    <div class="sidebar-overlay" onclick="closeAllSidebars()"></div>
    <div class="page-wrapper">
        <!-- Header -->
        <header class="header">
            <div class="header-inner">
                <button class="mobile-menu-btn" onclick="toggleLeftSidebar()">☰</button>
                <div class="logo">
                    <span class="rice-logo">
                        <span class="rice-grain"></span>
                        <span class="rice-grain"></span>
                        <span class="rice-grain"></span>
                    </span>
                    <h1>SSAL Works</h1>
                </div>
                <div class="header-center">
                    <div class="header-tagline">Claude Code를 활용한 SAL Grid 기반 풀스텍 웹사이트 개발 플랫폼</div>
                </div>
                <div class="header-right">
                    <button class="header-btn">로그인</button>
                    <button class="header-btn">회원가입</button>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <div class="layout-container">
            <!-- Left Sidebar: Process -->
        <aside class="left-sidebar">
            <button class="sidebar-close-btn" onclick="closeLeftSidebar()">✕</button>
            <!-- Project Section -->
            <div class="left-sidebar-section">
                <h2 class="sidebar-title" style="margin-bottom: 12px;">📦 PROJECT</h2>

                <!-- Project List Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 12px; font-weight: 600; color: #495057; margin-bottom: 8px; padding-left: 4px; cursor: pointer;"
                    onclick="toggleProjectList()">
                    <span>Project 목록</span>
                    <span id="projectListArrow" style="font-size: 12px;">▲</span>
                </div>

                <!-- Project List -->
                <div class="project-list" id="projectList" style="display: flex; flex-direction: column; gap: 6px;">
                    <!-- 예시 프로젝트 (최상단 고정) -->
                    <div class="project-list-item" onclick="loadProcessStage('project_example', 'SSAL Works (예시)', '프로젝트'); showExampleProject()">
                        <span class="project-name">SSAL Works</span>
                        <span class="project-status" style="background: rgba(16, 185, 129, 0.1); color: var(--primary);">예시</span>
                    </div>

                    <!-- 완료 프로젝트 (최신 1개만 표시) -->
                    <div class="project-list-item" onclick="loadProcessStage('project_work', 'PoliticianFinder', '프로젝트'); selectProject('PoliticianFinder')" style="opacity: 0.6;">
                        <span class="project-name">PoliticianFinder</span>
                        <span class="project-status" style="background: var(--success); color: white;">완료</span>
                    </div>

                    <!-- 완료 프로젝트 더보기 (2개 이상일 때만 표시) -->
                    <div id="completedProjectsMore" style="display: flex; flex-direction: column; gap: 6px;">
                        <div style="font-size: 12px; font-weight: 600; color: #6c757d; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; cursor: pointer; display: flex; justify-content: space-between; align-items: center;"
                            onclick="toggleCompletedProjects()">
                            <span id="completedProjectsText">완료 프로젝트 더보기</span>
                            <span id="completedProjectsArrow" style="font-size: 12px;">▼</span>
                        </div>

                        <!-- 펼침 영역 (스크롤) -->
                        <div id="completedProjectsList" style="display: none; flex-direction: column; gap: 6px; max-height: 300px; overflow-y: auto; padding: 4px;">
                            <!-- 추가 완료 프로젝트들 (예시) -->
                            <div class="project-list-item" onclick="selectProject('포트폴리오')" style="opacity: 0.6;">
                                <span class="project-name">포트폴리오</span>
                                <span class="project-status" style="background: var(--success); color: white;">완료</span>
                            </div>
                            <div class="project-list-item" onclick="selectProject('쇼핑몰 프로젝트')" style="opacity: 0.6;">
                                <span class="project-name">쇼핑몰 프로젝트</span>
                                <span class="project-status" style="background: var(--success); color: white;">완료</span>
                            </div>
                            <div class="project-list-item" onclick="selectProject('회사 홈페이지')" style="opacity: 0.6;">
                                <span class="project-name">회사 홈페이지</span>
                                <span class="project-status" style="background: var(--success); color: white;">완료</span>
                            </div>
                        </div>
                    </div>

                    <!-- 진행중 프로젝트 (맨 아래 고정) -->
                    <div class="project-list-item selected" onclick="loadProcessStage('project_work', 'SSAL Works', '프로젝트'); selectProject('SSAL Works')">
                        <span class="project-name">SSAL Works</span>
                        <span class="project-status">진행중</span>
                    </div>
                </div>

                <!-- Add New Project Button -->
                <div class="project-menu">
                    <div class="project-menu-item" onclick="openAddProjectModal()">
                        <span style="color: var(--success) !important; font-size: 24px; font-weight: bold;">+</span>
                        <span>새로운 Project 등록</span>
                    </div>
                </div>
            </div>

            <!-- Process Section -->
            <div class="left-sidebar-section">
                <h2 class="sidebar-title" style="margin-bottom: 12px;">📊 진행 프로세스</h2>

                <div class="process-list">
                    <!-- ☆ 작업 디렉토리 구조 생성 (특별단계) -->
                    <div class="process-special" onclick="loadProcessStage('dir_structure', '작업 디렉토리 구조 생성', '특별단계_☆')">
                        <span class="process-special-icon" style="top: -3px;">☆</span>
                        <span class="process-special-name">작업 디렉토리 구조 생성</span>
                    </div>

                    <!-- ○ 사업계획 (준비단계) -->
                    <div class="process-item">
                        <div class="process-prep" onclick="toggleProcessPrep(this)" data-progress="0">
                            <div class="process-prep-header">
                                <span class="process-prep-icon">○</span>
                                <span class="process-prep-name">사업계획</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="loadProcessStage('biz_0_1', '0-1 시장조사', '사업계획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>0-1 시장조사</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="loadProcessStage('biz_0_2', '0-2 경쟁분석', '사업계획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>0-2 경쟁분석</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="loadProcessStage('biz_0_3', '0-3 사업계획서', '사업계획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>0-3 사업계획서</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ○ 프로젝트 기획 (준비단계) -->
                    <div class="process-item">
                        <div class="process-prep" onclick="toggleProcessPrep(this)" data-progress="0">
                            <div class="process-prep-header">
                                <span class="process-prep-icon">○</span>
                                <span class="process-prep-name">프로젝트 기획</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="loadProcessStage('plan_1_1', '1-1 Project Plan', '프로젝트_기획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>1-1 Project Plan</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="loadProcessStage('plan_1_2', '1-2 Requirements', '프로젝트_기획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>1-2 Requirements</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="loadProcessStage('plan_1_3', '1-3 Architecture', '프로젝트_기획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>1-3 Architecture</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="loadProcessStage('plan_1_4', '1-4 UI/UX', '프로젝트_기획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>1-4 UI/UX</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="loadProcessStage('plan_1_5', '1-5 DB Design', '프로젝트_기획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>1-5 DB Design</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="loadProcessStage('plan_1_6', '1-6 API Design', '프로젝트_기획')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>1-6 API Design</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ☆ Project SAL GRID 생성 (특별단계) -->
                    <div class="process-special" onclick="loadProcessStage('sal_grid', 'Project SAL Grid 생성', '특별단계_☆')">
                        <span class="process-special-icon">☆</span>
                        <span class="process-special-name">Project SAL Grid 생성</span>
                    </div>

                    <!-- 구분선 -->
                    <div class="process-divider"></div>

                    <!-- S1. 프로토타입 제작 -->
                    <div class="process-item">
                        <div class="process-major" onclick="loadProcessStage('s1_prototype', 'S1. 프로토타입 제작', '개발단계'); toggleProcess(this)" data-progress="0">
                            <div class="process-header">
                                <span class="process-icon">S1.</span>
                                <span class="process-name">프로토타입 제작</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="openFolder('1_프로토타입_제작/Documentation')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Documentation</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('1_프로토타입_제작/Design')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Design</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('1_프로토타입_제작/Frontend')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Frontend</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('1_프로토타입_제작/Database')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Database</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- S2. 개발 준비 -->
                    <div class="process-item">
                        <div class="process-major" onclick="loadProcessStage('s2_dev_prep', 'S2. 개발 준비', '개발단계'); toggleProcess(this)" data-progress="0">
                            <div class="process-header">
                                <span class="process-icon">S2.</span>
                                <span class="process-name">개발 준비</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="openFolder('2_개발_준비/Documentation')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Documentation</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('2_개발_준비/Backend_Infra')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_Infra</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('2_개발_준비/Database')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Database</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('2_개발_준비/Security')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Security</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- S3. 개발 1차 -->
                    <div class="process-item">
                        <div class="process-major" onclick="loadProcessStage('s3_dev_1', 'S3. 개발 1차', '개발단계'); toggleProcess(this)" data-progress="0">
                            <div class="process-header">
                                <span class="process-icon">S3.</span>
                                <span class="process-name">개발 1차</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="openFolder('3_개발-1차/Documentation')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Documentation</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Design')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Design</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Frontend')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Frontend</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Backend_Infra')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_Infra</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Backend_API')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_API</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Database')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Database</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Security')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Security</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Testing')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Testing</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/DevOps')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>DevOps</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/External')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>External</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('3_개발-1차/Content_System')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Content_System</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- S4. 개발 2차 -->
                    <div class="process-item">
                        <div class="process-major" onclick="loadProcessStage('s4_dev_2', 'S4. 개발 2차', '개발단계'); toggleProcess(this)" data-progress="0">
                            <div class="process-header">
                                <span class="process-icon">S4.</span>
                                <span class="process-name">개발 2차</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="openFolder('4_개발-2차/Documentation')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Documentation</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Design')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Design</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Frontend')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Frontend</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Backend_Infra')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_Infra</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Backend_API')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_API</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Database')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Database</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Security')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Security</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Testing')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Testing</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/DevOps')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>DevOps</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/External')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>External</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('4_개발-2차/Content_System')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Content_System</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- S5. 개발 3차 -->
                    <div class="process-item">
                        <div class="process-major" onclick="loadProcessStage('s5_dev_3', 'S5. 개발 3차', '개발단계'); toggleProcess(this)" data-progress="0">
                            <div class="process-header">
                                <span class="process-icon">S5.</span>
                                <span class="process-name">개발 3차</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="openFolder('5_개발-3차/Documentation')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Documentation</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Design')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Design</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Frontend')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Frontend</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Backend_Infra')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_Infra</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Backend_API')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_API</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Database')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Database</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Security')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Security</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Testing')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Testing</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/DevOps')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>DevOps</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/External')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>External</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('5_개발-3차/Content_System')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Content_System</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- S6. 운영 -->
                    <div class="process-item">
                        <div class="process-major" onclick="loadProcessStage('s6_operation', 'S6. 운영', '개발단계'); toggleProcess(this)" data-progress="0">
                            <div class="process-header">
                                <span class="process-icon">S6.</span>
                                <span class="process-name">운영</span>
                                <span class="process-arrow">▶</span>
                            </div>
                            <div class="process-progress-container">
                                <div class="process-progress">
                                    <div class="process-progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="process-percent">0%</span>
                            </div>
                        </div>
                        <div class="process-small-list">
                            <div class="process-small" onclick="openFolder('6_운영/Documentation')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Documentation</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/Frontend')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Frontend</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/Backend_API')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Backend_API</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/Database')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Database</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/Security')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Security</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/Testing')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Testing</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/DevOps')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>DevOps</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/External')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>External</span>
                                </div>
                            </div>
                            <div class="process-small" onclick="openFolder('6_운영/Content_System')">
                                <div class="process-small-content">
                                    <span class="process-small-bullet">●</span>
                                    <span>Content_System</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Links Section -->
            <div class="left-sidebar-section">
                <h2 class="sidebar-title">🔗 연계 서비스 바로가기</h2>

                <div class="quick-links">
                    <a href="antigravity://" class="quick-link-btn antigravity" title="Antigravity 열기">
                        <span class="quick-link-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <!-- Antigravity Logo - Two legs with thick rounded top cap -->
                                <path d="M8 4 L10 4 C9 10, 8 16, 7 22 L2 22 C4 16, 6 10, 8 4 Z" fill="#1a1a1a"/>
                                <path d="M14 4 L16 4 C18 10, 20 16, 22 22 L17 22 C16 16, 15 10, 14 4 Z" fill="#1a1a1a"/>
                                <ellipse cx="12" cy="3" rx="6" ry="3" fill="#1a1a1a"/>
                            </svg>
                        </span>
                        <span class="quick-link-name">Antigravity</span>
                    </a>

                    <a href="vscode://" class="quick-link-btn vscode" title="VS Code 열기">
                        <span class="quick-link-icon">
                            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vscode/vscode-original.svg"
                                alt="VS Code">
                        </span>
                        <span class="quick-link-name">VS Code</span>
                    </a>

                    <a href="https://github.com" target="_blank" class="quick-link-btn github" title="GitHub 열기">
                        <span class="quick-link-icon">
                            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg"
                                alt="GitHub">
                        </span>
                        <span class="quick-link-name">GitHub</span>
                    </a>

                    <a href="https://vercel.com/dashboard" target="_blank" class="quick-link-btn vercel"
                        title="Vercel 대시보드 열기">
                        <span class="quick-link-icon">
                            <svg viewBox="0 0 76 65" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M37.5274 0L75.0548 65H0L37.5274 0Z" fill="#000" />
                            </svg>
                        </span>
                        <span class="quick-link-name">Vercel</span>
                    </a>

                    <a href="https://supabase.com/dashboard" target="_blank" class="quick-link-btn supabase"
                        title="Supabase 대시보드 열기">
                        <span class="quick-link-icon">
                            <svg viewBox="0 0 109 113" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M63.7076 110.284C60.8481 113.885 55.0502 111.912 54.9813 107.314L53.9738 40.0627H99.1935C103.711 40.0627 106.305 45.3117 103.447 48.9134L63.7076 110.284Z"
                                    fill="url(#paint0_linear)" />
                                <path
                                    d="M63.7076 110.284C60.8481 113.885 55.0502 111.912 54.9813 107.314L53.9738 40.0627H99.1935C103.711 40.0627 106.305 45.3117 103.447 48.9134L63.7076 110.284Z"
                                    fill="url(#paint1_linear)" fill-opacity="0.2" />
                                <path
                                    d="M45.317 2.07103C48.1765 -1.53037 53.9745 0.442937 54.0434 5.041L54.4849 72.2922H9.83113C5.31361 72.2922 2.71933 66.6679 5.58119 63.0663L45.317 2.07103Z"
                                    fill="#3ECF8E" />
                                <defs>
                                    <linearGradient id="paint0_linear" x1="53.9738" y1="54.974" x2="94.1635"
                                        y2="71.8295" gradientUnits="userSpaceOnUse">
                                        <stop stop-color="#249361" />
                                        <stop offset="1" stop-color="#3ECF8E" />
                                    </linearGradient>
                                    <linearGradient id="paint1_linear" x1="36.1558" y1="30.578" x2="54.4844"
                                        y2="65.0806" gradientUnits="userSpaceOnUse">
                                        <stop />
                                        <stop offset="1" stop-opacity="0" />
                                    </linearGradient>
                                </defs>
                            </svg>
                        </span>
                        <span class="quick-link-name">Supabase</span>
                    </a>

                    <a href="https://resend.com/emails" target="_blank" class="quick-link-btn resend"
                        title="Resend 대시보드 열기">
                        <span class="quick-link-icon">
                            <img src="https://cdn.resend.com/brand/resend-icon-black.svg" alt="Resend">
                        </span>
                        <span class="quick-link-name">Resend</span>
                    </a>
                </div>
            </div>
        </aside>

        <!-- Center Workspace -->
        <main class="center-workspace">
            <!-- Top: Workspace (75%) -->
            <div class="workspace-top">
                <div class="workspace-header">
                    <div class="workspace-title">
                        <span>Workspace</span>
                    </div>
                    <!-- Outbox 알림 박스 제거됨 -->
                    <div class="workspace-actions">
                        <button class="action-btn secondary" onclick="clearEditor()">
                            <span style="display: flex; flex-direction: column; line-height: 1.3;">
                                <span>Workspace</span>
                                <span>지우기</span>
                            </span>
                        </button>
                        <button class="action-btn" onclick="downloadToInbox()">
                            <span style="display: flex; flex-direction: column; line-height: 1.3;">
                                <span>Order Sheet</span>
                                <span>보내기</span>
                            </span>
                        </button>
                        <button class="action-btn success" onclick="loadFromOutbox()">
                            <span style="display: flex; flex-direction: column; line-height: 1.3;">
                                <span>Output</span>
                                <span>불러오기</span>
                            </span>
                        </button>
                    </div>
                </div>
                <div class="workspace-content">
                    <textarea id="textEditor" class="text-editor" placeholder="여기에 Order Sheet를 작성하세요...

예시:
# Order Sheet: 회원가입 API 구현

## 요구사항
- Email 중복 확인
- 비밀번호 암호화
- Supabase Auth 연동

## 산출물
- /api/auth/signup.ts
- 테스트 코드

## 참고사항
- 비밀번호 최소 8자, 영문+숫자+특수문자 포함
- Task ID: P1BA1
" oninput="translateToEnglish()"></textarea>

                    <!-- Translation Preview -->
                    <div class="translation-section" id="translationSection">
                        <div class="translation-header">
                            <div class="translation-title" onclick="toggleTranslation()"
                                style="cursor: pointer; user-select: none;">
                                <span>English Translation</span>
                                <span id="toggleText" style="margin-left: 8px; font-size: 12px;">▼</span>
                            </div>
                            <button class="action-btn" onclick="openTranslationFullview()">
                                <span style="display: flex; flex-direction: column; line-height: 1.3;">
                                    <span>전체</span>
                                    <span>보기</span>
                                </span>
                            </button>
                        </div>
                        <div class="translation-preview" id="translationPreview" style="display: block; max-height: 85px; overflow: hidden;">
                            <pre id="translatedText" style="margin: 0; font-size: 12px; color: #868e96;">[Claude Code Only] This English translation section is for Claude Code.
The Korean content from the workspace above is translated here for Claude Code to read.
────────────────────────────────────────
워크스페이스에 입력한 내용이 여기에 표시됩니다.
The content you enter in the workspace will be displayed here.</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom: Grid Viewer (25%) -->
            <div class="workspace-bottom">
                <div class="grid-viewer-header">
                    <div class="grid-viewer-title-group">
                        <div class="grid-viewer-title">Project SAL Grid</div>
                        <div style="display: flex; gap: 12px; margin-left: auto;">
                            <button class="action-btn" onclick="openViewer()">
                                <span style="display: flex; flex-direction: column; line-height: 1.3;">
                                    <span>Viewer</span>
                                    <span>열기</span>
                                </span>
                            </button>
                            <button class="action-btn" onclick="openManual()">
                                <span style="display: flex; flex-direction: column; line-height: 1.3;">
                                    <span>매뉴얼</span>
                                    <span>보기</span>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="grid-content">
                    <!-- Task Status -->
                    <div class="stats-bar" style="margin-bottom: 8px;">
                        <div style="font-weight: 700; font-size: 13px; color: #495057; min-width: 100px; display: flex; align-items: center;">실행 상태</div>
                        <div class="stat-item">
                            <span class="stat-label">○ Pending</span>
                            <span class="stat-value pending">45</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">● In Progress</span>
                            <span class="stat-value in-progress">12</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">✓ Completed</span>
                            <span class="stat-value completed">8</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">⚠ Fixing</span>
                            <span class="stat-value" style="color: #f59e0b;">1</span>
                        </div>
                    </div>
                    <!-- Verification Status -->
                    <div class="stats-bar">
                        <div style="font-weight: 700; font-size: 13px; color: #495057; min-width: 100px; display: flex; align-items: center;">검증 상태</div>
                        <div class="stat-item">
                            <span class="stat-label">○ Not Verified</span>
                            <span class="stat-value pending">50</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">✓ Passed</span>
                            <span class="stat-value completed">14</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">✗ Failed</span>
                            <span class="stat-value" style="color: #ef4444;">2</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Right Sidebar: Content & Support -->
        <aside class="right-sidebar">
            <button class="sidebar-close-btn" onclick="closeRightSidebar()">✕</button>
            <!-- Knowledge Content -->
            <div class="sidebar-section">
                <h3>📚 학습용 콘텐츠</h3>

                <!-- 검색창 -->
                <div style="margin-bottom: 12px;">
                    <input type="text"
                           id="learningSearchInput"
                           placeholder="학습용 콘텐츠 검색하기"
                           oninput="searchLearningContents(this.value)"
                           style="width: 100%; padding: 8px 12px; border: 1px solid #495057; border-radius: 6px; font-size: 13px; font-family: 'Noto Sans KR', sans-serif; transition: all 0.2s;">
                </div>

                <!-- 검색 결과 영역 (검색 시에만 표시) -->
                <div id="learningSearchResults" style="display: none;">
                    <!-- 검색 결과가 여기에 동적으로 추가됨 -->
                </div>

                <!-- 학습 콘텐츠 트리 (기본 표시) -->
                <div id="learningContentsTree">
                    <!-- Claude & Claude Code 사용법 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">Claude & Claude Code 사용법</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Claude 기본</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>프롬프트 작성</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>대화 관리</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>컨텍스트 활용</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>효율적인 질문법</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>결과물 검증</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Claude Code 기본</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>프로젝트 초기화</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>파일 관리</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>코드 생성</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>디버깅 방법</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Git 통합</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Claude Code 심화</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Agent 활용</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>MCP 연동</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>세션 관리</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>성능 최적화</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>팀 협업</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>프로젝트 실습</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>웹 프로젝트</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>API 개발</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>DB 설계</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>배포 자동화</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>문제 해결</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>고급 기법</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>복잡한 작업 분할</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>멀티 Agent</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>프롬프트 엔지니어링</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>코드 리팩토링</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>보안 점검</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 웹사이트 개발 기초 지식 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">웹사이트 개발 기초 지식</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>HTML/CSS</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>HTML5 구조</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>CSS 레이아웃</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>반응형 디자인</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Flexbox/Grid</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>애니메이션</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>JavaScript</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>ES6+ 문법</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>DOM 조작</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>비동기 처리</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>이벤트 핸들링</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>API 통신</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>React</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>컴포넌트 기초</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Hooks 활용</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>상태 관리</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>라우팅</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>폼 처리</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Backend</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Node.js 기초</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Express 서버</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>REST API</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>데이터베이스 연동</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>인증/보안</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>배포/운영</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Git/GitHub</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Vercel 배포</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>환경 변수</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>CI/CD</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>모니터링</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 프로젝트 관리 방법 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">프로젝트 관리 방법</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>SAL 그리드</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>그리드 구조</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Phase 관리</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>진행도 추적</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Task 관리</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Task 생성</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>우선순위 설정</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>상태 관리</span>
                            </div>
                        </div>

                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>AI 자동화</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>자동 코드 생성</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>테스트 자동화</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>배포 자동화</span>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
                <!-- learningContentsTree 끝 -->
            </div>
            <!-- 학습용 콘텐츠 섹션 끝 -->

            <!-- FAQ -->
            <div class="sidebar-section">
                <h3>🙋 FAQ</h3>

                <!-- FAQ 로딩 메시지 -->
                <div id="faqLoading" style="padding: 12px; text-align: center; color: #666; font-size: 13px;">
                    ⏳ FAQ 로딩 중...
                </div>

                <!-- FAQ 동적 콘텐츠 컨테이너 -->
                <div id="faqContainer"></div>

                <!-- 기존 정적 FAQ (백업용 - 삭제 예정) -->
                <div id="faqStaticBackup" style="display: none;">
                <!-- 1. 로그인/회원가입 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">로그인/회원가입</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <!-- Depth 2-1: 계정 관리 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>계정 관리</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>비밀번호 재설정</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>이메일 인증 오류</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>계정 삭제 방법</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>프로필 수정</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>로그인 오류 해결</span>
                            </div>
                        </div>

                        <!-- Depth 2-2: 회원가입 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>회원가입</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>가입 절차</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>이메일 인증</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>약관 동의</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>프로필 설정</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>가입 오류</span>
                            </div>
                        </div>

                        <!-- Depth 2-3: 보안 설정 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>보안 설정</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>2단계 인증</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>비밀번호 정책</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>로그인 기록</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>기기 관리</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>보안 경고</span>
                            </div>
                        </div>

                        <!-- Depth 2-4: 소셜 로그인 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>소셜 로그인</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Google 연동</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>GitHub 연동</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>계정 연결 해제</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>연동 오류</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>권한 관리</span>
                            </div>
                        </div>

                        <!-- Depth 2-5: 계정 복구 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>계정 복구</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>잠긴 계정 복구</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>이메일 분실</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>복구 코드</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>고객 지원 요청</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>본인 인증</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. Order 작성 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">Order 작성</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <!-- Depth 2-1: 작성 가이드 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>작성 가이드</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Order 작성 기본</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>마크다운 문법</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>템플릿 활용</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>자동 저장 기능</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>저장 오류 해결</span>
                            </div>
                        </div>

                        <!-- Depth 2-2: Order 보내기 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Order 보내기</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>전송 방법</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>전송 확인</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>전송 취소</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>재전송</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>전송 오류</span>
                            </div>
                        </div>

                        <!-- Depth 2-3: 템플릿 관리 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>템플릿 관리</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>기본 템플릿</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>커스텀 템플릿</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>템플릿 저장</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>템플릿 공유</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>템플릿 삭제</span>
                            </div>
                        </div>

                        <!-- Depth 2-4: Order 히스토리 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Order 히스토리</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>히스토리 보기</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>히스토리 검색</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>히스토리 필터</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>히스토리 내보내기</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>히스토리 삭제</span>
                            </div>
                        </div>

                        <!-- Depth 2-5: 첨부 파일 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>첨부 파일</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>파일 업로드</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>파일 크기 제한</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>지원 파일 형식</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>파일 미리보기</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>파일 삭제</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. AI 기능 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">AI 기능</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <!-- Depth 2-1: Perplexity -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Perplexity 사용법</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>사용 방법</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>크레딧 충전</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>답변 품질 개선</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>API 연동</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>오류 해결</span>
                            </div>
                        </div>

                        <!-- Depth 2-2: ChatGPT -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>ChatGPT 사용법</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>기본 사용</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>프롬프트 작성</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>대화 기록</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>모델 선택</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>사용량 확인</span>
                            </div>
                        </div>

                        <!-- Depth 2-3: Gemini -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Gemini 사용법</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>Gemini 소개</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>이미지 분석</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>코드 생성</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>멀티모달 기능</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>제한 사항</span>
                            </div>
                        </div>

                        <!-- Depth 2-4: AI 비교 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>AI 비교</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>성능 비교</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>가격 비교</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>특징 비교</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>추천 사용 사례</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>선택 가이드</span>
                            </div>
                        </div>

                        <!-- Depth 2-5: API 설정 -->
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>API 설정</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>API 키 발급</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>환경 변수 설정</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>보안 설정</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>사용량 모니터링</span>
                            </div>
                            <div class="knowledge-small">
                                <span class="knowledge-small-bullet">●</span>
                                <span>오류 처리</span>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
                <!-- faqStaticBackup 끝 -->
            </div>

            <!-- Claude Code 업데이트 -->
            <div class="sidebar-section">
                <h3>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="10" fill="#D97706"/>
                        <path d="M15 8C14 6.5 12.5 6 11 6C8 6 6 8.5 6 12C6 15.5 8 18 11 18C12.5 18 14 17.5 15 16" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
                        <circle cx="16" cy="9" r="1.5" fill="white"/>
                    </svg>
                    Claude Code 업데이트
                </h3>

                <!-- 1. Anthropic 소식 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">Anthropic 소식</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <div class="knowledge-medium" onclick="window.open('https://docs.anthropic.com/en/docs/claude-code', '_blank'); event.stopPropagation();">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>공식 문서</span>
                            </div>
                        </div>
                        <div class="knowledge-medium" onclick="window.open('https://www.anthropic.com/blog', '_blank'); event.stopPropagation();">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>공식 블로그</span>
                            </div>
                        </div>
                        <div class="knowledge-medium" onclick="window.open('https://www.anthropic.com/news', '_blank'); event.stopPropagation();">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>뉴스룸</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. GitHub Releases -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">GitHub Releases</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <div class="knowledge-medium" onclick="window.open('https://github.com/anthropics/claude-code', '_blank'); event.stopPropagation();">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>Claude Code 리포지토리</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. 국내 뉴스 -->
                <div class="knowledge-item">
                    <div class="knowledge-major" onclick="toggleKnowledge(this)">
                        <span class="knowledge-icon"></span>
                        <span class="knowledge-name">국내 뉴스</span>
                        <span class="knowledge-arrow">▶</span>
                    </div>
                    <div class="knowledge-medium-list">
                        <div class="knowledge-medium" onclick="window.open('https://www.aitimes.com', '_blank'); event.stopPropagation();">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>AI타임스</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 다른 AI에게 묻기 -->
            <div class="sidebar-section">
                <h3>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                        style="display: inline-block; vertical-align: middle;">
                        <path d="M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z"
                            fill="var(--secondary)" stroke="var(--secondary)" stroke-width="1"/>
                        <path d="M19 3L20 6L23 7L20 8L19 11L18 8L15 7L18 6L19 3Z"
                            fill="var(--secondary)" opacity="0.7"/>
                    </svg>
                    다른 AI에게 묻기
                </h3>

                <!-- AI 선택 버튼 -->
                <div style="display: flex; gap: 4px; margin-bottom: 12px; flex-wrap: nowrap;">
                    <button class="ai-selector-btn active" data-ai="chatgpt"
                        onclick="selectAI('chatgpt', event)">ChatGPT</button>
                    <button class="ai-selector-btn" data-ai="gemini" onclick="selectAI('gemini', event)">Gemini</button>
                    <button class="ai-selector-btn" data-ai="perplexity"
                        onclick="selectAI('perplexity', event)">Perplexity</button>
                </div>

                <!-- 로딩 메시지 -->
                <div id="aiLoading"
                    style="display: none; padding: 8px; margin-bottom: 8px; background: #e3f2fd; border-left: 3px solid #2196f3; border-radius: 4px; font-size: 13px; color: #1976d2;">
                    <span style="display: inline-block; margin-right: 6px;">⏳</span>
                    <span id="aiLoadingText">AI에게 질문 중...</span>
                </div>

                <div class="ai-input-area">
                    <textarea id="aiQuestion" placeholder="질문을 입력하세요..." rows="4"></textarea>
                    <button onclick="askAI()">질문하기</button>
                    <div class="perplexity-credit-display"
                        style="margin-top: 8px; font-size: 12px; color: #666; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px;">
                        <span>크레딧 잔액: <span style="color: #333;">₩<span
                                    id="perplexityCreditBalance">10,000</span></span></span>
                        <button onclick="rechargeCredit()"
                            style="padding: 4px 12px; font-size: 12px; background: var(--secondary); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600;">충전하기</button>
                    </div>

                    <!-- 질문 이력 버튼 -->
                    <div style="margin-top: 6px;">
                        <button onclick="openQuestionHistoryModal()"
                            style="width: 100%; padding: 10px; font-size: 12px; font-weight: 500; background: rgba(245, 158, 11, 0.08); border: 1px solid #999; border-radius: 8px; cursor: pointer; color: #333; transition: all 0.2s;"
                            onmouseover="this.style.background='rgba(245, 158, 11, 0.15)'; this.style.borderColor='#F59E0B';"
                            onmouseout="this.style.background='rgba(245, 158, 11, 0.08)'; this.style.borderColor='#999';">질문 / 답변 이력 보기</button>
                    </div>
                </div>
            </div>

            <!-- Support -->
            <div class="sidebar-section">
                <h3>☀️ Sunny에게 묻기</h3>
                <div class="support-input-area">
                    <textarea id="supportQuestion"
                        placeholder="사용법 문의, 문제 해결, 버그 신고, 기능 제안, 사업계획서 검토, 비즈니스 멘토링까지! AI 활용 능력 고수 + 공인회계사 + 엑셀러레이터 인 Sunny에게 자유롭게 문의하세요!"
                        rows="4"></textarea>
                    <div style="display: flex; gap: 8px;">
                        <button onclick="document.getElementById('supportFile').click()"
                            style="flex: 1; padding: 10px; font-size: 12px; background: rgba(245, 158, 11, 0.08); border: 1px solid #999; border-radius: 8px; cursor: pointer; color: #333; font-weight: 500; transition: all 0.2s;"
                            onmouseover="this.style.background='rgba(245, 158, 11, 0.15)'; this.style.borderColor='#F59E0B';"
                            onmouseout="this.style.background='rgba(245, 158, 11, 0.08)'; this.style.borderColor='#999';">파일 첨부</button>
                        <button onclick="submitSupport()"
                            style="flex: 2; padding: 10px; font-size: 12px; background: var(--secondary); color: white; border: none; border-radius: var(--border-radius); font-weight: 600; cursor: pointer; transition: all 0.2s;">제출하기</button>
                    </div>
                    <input type="file" id="supportFile" multiple accept="image/*,.pdf,.doc,.docx,.xls,.xlsx"
                        style="display: none;" onchange="handleSupportFileSelect(event)">
                    <div id="supportFileList" style="font-size: 12px; color: #666; max-height: 60px; overflow-y: auto;">
                    </div>
                </div>
            </div>

            <!-- Notices Section -->
            <div class="sidebar-section">
                <h3>📢 공지사항</h3>
                <div id="noticesList">
                    <div style="text-align: center; padding: 20px; color: #6c757d;">
                        공지사항을 불러오는 중...
                    </div>
                </div>
            </div>
        </aside>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-inner">
                <div class="footer-links">
                    <a href="#" class="footer-link" onclick="openServiceIntro(); return false;">서비스 소개</a>
                    <a href="#" class="footer-link">이용약관</a>
                    <a href="#" class="footer-link">개인정보처리방침</a>
                </div>
                <div class="footer-copyright">
                    <span>© 2025 SSAL Works, All Rights Reserved</span>
                    <a href="admin-dashboard_prototype.html" class="admin-link" style="margin-left: 16px;">Admin</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Server Status Indicator -->
    <div id="serverStatus" class="server-status"></div>

    <script>
        // 프로젝트별 inbox 경로 설정
        const PROJECT_CONFIGS = {
            'PoliticianFinder': {
                name: 'PoliticianFinder',
                inboxPath: 'C:\\Development_PoliticianFinder_copy\\Web_ClaudeCode_Bridge\\Inbox',
                status: '완료'
            },
            'SSAL Works': {
                name: 'SSAL Works',
                inboxPath: 'C:\\!SSAL_Works_Private\\Web_ClaudeCode_Bridge\\Inbox',
                status: '진행중'
            }
        };

        // 현재 선택된 프로젝트 (전역 변수)
        // 진행중인 프로젝트를 기본값으로 자동 설정
        let currentSelectedProject = 'SSAL Works';

        // Sidebar structure data (updated 2025-11-27)
        const SIDEBAR_STRUCTURE = {
            "metadata": { "lastUpdate": "2025-11-27", "source": "PROJECT_DIRECTORY_STRUCTURE.md" },
            "specialStages": [
                { "id": "dir_structure", "name": "작업 디렉토리 구조 생성", "icon": "☆", "type": "special" },
                { "id": "sal_grid", "name": "Project SAL GRID 생성", "icon": "☆", "type": "special" }
            ],
            "prepStages": [
                { "id": "0_사업계획", "name": "사업계획", "icon": "○", "path": "0_사업계획", "categories": ["0-1_Vision_Mission", "0-2_Market_Analysis", "0-3_Business_Model"] },
                { "id": "0_프로젝트_기획", "name": "프로젝트 기획", "icon": "○", "path": "0_프로젝트_기획", "categories": ["1-1_Project_Plan", "1-2_Requirements", "1-3_User_Flows", "1-4_Workflows", "1-5_Design_System", "1-6_UI_UX_Mockup"] }
            ],
            "executionStages": [
                { "id": "S1", "name": "프로토타입 제작", "path": "1_프로토타입_제작", "areas": ["Documentation", "Design", "Frontend", "Database"] },
                { "id": "S2", "name": "개발 준비", "path": "2_개발_준비", "areas": ["Documentation", "Backend_Infra", "Database", "Security"] },
                { "id": "S3", "name": "개발 1차", "path": "3_개발-1차", "areas": ["Documentation", "Design", "Frontend", "Backend_Infra", "Backend_API", "Database", "Security", "Testing", "DevOps", "External", "Content_System"] },
                { "id": "S4", "name": "개발 2차", "path": "4_개발-2차", "areas": ["Documentation", "Design", "Frontend", "Backend_Infra", "Backend_API", "Database", "Security", "Testing", "DevOps", "External", "Content_System"] },
                { "id": "S5", "name": "개발 3차", "path": "5_개발-3차", "areas": ["Documentation", "Design", "Frontend", "Backend_Infra", "Backend_API", "Database", "Security", "Testing", "DevOps", "External", "Content_System"] },
                { "id": "S6", "name": "운영", "path": "6_운영", "areas": ["Documentation", "Frontend", "Backend_API", "Database", "Security", "Testing", "DevOps", "External", "Content_System"] }
            ]
        };

        // Load sidebar structure
        function loadSidebarStructure() {
            console.log('✅ Sidebar structure loaded from embedded data');
            renderSidebarFromJSON(SIDEBAR_STRUCTURE);
        }

        // Render sidebar from JSON data
        function renderSidebarFromJSON(data) {
            const processListContainer = document.querySelector('.process-list');
            if (!processListContainer) {
                console.error('❌ .process-list container not found');
                return;
            }

            // Clear existing content
            processListContainer.innerHTML = '';

            data.structure.forEach((phase, index) => {
                const phaseHTML = generatePhaseHTML(phase, index);
                processListContainer.insertAdjacentHTML('beforeend', phaseHTML);
            });

            console.log('✅ Sidebar rendered from JSON');
        }

        // Generate HTML for a phase
        function generatePhaseHTML(phase, index) {
            const progress = 0; // Default progress
            const status = index === 0 ? 'completed' : index === 1 ? 'active' : '';

            let html = `
                <div class="process-item">
                    <div class="process-major ${status}" onclick="toggleProcess(this)" data-progress="${progress}">
                        <div class="process-header">
                            <span class="process-name">${phase.name}</span>
                            <span class="process-arrow">▶</span>
                        </div>
                        <div class="process-progress-container">
                            <div class="process-progress">
                                <div class="process-progress-fill" style="width: ${progress}%"></div>
                            </div>
                            <span class="process-percent">${progress}%</span>
                        </div>
                    </div>
                    <div class="process-small-list">`;

            // Direct items (소분류 directly under phase)
            if (phase.items) {
                phase.items.forEach(item => {
                    html += generateDirectItemHTML(item, phase.id);
                });
            }

            // Categories (중분류)
            if (phase.categories) {
                phase.categories.forEach(category => {
                    html += generateCategoryHTML(category, phase.id);
                });
            }

            html += `
                    </div>
                </div>`;

            return html;
        }

        // Generate HTML for direct items (소분류 - phase 직속)
        function generateDirectItemHTML(item, phaseId) {
            return `
                <div class="process-small" onclick="loadTemplate('${item.id}')" ondblclick="openFolder('${phaseId}/${item.id}'); event.stopPropagation();" title="${item.name_ko}">
                    <div class="process-small-content">
                        <span class="process-small-bullet">▪</span>
                        <span>${item.name_en}</span>
                    </div>
                </div>`;
        }

        // Generate HTML for a category (중분류)
        function generateCategoryHTML(category, phaseId) {
            let html = `
                <div class="process-small" onclick="loadTemplate('${category.id}'); toggleProcessTiny(this)" ondblclick="openFolder('${phaseId}/${category.id}'); event.stopPropagation();" title="${category.name_ko}">
                    <div class="process-small-content">
                        <span style="font-weight: 600;">${category.name_en}</span>
                    </div>
                    <span class="process-small-arrow">▼</span>
                </div>
                <div class="process-tiny-list">`;

            if (category.items) {
                category.items.forEach(item => {
                    html += `
                    <div class="process-tiny" title="${item.name_ko}">
                        <span style="opacity: 0.5; margin-right: 4px;">▫</span>
                        <span>${item.name_en}</span>
                    </div>`;
                });
            }

            html += `</div>`;
            return html;
        }

        // Load sidebar on page load
        document.addEventListener('DOMContentLoaded', () => {
            // loadSidebarStructure(); // ❌ 비활성화 - HTML에 직접 작성된 진행률(55%) 사용
            console.log('✅ Using static HTML structure with progress data');
            updateProgressBackgrounds();
        function updateProgressBackgrounds() {
            document.querySelectorAll('.process-major').forEach(el => {
                const progress = parseInt(el.getAttribute('data-progress') || 0);
                if (el.classList.contains('completed')) return;
                const minOpacity = 0.08;
                const maxOpacity = 0.25;
                const opacity = minOpacity + (maxOpacity - minOpacity) * (progress / 100);
                const minBorderOpacity = 0.2;
                const maxBorderOpacity = 0.5;
                const borderOpacity = minBorderOpacity + (maxBorderOpacity - minBorderOpacity) * (progress / 100);
                el.style.backgroundColor = `rgba(16, 185, 129, ${opacity})`;
                el.style.borderColor = `rgba(16, 185, 129, ${borderOpacity})`;
            });
        }

        });

        // Toggle process prep sub-items (준비단계 ○)
        function toggleProcessPrep(el) {
            const item = el.parentElement;
            const smallList = item.querySelector('.process-small-list');
            const arrow = el.querySelector('.process-arrow');

            if (smallList) {
                smallList.classList.toggle('expanded');
                if (arrow) {
                    arrow.classList.toggle('expanded');
                }
            }
        }

        // Toggle process sub-items
        function toggleProcess(el) {
            const item = el.parentElement;
            const smallList = item.querySelector('.process-small-list');
            const arrow = el.querySelector('.process-arrow');

            console.log('toggleProcess called', { item, smallList, arrow });

            if (smallList) {
                const wasExpanded = smallList.classList.contains('expanded');
                smallList.classList.toggle('expanded');
                console.log('smallList toggled, now expanded:', !wasExpanded);

                if (arrow) {
                    arrow.classList.toggle('expanded');
                }
            }

            document.querySelectorAll('.process-major').forEach(major => {
                if (major !== el) major.classList.remove('active');
            });
            if (!el.classList.contains('completed')) {
                el.classList.toggle('active');
            }
        }

        // Toggle knowledge sub-items (2nd level)
        function toggleKnowledge(el) {
            const item = el.parentElement;
            const mediumList = item.querySelector('.knowledge-medium-list');
            const arrow = el.querySelector('.knowledge-arrow');

            console.log('toggleKnowledge called', { item, mediumList, arrow });

            if (mediumList) {
                const wasExpanded = mediumList.classList.contains('expanded');
                mediumList.classList.toggle('expanded');
                console.log('mediumList toggled, now expanded:', !wasExpanded);

                if (arrow) {
                    arrow.classList.toggle('expanded');
                }
            }
        }

        // Toggle knowledge small items (3rd level)
        function toggleKnowledgeSmall(el) {
            const nextSibling = el.nextElementSibling;
            const arrow = el.querySelector('.knowledge-medium-arrow');

            if (nextSibling && nextSibling.classList.contains('knowledge-small-list')) {
                nextSibling.classList.toggle('expanded');
                if (arrow) {
                    arrow.classList.toggle('expanded');
                }
            }
        }

        // Toggle process tiny items (3rd level)
        function toggleProcessTiny(el) {
            const nextSibling = el.nextElementSibling;
            const arrow = el.querySelector('.process-small-arrow');

            if (nextSibling && nextSibling.classList.contains('process-tiny-list')) {
                nextSibling.classList.toggle('expanded');
                if (arrow) {
                    arrow.classList.toggle('expanded');
                }
            }
        }

        // Clear editor
        function clearEditor() {
            if (confirm('Workspace에 작성 중인 내용을 지우시겠습니까?')) {
                document.getElementById('textEditor').value = '';
            }
        }

        // Show status message
        function showStatus(message, type = 'info', duration = 3000) {
            const status = document.getElementById('serverStatus');
            status.textContent = message;
            status.className = 'server-status show ' + type;

            setTimeout(() => {
                status.className = 'server-status';
            }, duration);
        }

        // Order Sheet Template Loading
        let ordersheetTemplates = null;

        // Load templates on page load
        async function loadOrderSheetTemplates() {
            try {
                const response = await fetch('http://localhost:3030/ordersheet-templates');
                if (!response.ok) {
                    console.error('Failed to load ordersheet templates');
                    return;
                }
                const data = await response.json();
                if (data.success) {
                    ordersheetTemplates = data.templates;
                    console.log('✅ Order Sheet templates loaded:', Object.keys(ordersheetTemplates).length);
                }
            } catch (error) {
                console.error('Error loading ordersheet templates:', error);
            }
        }

        // Load template when category is clicked
        async function loadTemplate(categoryKey) {
            if (!ordersheetTemplates || !ordersheetTemplates[categoryKey]) {
                console.warn('Template not found for:', categoryKey);
                // 템플릿이 없는 경우 안내 메시지 표시
                showStatus(`📂 "${categoryKey}" 폴더를 열려면 더블클릭하세요 (Antigravity 또는 VS Code 선택)`, 'info');
                return;
            }

            const template = ordersheetTemplates[categoryKey];
            const editor = document.getElementById('textEditor');

            // Ask user if they want to replace current content
            if (editor.value.trim() && !(await customConfirm('현재 Workspace에서 작성 중인 내용을 지우고 해당 항목에 대한 템플릿으로 바꾸시겠습니까?'))) {
                return;
            }

            editor.value = template.template;
            showStatus(`✅ "${template.name}" 템플릿이 로드되었습니다`, 'success');
        }

        // Load welcome message on page load
        // Load welcome message on page load (서버에서 마크다운 파일 로드)
        async function loadWelcomeMessage() {
            const editor = document.getElementById('textEditor');

            try {
                // Bridge 서버에서 안내문 로드
                const guideName = encodeURIComponent('Welcome_시작안내');
                const response = await fetch(`http://localhost:3030/guide/${guideName}`);

                if (response.ok) {
                    const data = await response.json();
                    if (data.success && data.markdown) {
                        editor.value = data.markdown;
                        console.log('✅ Welcome 안내문 로드 완료');
                        return;
                    }
                }

                // 서버 연결 실패 시 기본 메시지
                editor.value = `# 🚀 SSAL Works Dashboard

## 환영합니다!

Bridge 서버에 연결할 수 없습니다.
서버가 실행 중인지 확인해주세요.

**서버 시작 방법:**
\`\`\`bash
cd Web_ClaudeCode_Bridge
node inbox_server.js
\`\`\`

서버가 실행되면 새로고침 해주세요.
`;
                console.warn('⚠️ Bridge 서버 연결 실패, 기본 메시지 표시');

            } catch (error) {
                console.error('❌ Welcome 안내문 로드 실패:', error);
                editor.value = `# 🚀 SSAL Works Dashboard

## 서버 연결 오류

Bridge 서버(localhost:3030)에 연결할 수 없습니다.

**해결 방법:**
1. Web_ClaudeCode_Bridge 폴더로 이동
2. \`node inbox_server.js\` 실행
3. 페이지 새로고침
`;
            }
        }

        // 안내문 로드 함수 (다양한 안내문 지원)
        async function loadGuide(guideName) {
            const editor = document.getElementById('textEditor');

            try {
                const encodedName = encodeURIComponent(guideName);
                const response = await fetch(`http://localhost:3030/guide/${encodedName}`);

                if (response.ok) {
                    const data = await response.json();
                    if (data.success && data.markdown) {
                        editor.value = data.markdown;
                        showStatus(`✅ "${data.name}" 안내문 로드 완료`, 'success');
                        return true;
                    }
                }

                showStatus(`❌ "${guideName}" 안내문을 찾을 수 없습니다`, 'error');
                return false;

            } catch (error) {
                console.error('안내문 로드 실패:', error);
                showStatus('❌ 서버 연결 실패', 'error');
                return false;
            }
        }

        // Order Sheet 템플릿 로드 함수 (서버에서)
        async function loadOrderTemplate(category, templateName) {
            const editor = document.getElementById('textEditor');

            try {
                const encodedCategory = encodeURIComponent(category);
                const encodedTemplate = encodeURIComponent(templateName);
                const response = await fetch(`http://localhost:3030/order-template/${encodedCategory}/${encodedTemplate}`);

                if (response.ok) {
                    const data = await response.json();
                    if (data.success && data.markdown) {
                        // 현재 내용이 있으면 확인
                        if (editor.value.trim() && !(await customConfirm('현재 Workspace 내용을 템플릿으로 교체하시겠습니까?'))) {
                            return false;
                        }

                        editor.value = data.markdown;
                        showStatus(`✅ "${data.name}" 템플릿 로드 완료`, 'success');
                        return true;
                    }
                }

                showStatus(`❌ "${templateName}" 템플릿을 찾을 수 없습니다`, 'error');
                return false;

            } catch (error) {
                console.error('템플릿 로드 실패:', error);
                showStatus('❌ 서버 연결 실패', 'error');
                return false;
            }
        }

        // 현재 선택된 단계 데이터 저장
        let currentStageData = null;

        // ========== 전체 Stage 데이터 정의 ==========
        const STAGE_DATA = {
            // ===== 로그인 시 환영 =====
            'welcome': {
                stageId: 'welcome',
                stageName: '환영합니다',
                hasAction: false,  // 단순 안내 - [확인] 버튼만
                confirmMessage: '',
                orderSheetAfterExecute: `# SSAL Works 시작 가이드

## ✅ 환영합니다!

SSAL Works에 오신 것을 환영합니다.
AI와 함께 웹사이트를 개발하는 여정을 시작해보세요.

---

## 📝 첫 번째 할 일

1. 좌측 사이드바에서 프로젝트를 선택하세요
2. 진행 프로세스에서 현재 단계를 확인하세요
3. Order Sheet를 작성하여 작업을 요청하세요

---

## 추가 요청사항

[여기에 추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - 시작 가이드

## 기본 정보
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 요청사항

[여기에 요청사항을 작성하세요]

`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🌾 SSAL Works에 오신 것을 환영합니다!</h2>

<h3 style="margin-top: 24px; color: #333;">SSAL Works란?</h3>
<p>SSAL Works는 비개발자가 AI(Claude Code)와 협업하여 웹사이트를 개발하는 플랫폼입니다.</p>

<h3 style="margin-top: 24px; color: #333;">시작하기</h3>
<ol style="padding-left: 20px;">
<li style="margin-bottom: 8px;">좌측 사이드바에서 프로젝트를 선택하세요</li>
<li style="margin-bottom: 8px;">진행 프로세스에서 현재 단계를 확인하세요</li>
<li style="margin-bottom: 8px;">Order Sheet를 작성하여 Claude Code에 작업을 요청하세요</li>
</ol>
`
            },

            // ===== 예시 프로젝트 (SSAL Works 예시) =====
            'project_example': {
                stageId: 'project_example',
                stageName: 'SSAL Works (예시)',
                hasAction: false,  // 단순 안내 - [확인] 버튼만
                confirmMessage: '',
                orderSheetAfterExecute: '',
                orderSheet: '',
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📂 SSAL Works 예시 프로젝트</h2>

<p>이것은 완성된 프로젝트의 <strong>샘플 파일들을 구경</strong>할 수 있는 예시 프로젝트입니다.</p>

<h3 style="margin-top: 24px; color: #333;">예시 프로젝트란?</h3>
<p>실제 SSAL Works로 완성된 프로젝트가 어떤 구조와 파일들로 이루어져 있는지 미리 살펴볼 수 있습니다.</p>

<h3 style="margin-top: 24px; color: #333;">구경할 수 있는 내용</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">각 단계별 폴더 구조</li>
<li style="margin-bottom: 8px;">작성된 문서 샘플 (기획서, 요구사항 등)</li>
<li style="margin-bottom: 8px;">완성된 코드 예시</li>
<li style="margin-bottom: 8px;">Order Sheet 작성 예시</li>
</ul>

<h3 style="margin-top: 24px; color: #333;">사용 방법</h3>
<p>예시 프로젝트의 <strong>폴더와 파일들을 열어보며</strong> 실제 프로젝트가 어떻게 구성되는지 참고하세요.</p>

<div style="margin-top: 16px; padding: 12px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid var(--primary);">
<strong>💡 참고:</strong> 예시 프로젝트는 구경용입니다. 실제 작업을 시작하려면 "새로운 Project 추가" 버튼을 클릭하세요.
</div>
`
            },

            // ===== 실제 프로젝트 선택 =====
            'project_work': {
                stageId: 'project_work',
                stageName: '프로젝트 작업',
                hasAction: true,  // 실제 행위 - [예]/[아니오] 버튼
                confirmMessage: '이 프로젝트에 Order Sheet를 발행하시겠습니까?',
                orderSheetAfterExecute: `# 프로젝트 작업 Order Sheet

## ✅ 프로젝트가 선택되었습니다

선택한 프로젝트에서 작업을 진행합니다.

---

## 📝 추가 요청사항

[프로젝트 관련 추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - 프로젝트 작업 요청

## 기본 정보
- **Order ID**: OS-PRJ-[SEQ]
- **프로젝트명**: [프로젝트명]
- **작성일**: ${new Date().toISOString().split('T')[0]}
- **우선순위**: 보통

---

## 작업 요청 내용

### 요청 유형
- [ ] 새로운 기능 개발
- [ ] 기존 기능 수정
- [ ] 버그 수정
- [ ] 디자인 변경
- [ ] 문서 작성
- [ ] 기타

### 상세 요청사항

[구체적인 작업 내용을 작성하세요]

---

## 참고 자료

- 관련 파일: [파일 경로]
- 참고 링크: [URL]

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📦 프로젝트 작업 안내</h2>

<p>선택한 프로젝트에서 작업을 진행합니다.</p>

<h3 style="margin-top: 24px; color: #333;">프로젝트 작업 흐름</h3>
<ol style="padding-left: 20px;">
<li style="margin-bottom: 8px;">좌측 <strong>진행 프로세스</strong>에서 현재 단계 확인</li>
<li style="margin-bottom: 8px;">해당 단계의 Order Sheet 작성</li>
<li style="margin-bottom: 8px;">Inbox에 발행하여 Claude Code에 작업 요청</li>
<li style="margin-bottom: 8px;">Outbox에서 작업 결과 확인</li>
</ol>

<h3 style="margin-top: 24px; color: #333;">Order Sheet 작성 방법</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;"><strong>요청 유형</strong>을 선택하세요</li>
<li style="margin-bottom: 8px;"><strong>상세 요청사항</strong>을 구체적으로 작성하세요</li>
<li style="margin-bottom: 8px;">필요시 <strong>참고 자료</strong>를 첨부하세요</li>
</ul>

<div style="margin-top: 16px; padding: 12px; background: #fffbeb; border-radius: 8px; border-left: 4px solid #f59e0b;">
<strong>⚠️ 주의:</strong> Order Sheet는 명확하고 구체적으로 작성할수록 더 정확한 결과를 얻을 수 있습니다.
</div>
`
            },

            // ===== ☆ 특별단계: 디렉토리 구조 생성 =====
            'dir_structure': {
                stageId: 'dir_structure',
                stageName: '작업 디렉토리 구조 생성',
                hasAction: true,  // 실제 행위 - [예]/[아니오] 버튼
                confirmMessage: '디렉토리 구조를 위와 같이 생성하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 디렉토리 구조 생성

## 기본 정보
- **Order ID**: OS-SP-01-A-002
- **작성일**: ${new Date().toISOString().split('T')[0]}
- **관련 작업**: ☆ 디렉토리 구조 생성

---

## ✅ 자동 실행된 항목

- [x] 사업계획 폴더 (0-1 ~ 0-3)
- [x] 프로젝트_기획 폴더 (1-1 ~ 1-6)
- [x] 프로토타입_제작 폴더
- [x] 개발_준비 폴더
- [x] 개발_1차~3차 폴더
- [x] 운영 폴더
- [x] Web_ClaudeCode_Bridge 폴더

---

## 📝 추가 요청사항

[추가로 필요한 작업을 작성하세요]

`,
                orderSheet: `# Order Sheet - 디렉토리 구조 생성

## 기본 정보
- **Order ID**: OS-SP-01-A-001
- **단계 유형**: ☆ 특별단계
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 상세 요구사항

### 프로젝트 기본 정보
- **프로젝트 이름**: [프로젝트명 입력]
- **프로젝트 경로**: [경로 입력]

### 생성할 디렉토리 구조
- [ ] 사업계획 폴더 (0-1 ~ 0-3)
- [ ] 프로젝트_기획 폴더 (1-1 ~ 1-6)
- [ ] 프로토타입_제작 폴더
- [ ] 개발_준비 폴더
- [ ] 개발_1차~3차 폴더
- [ ] 운영 폴더
- [ ] Web_ClaudeCode_Bridge 폴더

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📁 디렉토리 구조 생성 안내</h2>

<h3 style="margin-top: 24px; color: #333;">1. 개요</h3>
<p>표준화된 프로젝트 디렉토리 구조를 생성합니다.</p>

<h3 style="margin-top: 24px; color: #333;">2. 표준 구조</h3>
<div style="background: #f8f9fa; padding: 16px; border-radius: 8px; font-family: monospace; font-size: 12px;">
📂 프로젝트_루트/<br>
├── 📁 0_사업계획/<br>
├── 📁 1_프로젝트_기획/<br>
├── 📁 2_프로토타입_제작/<br>
├── 📁 3_개발_준비/<br>
├── 📁 4~6_개발_1차~3차/<br>
├── 📁 7_운영/<br>
└── 📁 Web_ClaudeCode_Bridge/
</div>

<h3 style="margin-top: 24px; color: #333;">3. 주의사항</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">기존 파일은 덮어쓰지 않습니다</li>
<li style="margin-bottom: 8px;">UTF-8 인코딩 사용</li>
</ul>
`
            },

            // ===== ☆ 특별단계: SAL Grid 생성 =====
            'sal_grid': {
                stageId: 'sal_grid',
                stageName: 'Project SAL Grid 생성',
                hasAction: true,  // 실제 행위 - [예]/[아니오] 버튼
                confirmMessage: 'SAL Grid를 위와 같이 생성하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - SAL Grid 생성

## ✅ 자동 실행된 항목

- [x] SAL Grid 기본 구조 생성
- [x] Stage(단계) 정의
- [x] Area(영역) 정의
- [x] Level(레벨) 정의

---

## 📝 추가 요청사항

[추가로 필요한 작업을 작성하세요]

`,
                orderSheet: `# Order Sheet - SAL Grid 생성

## 기본 정보
- **Order ID**: OS-SP-02-A-001
- **단계 유형**: ☆ 특별단계
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## SAL Grid 설정

### Stage (단계)
- [ ] S1: 프로토타입 제작
- [ ] S2: 개발 준비
- [ ] S3: 개발 1차
- [ ] S4: 개발 2차
- [ ] S5: 개발 3차
- [ ] S6: 운영

### Area (영역)
- [ ] Frontend
- [ ] Backend
- [ ] Database
- [ ] DevOps

### Level (레벨)
- [ ] L1: 기본
- [ ] L2: 중급
- [ ] L3: 고급

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📊 SAL Grid 생성 안내</h2>

<h3 style="margin-top: 24px; color: #333;">SAL Grid란?</h3>
<p>프로젝트를 3차원 좌표(Stage, Area, Level)로 관리하는 시스템입니다.</p>

<h3 style="margin-top: 24px; color: #333;">구성 요소</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;"><strong>S (Stage)</strong>: 개발 단계 (S1~S6)</li>
<li style="margin-bottom: 8px;"><strong>A (Area)</strong>: 작업 영역 (Frontend, Backend 등)</li>
<li style="margin-bottom: 8px;"><strong>L (Level)</strong>: 작업 레벨 (기본~고급)</li>
</ul>
`
            },

            // ===== ○ 사업계획: 0-1 시장조사 =====
            'biz_0_1': {
                stageId: 'biz_0_1',
                stageName: '0-1 시장조사',
                hasAction: true,
                confirmMessage: '시장조사를 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 시장조사

## ✅ 자동 실행된 항목

- [x] 시장 규모 조사
- [x] 타겟 고객 분석
- [x] 트렌드 분석

---

## 📝 추가 요청사항

[추가로 필요한 조사 항목을 작성하세요]

`,
                orderSheet: `# Order Sheet - 시장조사

## 기본 정보
- **Order ID**: OS-0-1-A-001
- **단계 유형**: ○ 사업계획
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 조사 항목

- [ ] 시장 규모 조사
- [ ] 타겟 고객 분석
- [ ] 트렌드 분석
- [ ] 진입 장벽 분석

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📈 시장조사 안내</h2>

<h3 style="margin-top: 24px; color: #333;">조사 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">시장 규모 및 성장률</li>
<li style="margin-bottom: 8px;">타겟 고객 세그먼트</li>
<li style="margin-bottom: 8px;">시장 트렌드</li>
<li style="margin-bottom: 8px;">진입 장벽</li>
</ul>
`
            },

            // ===== ○ 사업계획: 0-2 경쟁분석 =====
            'biz_0_2': {
                stageId: 'biz_0_2',
                stageName: '0-2 경쟁분석',
                hasAction: true,
                confirmMessage: '경쟁분석을 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 경쟁분석

## ✅ 자동 실행된 항목

- [x] 경쟁사 목록 조사
- [x] 경쟁사 강약점 분석
- [x] 차별화 포인트 도출

---

## 📝 추가 요청사항

[추가로 필요한 분석 항목을 작성하세요]

`,
                orderSheet: `# Order Sheet - 경쟁분석

## 기본 정보
- **Order ID**: OS-0-2-A-001
- **단계 유형**: ○ 사업계획
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 분석 항목

- [ ] 경쟁사 목록 조사
- [ ] 경쟁사 강약점 분석
- [ ] 차별화 포인트 도출

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🔍 경쟁분석 안내</h2>

<h3 style="margin-top: 24px; color: #333;">분석 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">주요 경쟁사 파악</li>
<li style="margin-bottom: 8px;">경쟁사 강점/약점 분석</li>
<li style="margin-bottom: 8px;">우리의 차별화 포인트</li>
</ul>
`
            },

            // ===== ○ 사업계획: 0-3 사업계획서 =====
            'biz_0_3': {
                stageId: 'biz_0_3',
                stageName: '0-3 사업계획서',
                hasAction: true,
                confirmMessage: '사업계획서를 위와 같이 작성하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 사업계획서

## ✅ 자동 실행된 항목

- [x] 사업 개요 작성
- [x] 수익 모델 정의
- [x] 마케팅 전략 수립

---

## 📝 추가 요청사항

[추가로 필요한 항목을 작성하세요]

`,
                orderSheet: `# Order Sheet - 사업계획서

## 기본 정보
- **Order ID**: OS-0-3-A-001
- **단계 유형**: ○ 사업계획
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작성 항목

- [ ] 사업 개요
- [ ] 수익 모델
- [ ] 마케팅 전략
- [ ] 재무 계획

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📋 사업계획서 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작성 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">사업 개요 및 비전</li>
<li style="margin-bottom: 8px;">수익 모델</li>
<li style="margin-bottom: 8px;">마케팅 전략</li>
<li style="margin-bottom: 8px;">재무 계획</li>
</ul>
`
            },

            // ===== ○ 프로젝트 기획: 1-1 ~ 1-6 =====
            'plan_1_1': {
                stageId: 'plan_1_1',
                stageName: '1-1 Project Plan',
                hasAction: true,
                confirmMessage: 'Project Plan을 위와 같이 작성하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - Project Plan

## ✅ 자동 실행된 항목

- [x] 프로젝트 목표 정의
- [x] 범위 설정
- [x] 일정 계획

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - Project Plan

## 기본 정보
- **Order ID**: OS-1-1-A-001
- **단계 유형**: ○ 프로젝트 기획
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작성 항목

- [ ] 프로젝트 목표
- [ ] 범위 설정
- [ ] 일정 계획
- [ ] 리소스 계획

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📝 Project Plan 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작성 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">프로젝트 목표 및 비전</li>
<li style="margin-bottom: 8px;">범위(Scope) 설정</li>
<li style="margin-bottom: 8px;">일정 계획</li>
</ul>
`
            },

            'plan_1_2': {
                stageId: 'plan_1_2',
                stageName: '1-2 Requirements',
                hasAction: true,
                confirmMessage: '요구사항을 위와 같이 정의하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - Requirements

## ✅ 자동 실행된 항목

- [x] 기능 요구사항 정의
- [x] 비기능 요구사항 정의

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - Requirements

## 기본 정보
- **Order ID**: OS-1-2-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 기능 요구사항

- [ ] [기능 1]
- [ ] [기능 2]

## 비기능 요구사항

- [ ] 성능
- [ ] 보안

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">📋 Requirements 안내</h2>

<h3 style="margin-top: 24px; color: #333;">정의 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">기능 요구사항</li>
<li style="margin-bottom: 8px;">비기능 요구사항</li>
</ul>
`
            },

            'plan_1_3': {
                stageId: 'plan_1_3',
                stageName: '1-3 Architecture',
                hasAction: true,
                confirmMessage: '아키텍처를 위와 같이 설계하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - Architecture

## ✅ 자동 실행된 항목

- [x] 시스템 아키텍처 설계
- [x] 기술 스택 선정

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - Architecture

## 기본 정보
- **Order ID**: OS-1-3-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 설계 항목

- [ ] 시스템 아키텍처
- [ ] 기술 스택 선정
- [ ] 인프라 설계

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🏗️ Architecture 안내</h2>

<h3 style="margin-top: 24px; color: #333;">설계 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">시스템 아키텍처</li>
<li style="margin-bottom: 8px;">기술 스택</li>
<li style="margin-bottom: 8px;">인프라 구성</li>
</ul>
`
            },

            'plan_1_4': {
                stageId: 'plan_1_4',
                stageName: '1-4 UI/UX',
                hasAction: true,
                confirmMessage: 'UI/UX를 위와 같이 설계하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - UI/UX

## ✅ 자동 실행된 항목

- [x] 와이어프레임 작성
- [x] UI 디자인

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - UI/UX

## 기본 정보
- **Order ID**: OS-1-4-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 설계 항목

- [ ] 와이어프레임
- [ ] UI 디자인
- [ ] UX 플로우

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🎨 UI/UX 안내</h2>

<h3 style="margin-top: 24px; color: #333;">설계 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">와이어프레임</li>
<li style="margin-bottom: 8px;">UI 디자인</li>
<li style="margin-bottom: 8px;">사용자 경험 플로우</li>
</ul>
`
            },

            'plan_1_5': {
                stageId: 'plan_1_5',
                stageName: '1-5 DB Design',
                hasAction: true,
                confirmMessage: 'DB를 위와 같이 설계하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - DB Design

## ✅ 자동 실행된 항목

- [x] ERD 작성
- [x] 테이블 설계

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - DB Design

## 기본 정보
- **Order ID**: OS-1-5-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 설계 항목

- [ ] ERD 작성
- [ ] 테이블 설계
- [ ] 인덱스 설계

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🗄️ DB Design 안내</h2>

<h3 style="margin-top: 24px; color: #333;">설계 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">ERD (Entity Relationship Diagram)</li>
<li style="margin-bottom: 8px;">테이블 설계</li>
<li style="margin-bottom: 8px;">인덱스 설계</li>
</ul>
`
            },

            'plan_1_6': {
                stageId: 'plan_1_6',
                stageName: '1-6 API Design',
                hasAction: true,
                confirmMessage: 'API를 위와 같이 설계하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - API Design

## ✅ 자동 실행된 항목

- [x] API 엔드포인트 정의
- [x] API 명세서 작성

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - API Design

## 기본 정보
- **Order ID**: OS-1-6-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 설계 항목

- [ ] API 엔드포인트 정의
- [ ] 요청/응답 형식
- [ ] 인증 방식

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🔌 API Design 안내</h2>

<h3 style="margin-top: 24px; color: #333;">설계 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">API 엔드포인트</li>
<li style="margin-bottom: 8px;">요청/응답 형식</li>
<li style="margin-bottom: 8px;">인증 방식</li>
</ul>
`
            },

            // ===== S1 ~ S6 개발 단계 =====
            's1_prototype': {
                stageId: 's1_prototype',
                stageName: 'S1. 프로토타입 제작',
                hasAction: true,
                confirmMessage: '프로토타입 제작을 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 프로토타입 제작

## ✅ 자동 실행된 항목

- [x] 프로토타입 기본 구조 생성
- [x] 핵심 기능 구현

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - S1. 프로토타입 제작

## 기본 정보
- **Order ID**: OS-S1-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작업 항목

- [ ] 프로토타입 기본 구조
- [ ] 핵심 기능 구현
- [ ] UI 프로토타입

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🚀 S1. 프로토타입 제작 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작업 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">기본 구조 생성</li>
<li style="margin-bottom: 8px;">핵심 기능 구현</li>
<li style="margin-bottom: 8px;">UI 프로토타입</li>
</ul>
`
            },

            's2_dev_prep': {
                stageId: 's2_dev_prep',
                stageName: 'S2. 개발 준비',
                hasAction: true,
                confirmMessage: '개발 준비를 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 개발 준비

## ✅ 자동 실행된 항목

- [x] 개발 환경 구축
- [x] 프로젝트 초기 설정

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - S2. 개발 준비

## 기본 정보
- **Order ID**: OS-S2-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작업 항목

- [ ] 개발 환경 구축
- [ ] 프로젝트 초기 설정
- [ ] CI/CD 파이프라인 구성

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">⚙️ S2. 개발 준비 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작업 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">개발 환경 구축</li>
<li style="margin-bottom: 8px;">프로젝트 초기 설정</li>
<li style="margin-bottom: 8px;">CI/CD 파이프라인</li>
</ul>
`
            },

            's3_dev_1': {
                stageId: 's3_dev_1',
                stageName: 'S3. 개발 1차',
                hasAction: true,
                confirmMessage: '개발 1차를 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 개발 1차

## ✅ 자동 실행된 항목

- [x] 핵심 기능 개발
- [x] 기본 테스트

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - S3. 개발 1차

## 기본 정보
- **Order ID**: OS-S3-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작업 항목

- [ ] 핵심 기능 개발
- [ ] 기본 테스트
- [ ] 코드 리뷰

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">💻 S3. 개발 1차 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작업 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">핵심 기능 개발</li>
<li style="margin-bottom: 8px;">기본 테스트</li>
<li style="margin-bottom: 8px;">코드 리뷰</li>
</ul>
`
            },

            's4_dev_2': {
                stageId: 's4_dev_2',
                stageName: 'S4. 개발 2차',
                hasAction: true,
                confirmMessage: '개발 2차를 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 개발 2차

## ✅ 자동 실행된 항목

- [x] 추가 기능 개발
- [x] 통합 테스트

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - S4. 개발 2차

## 기본 정보
- **Order ID**: OS-S4-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작업 항목

- [ ] 추가 기능 개발
- [ ] 통합 테스트
- [ ] 버그 수정

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">💻 S4. 개발 2차 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작업 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">추가 기능 개발</li>
<li style="margin-bottom: 8px;">통합 테스트</li>
<li style="margin-bottom: 8px;">버그 수정</li>
</ul>
`
            },

            's5_dev_3': {
                stageId: 's5_dev_3',
                stageName: 'S5. 개발 3차',
                hasAction: true,
                confirmMessage: '개발 3차를 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 개발 3차

## ✅ 자동 실행된 항목

- [x] 최종 기능 완성
- [x] 성능 최적화

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - S5. 개발 3차

## 기본 정보
- **Order ID**: OS-S5-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작업 항목

- [ ] 최종 기능 완성
- [ ] 성능 최적화
- [ ] 보안 점검

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">💻 S5. 개발 3차 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작업 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">최종 기능 완성</li>
<li style="margin-bottom: 8px;">성능 최적화</li>
<li style="margin-bottom: 8px;">보안 점검</li>
</ul>
`
            },

            's6_operation': {
                stageId: 's6_operation',
                stageName: 'S6. 운영',
                hasAction: true,
                confirmMessage: '운영 단계를 위와 같이 진행하시겠습니까?',
                orderSheetAfterExecute: `# 추가 Order Sheet - 운영

## ✅ 자동 실행된 항목

- [x] 배포
- [x] 모니터링 설정

---

## 📝 추가 요청사항

[추가 요청사항을 작성하세요]

`,
                orderSheet: `# Order Sheet - S6. 운영

## 기본 정보
- **Order ID**: OS-S6-A-001
- **작성일**: ${new Date().toISOString().split('T')[0]}

---

## 작업 항목

- [ ] 배포
- [ ] 모니터링 설정
- [ ] 유지보수 계획

---

## 추가 지시사항

[추가 요구사항이 있으면 여기에 작성]
`,
                guideContent: `
<h2 style="color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">🚀 S6. 운영 안내</h2>

<h3 style="margin-top: 24px; color: #333;">작업 항목</h3>
<ul style="padding-left: 20px;">
<li style="margin-bottom: 8px;">배포</li>
<li style="margin-bottom: 8px;">모니터링 설정</li>
<li style="margin-bottom: 8px;">유지보수 계획</li>
</ul>
`
            }
        };

        // 진행 프로세스 단계 클릭 시 호출되는 함수
        // 안내문 팝업 + [예][아니오] 버튼 표시
        async function loadProcessStage(stageId, stageName, category) {
            const stageData = STAGE_DATA[stageId];

            if (!stageData) {
                showStatus(`❌ "${stageName}" 단계의 데이터가 없습니다`, 'error');
                return;
            }

            // 현재 단계 데이터 저장
            currentStageData = stageData;

            // 안내문 팝업 표시 (hasAction에 따라 버튼 다르게 표시)
            openGuideModalWithConfirm(stageName, stageData.guideContent, stageData.confirmMessage, stageData.hasAction);
        }

        // [예] 버튼 클릭 시 - Inbox에 저장 후 실행 + 간소화 템플릿 로드
        async function executeStageAction() {
            if (!currentStageData) return;

            // 워크스페이스에 간소화 템플릿 로드 (추가 요청용)
            document.getElementById('textEditor').value = currentStageData.orderSheetAfterExecute;

            try {
                // Inbox에 기본 Order Sheet 저장 (자동 실행)
                const filename = `OS_${currentStageData.stageId}_${Date.now()}.md`;
                const response = await fetch('http://localhost:3030/save-to-inbox', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        filename: filename,
                        content: currentStageData.orderSheet
                    })
                });

                if (response.ok) {
                    showStatus(`✅ Order Sheet가 자동으로 발행되었습니다. 추가 요청사항이 있으면 작성 후 발행하세요.`, 'success');
                } else {
                    showStatus('❌ 자동 발행 실패 - 워크스페이스에서 수동 발행하세요', 'error');
                }
            } catch (error) {
                console.error('Inbox 저장 실패:', error);
                showStatus('❌ 서버 연결 실패 - 워크스페이스에서 수동 발행하세요', 'warning');
            }

            closeGuidePopup();
        }

        // 안내문 드래그 가능 팝업 열기 (hasAction에 따라 버튼 표시)
        function openGuideModalWithConfirm(title, content, confirmMessage, hasAction = true) {
            const popup = document.getElementById('guidePopup');
            const popupTitle = document.getElementById('guidePopupTitle');
            const popupContent = document.getElementById('guidePopupContent');

            popupTitle.textContent = `📖 ${title} 안내`;

            // hasAction이 true면 [예]/[아니오] 버튼, false면 [확인] 버튼만
            let buttonSection = '';
            if (hasAction) {
                buttonSection = `
                <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #dee2e6;">
                    <p style="font-weight: 600; color: #333; margin-bottom: 12px;">${confirmMessage}</p>
                    <div style="display: flex; gap: 12px;">
                        <button onclick="executeStageAction()" style="flex: 1; padding: 10px 16px; background: var(--primary); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px;">예</button>
                        <button onclick="loadOrderSheetToWorkspace()" style="flex: 1; padding: 10px 16px; background: #6c757d; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px;">아니오</button>
                    </div>
                </div>
                `;
            } else {
                buttonSection = `
                <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #dee2e6;">
                    <div style="display: flex; justify-content: center;">
                        <button onclick="closeGuidePopup()" style="padding: 10px 32px; background: var(--primary); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px;">확인</button>
                    </div>
                </div>
                `;
            }

            popupContent.innerHTML = content + buttonSection;

            popup.style.display = 'block';

            // 드래그 기능 초기화
            initDragPopup();
        }

        // [아니오] 버튼 클릭 시 - Order Sheet를 워크스페이스에 로드
        function loadOrderSheetToWorkspace() {
            if (!currentStageData) return;

            document.getElementById('textEditor').value = currentStageData.orderSheet;
            showStatus(`✅ "${currentStageData.stageName}" Order Sheet를 워크스페이스에 로드했습니다. 수정 후 발행하세요.`, 'info');
            closeGuidePopup();
        }

        // 안내문 팝업 닫기
        function closeGuidePopup() {
            const popup = document.getElementById('guidePopup');
            popup.style.display = 'none';
        }

        // 드래그 기능
        function initDragPopup() {
            const popup = document.getElementById('guidePopup');
            const header = document.getElementById('guidePopupHeader');

            let isDragging = false;
            let offsetX, offsetY;

            header.onmousedown = function(e) {
                isDragging = true;
                offsetX = e.clientX - popup.offsetLeft;
                offsetY = e.clientY - popup.offsetTop;

                document.onmousemove = function(e) {
                    if (isDragging) {
                        popup.style.left = (e.clientX - offsetX) + 'px';
                        popup.style.top = (e.clientY - offsetY) + 'px';
                        popup.style.right = 'auto';
                    }
                };

                document.onmouseup = function() {
                    isDragging = false;
                    document.onmousemove = null;
                    document.onmouseup = null;
                };
            };
        }

        // Call this when page loads
        window.addEventListener('DOMContentLoaded', () => {
            loadOrderSheetTemplates();
            loadWelcomeMessage();
        });

        // Translation functionality
        let translationTimeout;

        function toggleTranslation() {
            const preview = document.getElementById('translationPreview');
            const toggleText = document.getElementById('toggleText');

            if (preview.style.display === 'none') {
                preview.style.display = 'block';
                toggleText.textContent = '▲';
            } else {
                preview.style.display = 'none';
                toggleText.textContent = '▼';
            }
        }

        async function translateToEnglish() {
            clearTimeout(translationTimeout);

            const content = document.getElementById('textEditor').value;
            const translationSection = document.getElementById('translationSection');
            const translatedText = document.getElementById('translatedText');

            // 한글이 있는지 확인
            const hasKorean = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(content);

            if (!content.trim() || !hasKorean) {
                translationSection.style.display = 'none';
                return;
            }

            translationSection.style.display = 'flex';

            // 즉시 번역 시작 (300ms debounce만 적용)
            translationTimeout = setTimeout(async () => {
                translatedText.textContent = '번역 중...';

                try {
                    // AI 기반 번역 + 문법 교정
                    const translated = await translateWithAI(content);
                    // 병기 마크다운 형식으로 미리보기
                    const bilingualMd = generateBilingualMarkdown(content, translated);
                    translatedText.textContent = bilingualMd;
                } catch (error) {
                    translatedText.textContent = '번역 실패. 다시 시도해주세요.';
                }
            }, 300);
        }

        // AI 기반 번역 + 문법 교정 (Perplexity API 사용)
        async function translateWithAI(text) {
            try {
                const response = await fetch('http://localhost:3030/translate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        text: text,
                        mode: 'translate_and_fix'  // 번역 + 문법 교정 모드
                    })
                });

                if (!response.ok) {
                    throw new Error('Translation failed');
                }

                const data = await response.json();
                return data.translated;

            } catch (error) {
                console.error('AI 번역 실패, 기본 번역으로 전환:', error);
                // Fallback: 간단한 번역
                return await mockTranslate(text);
            }
        }

        // Mock translation (Fallback용)
        async function mockTranslate(text) {
            // 시뮬레이션: 짧은 딜레이
            await new Promise(resolve => setTimeout(resolve, 200));

            // 간단한 키워드 매핑 (데모용)
            const translations = {
                '회원가입': 'Sign Up',
                '로그인': 'Login',
                '비밀번호': 'Password',
                '이메일': 'Email',
                '요구사항': 'Requirements',
                '산출물': 'Deliverables',
                '참고사항': 'Notes',
                '구현': 'Implementation',
                'API': 'API',
                '연동': 'Integration',
                '중복': 'Duplicate',
                '확인': 'Verification',
                '암호화': 'Encryption',
                '테스트': 'Test',
                '코드': 'Code',
                '최소': 'Minimum',
                '영문': 'English',
                '숫자': 'Number',
                '특수문자': 'Special Character',
                '포함': 'Include'
            };

            let translated = text;
            for (const [kr, en] of Object.entries(translations)) {
                translated = translated.replace(new RegExp(kr, 'g'), en);
            }

            return translated;
        }

        // 한영 병기 마크다운 생성 (Claude Code는 영어만 읽음)
        function generateBilingualMarkdown(koreanText, englishText) {
            const lines = koreanText.split('\n');
            const translatedLines = englishText.split('\n');
            let result = [];

            result.push('<!-- Claude Code: Read English only -->');
            result.push('');

            for (let i = 0; i < lines.length; i++) {
                const korLine = lines[i];
                const engLine = translatedLines[i] || '';

                // 한글이 있는 줄만 처리
                if (/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(korLine)) {
                    // 한글은 HTML 주석으로 감싸기 (Claude Code가 무시)
                    result.push(`<!-- 🇰🇷 ${korLine} -->`);
                    // 영어는 일반 텍스트로 (Claude Code가 읽음)
                    result.push(engLine);
                } else {
                    // 한글이 없으면 그대로
                    result.push(korLine);
                }
            }

            return result.join('\n');
        }

        // Download to inbox functionality (자동 저장)
        async function downloadToInbox() {
            const content = document.getElementById('textEditor').value;

            if (!content.trim()) {
                alert('작성된 내용이 없습니다!');
                return;
            }

            // 프로젝트 선택 확인
            if (!currentSelectedProject) {
                alert('먼저 프로젝트를 선택해주세요!');
                return;
            }

            const projectConfig = PROJECT_CONFIGS[currentSelectedProject];
            const targetInboxPath = projectConfig.inboxPath;

            // 저장 확인
            if (!confirm(`Order Sheet를 Inbox로 보내시겠습니까?`)) {
                return;
            }

            showStatus('📤 번역 및 저장 중...', 'info');

            // 한글이 있으면 번역 수행
            const hasKorean = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(content);
            let translatedContent = '';

            if (hasKorean) {
                try {
                    // 서버의 실제 번역 API 사용
                    const translateResponse = await fetch('http://localhost:3030/translate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            text: content,
                            targetLanguage: 'en'
                        })
                    });

                    if (translateResponse.ok) {
                        const translateResult = await translateResponse.json();
                        translatedContent = translateResult.translated;
                        console.log('✅ 번역 성공:', translatedContent);
                    } else {
                        throw new Error('Translation API failed');
                    }
                } catch (error) {
                    console.error('번역 실패:', error);
                    console.log('⚠️  영어 번역을 건너뛰고 원문 그대로 저장합니다.');
                    translatedContent = content; // Fallback: 원문 사용
                }
            }

            // Generate timestamp and Order ID
            const now = new Date();
            const timestamp = now.toISOString()
                .slice(0, 19)
                .replace(/:/g, '-')
                .replace('T', '_');

            // Order ID 생성: ORDER-{AREA}-{YYMMDD}-{SEQ}
            const dateStr = now.toISOString().slice(2, 10).replace(/-/g, ''); // YYMMDD
            const seq = String(Math.floor(Math.random() * 99) + 1).padStart(2, '0'); // 01-99
            const orderId = `ORDER-GE-${dateStr}-${seq}`; // GE = General

            // JSON Order 객체 생성
            const orderData = {
                order_id: orderId,
                order_name: "Dashboard에서 생성된 작업",
                content_korean: content,
                content_english: translatedContent || content,
                priority: "medium",
                status: "pending",
                created_at: now.toISOString(),
                project: currentSelectedProject,
                metadata: {
                    source: "dashboard-mockup",
                    has_translation: hasKorean && translatedContent !== ''
                }
            };

            // JSON 문자열로 변환 (pretty print)
            const finalContent = JSON.stringify(orderData, null, 2);
            const filename = `order_${timestamp}.json`;

            try {
                // 서버로 자동 저장 요청 (프로젝트 경로 포함)
                const response = await fetch('http://localhost:3030/save', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        content: finalContent,
                        filename: filename,
                        targetPath: targetInboxPath  // 선택된 프로젝트의 Inbox 경로
                    })
                });

                const result = await response.json();

                if (result.success) {
                    console.log('전송 완료:', result);

                    alert(`Order Sheet가 보내졌습니다.\n\nOrder ID: ${orderId}\n\n상태: 📤 전송됨`);
                } else {
                    throw new Error(result.error || '전송 실패');
                }

            } catch (error) {
                console.error('전송 실패:', error);

                // 서버가 실행 중이 아닌 경우
                showStatus('❌ 전송 실패', 'error');

                const errorMsg = `❌ Inbox 서버가 실행되지 않았습니다!

다음 명령어로 서버를 실행하세요:
1. 터미널 열기
2. cd Web_ClaudeCode_Bridge
3. node inbox_server.js

또는 수동 다운로드를 원하시면 확인을 클릭하세요.`;

                const fallback = confirm(errorMsg);
                if (fallback) {
                    manualDownload(content, filename);
                }
            }
        }

        // 수동 다운로드 (fallback)
        function manualDownload(content, filename) {
            const blob = new Blob([content], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');

            a.href = url;
            a.download = filename;

            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('✅ Order Sheet가 보내졌습니다!');
        }

        // Load from Outbox (Claude Code 작업 결과 가져오기)
        async function loadFromOutbox() {
            showStatus('📤 Outbox 확인 중...', 'info');

            try {
                // Outbox 파일 목록 가져오기
                const response = await fetch('http://localhost:3030/outbox/files');
                const result = await response.json();

                if (!result.success || result.files.length === 0) {
                    alert('📭 Outbox가 비어있습니다.\n\nClaude Code가 작업을 완료하면 결과물이 Outbox/에 저장됩니다.');
                    showStatus('📭 Outbox 비어있음', 'info');
                    return;
                }

                // 모달에 파일 목록 표시
                const filesList = document.getElementById('outboxFilesList');
                filesList.innerHTML = '';

                // JSON 파일들의 내용을 미리 읽어서 매핑
                const jsonData = {};
                for (const file of result.files) {
                    if (file.filename.endsWith('.json')) {
                        try {
                            const contentRes = await fetch(`http://localhost:3030/outbox/read/${file.filename}`);
                            const contentResult = await contentRes.json();
                            if (contentResult.success) {
                                const data = JSON.parse(contentResult.content);
                                jsonData[file.filename] = data;
                            }
                        } catch (e) {
                            // 무시
                        }
                    }
                }

                // 파일 목록을 처리하여 배열에 저장 (최신순 정렬을 위해)
                const fileItems = [];

                result.files.forEach((file) => {
                    // _ack.json 파일은 숨기기
                    if (file.filename.includes('_ack.json')) return;

                    const fileExt = file.filename.split('.').pop();

                    // JSON과 MD 파일만 표시
                    if (fileExt !== 'json' && fileExt !== 'md') return;

                    let displayName = file.filename;
                    let displayMeta = `수정: ${new Date(file.modified).toLocaleString('ko-KR')}`;
                    let displayIcon = fileExt === 'md' ? '📄' : '📋';
                    let badgeClass = fileExt === 'md' ? 'markdown' : 'json';

                    // JSON 파일의 질문 내용 표시
                    if (fileExt === 'json' && jsonData[file.filename]) {
                        const data = jsonData[file.filename];
                        const question = data.question || data.content_korean || data.content || '';
                        if (question) {
                            const questionPreview = question.length > 60 ? question.substring(0, 60) + '...' : question;
                            displayName = `📋 ${questionPreview}`;
                            displayMeta = `${data.order_id || 'N/A'} | ${new Date(file.modified).toLocaleString('ko-KR')}`;
                        }
                    }

                    // MD 파일의 제목 추출 (파일명에서)
                    if (fileExt === 'md') {
                        const title = file.filename.replace('.md', '').replace(/_/g, ' ');
                        displayName = `📄 ${title}`;
                        displayMeta = `Markdown | ${new Date(file.modified).toLocaleString('ko-KR')}`;
                    }

                    fileItems.push({
                        file,
                        displayIcon,
                        displayName,
                        displayMeta,
                        badgeClass,
                        fileExt,
                        modified: file.modified
                    });
                });

                // 최신순으로 정렬 (modified 날짜 기준 내림차순)
                fileItems.sort((a, b) => new Date(b.modified) - new Date(a.modified));

                // 정렬된 순서대로 DOM에 추가
                fileItems.forEach(item => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'outbox-file-item';
                    fileItem.onclick = () => selectOutboxFile(item.file);

                    fileItem.innerHTML = `
                        <div class="outbox-file-icon">${item.displayIcon}</div>
                        <div class="outbox-file-info">
                            <div class="outbox-file-name">${item.displayName}</div>
                            <div class="outbox-file-meta">${item.displayMeta}</div>
                        </div>
                        <div class="outbox-file-badge ${item.badgeClass}">${item.fileExt.toUpperCase()}</div>
                    `;

                    filesList.appendChild(fileItem);
                });

                // 모달 열기
                const modal = document.getElementById('outboxFilesModal');
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                showStatus('📤 Outbox 파일 목록 표시', 'info');

            } catch (error) {
                console.error('Outbox 로드 실패:', error);
                showStatus('❌ Outbox 로드 실패', 'error');
                alert(`❌ Outbox 서버에 연결할 수 없습니다.\n\n서버가 실행 중인지 확인하세요:\ncd Web_ClaudeCode_Bridge\nnode inbox_server.js`);
            }
        }

        // Outbox 모달 닫기
        function closeOutboxModal() {
            const modal = document.getElementById('outboxFilesModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // JSON 데이터로 HTML 생성
        function generateHTMLFromJSON(data) {
            const question = data.question || '질문 없음';
            const answer = data.answer || '답변 없음';
            const orderId = data.order_id || 'Unknown';
            const orderName = data.order_name || '제목 없음';
            const respondedAt = data.responded_at ? new Date(data.responded_at).toLocaleString('ko-KR') : '시간 정보 없음';

            return `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${orderName} - 답변</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 35px;
        }

        .section-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            font-weight: 600;
        }

        .question-box {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
        }

        .answer-box {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 5px solid #764ba2;
            white-space: pre-wrap;
            line-height: 1.8;
        }

        .footer {
            background: #f8f9fa;
            padding: 30px;
            text-align: center;
            color: #666;
            border-top: 1px solid #e0e0e0;
        }

        .footer .meta {
            display: inline-block;
            margin: 0 15px;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📝 ${orderName}</h1>
            <span class="badge">Order ID: ${orderId}</span>
        </div>

        <div class="content">
            <div class="section">
                <h2 class="section-title">❓ 질문</h2>
                <div class="question-box">
                    ${question}
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">💡 답변</h2>
                <div class="answer-box">${answer}</div>
            </div>
        </div>

        <div class="footer">
            <div class="meta">📅 답변 시간: ${respondedAt}</div>
            <div class="meta">✅ 처리: Claude Code</div>
        </div>
    </div>
</body>
</html>`;
        }

        // Outbox 파일 선택
        async function selectOutboxFile(file) {
            closeOutboxModal();

            const fileExt = file.filename.split('.').pop();

            try {
                showStatus(`📄 ${file.filename} 읽는 중...`, 'info');

                const contentResponse = await fetch(`http://localhost:3030/outbox/read/${file.filename}`);
                const contentResult = await contentResponse.json();

                if (!contentResult.success) {
                    throw new Error(contentResult.error || '파일 읽기 실패');
                }

                // MD 파일 처리
                if (fileExt === 'md') {
                    const mdData = JSON.parse(contentResult.content);

                    // 새 창에서 Markdown을 HTML로 렌더링
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write(`
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${mdData.title || file.filename}</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f9fafb;
        }
        .markdown-body {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 { color: #1f2937; border-bottom: 3px solid #10B981; padding-bottom: 10px; }
        h2 { color: #374151; margin-top: 30px; border-left: 4px solid #10B981; padding-left: 12px; }
        h3 { color: #4b5563; }
        pre { background: #1e1e1e; color: #d4d4d4; padding: 16px; border-radius: 8px; overflow-x: auto; }
        code { background: #f3f4f6; padding: 2px 6px; border-radius: 4px; font-family: 'Consolas', monospace; }
        pre code { background: transparent; padding: 0; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #e5e7eb; padding: 12px; text-align: left; }
        th { background: #f3f4f6; font-weight: 600; }
        blockquote { border-left: 4px solid #10B981; padding-left: 16px; color: #6b7280; margin: 20px 0; }
        a { color: #10B981; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .meta { text-align: right; color: #6b7280; font-size: 14px; margin-top: 40px; padding-top: 20px; border-top: 1px solid #e5e7eb; }
    </style>
</head>
<body>
    <div class="markdown-body">
        ${mdData.content}
        <div class="meta">📅 ${mdData.date} | 📄 Markdown Document</div>
    </div>
</body>
</html>
                    `);
                    newWindow.document.close();
                    showStatus(`✅ ${file.filename} 렌더링 완료!`, 'success');
                    return;
                }

                // JSON 파일 처리
                const data = JSON.parse(contentResult.content);
                const htmlContent = generateHTMLFromJSON(data);

                // 새 창에서 열기
                const newWindow = window.open('', '_blank');
                newWindow.document.write(htmlContent);
                newWindow.document.close();

                showStatus(`✅ ${file.filename} HTML로 렌더링 완료!`, 'success');

            } catch (error) {
                console.error('파일 읽기 실패:', error);
                showStatus('❌ 파일 읽기 실패', 'error');
                alert(`❌ 파일을 읽을 수 없습니다: ${file.filename}`);
            }
        }

        // Perplexity에 질문 보내기
        async function askPerplexity() {
            const question = document.getElementById('perplexityQuestion').value;
            const workspace = document.getElementById('textEditor');

            if (!question.trim()) {
                alert('질문을 입력하세요!');
                return;
            }

            // Workspace에 로딩 표시
            workspace.value = '🔮 Perplexity가 생각 중입니다...\n\n';

            try {
                // TODO: 실제 API 연결 시 아래 코드 활성화
                // const response = await fetch('http://localhost:3030/perplexity/ask', {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({ question })
                // });
                // const result = await response.json();

                // 임시 응답 (테스트용)
                setTimeout(() => {
                    workspace.value = `📝 질문: ${question}\n\n`;
                    workspace.value += `🔮 Perplexity의 답변:\n\n`;
                    workspace.value += `[여기에 Perplexity의 실제 답변이 표시됩니다]\n\n`;
                    workspace.value += `이 기능을 사용하려면 Perplexity API를 연결하세요.\n`;
                    workspace.value += `자세한 내용은 'PERPLEXITY_API_연결_가이드.md'를 참고하세요.\n\n`;
                    workspace.value += `---\n`;
                    workspace.value += `시간: ${new Date().toLocaleString('ko-KR')}`;

                    // 질문창 초기화
                    document.getElementById('perplexityQuestion').value = '';
                }, 1000);

            } catch (error) {
                console.error('Perplexity 요청 실패:', error);
                alert('Perplexity API 연결 실패!');
                workspace.value = '';
            }
        }

        // 파일 선택 핸들러
        let supportFiles = [];
        function handleSupportFileSelect(event) {
            const files = Array.from(event.target.files);
            supportFiles = files;

            const fileList = document.getElementById('supportFileList');
            if (files.length > 0) {
                fileList.innerHTML = files.map((file, idx) => {
                    const sizeKB = (file.size / 1024).toFixed(1);
                    return '<div style="padding: 2px 0;">📎 ' + file.name + ' (' + sizeKB + 'KB) <span onclick="removeSupportFile(' + idx + ')" style="cursor: pointer; color: #dc3545;">✕</span></div>';
                }).join('');
            } else {
                fileList.innerHTML = '';
            }
        }

        function removeSupportFile(index) {
            supportFiles.splice(index, 1);
            const dt = new DataTransfer();
            supportFiles.forEach(file => dt.items.add(file));
            document.getElementById('supportFile').files = dt.files;
            handleSupportFileSelect({ target: { files: dt.files } });
        }

        // 써니에게 문의 제출
        async function submitSupport() {
            console.log('submitSupport 함수 실행됨');
            const question = document.getElementById('supportQuestion').value;
            const workspace = document.getElementById('textEditor');

            console.log('질문 내용:', question);
            console.log('workspace 요소:', workspace);

            if (!question.trim()) {
                alert('문의 내용을 입력하세요!');
                return;
            }

            try {
                // Workspace에 접수 확인 표시
                let fileInfo = supportFiles.length > 0 ? '\n📎 첨부 파일: ' + supportFiles.map(f => f.name).join(', ') : '';
                const currentContent = workspace.value;
                const newContent = '☀️ 써니에게 문의\n\n📝 문의 내용:\n' + question + fileInfo + '\n\n✅ 문의가 접수되었습니다!\n관리자가 확인 후 답변을 드립니다.\n\n접수 시간: ' + new Date().toLocaleString('ko-KR') + '\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n' + currentContent;

                workspace.value = newContent;
                console.log('workspace에 내용 추가됨');

                // 문의창 및 파일 초기화
                document.getElementById('supportQuestion').value = '';
                document.getElementById('supportFile').value = '';
                supportFiles = [];
                document.getElementById('supportFileList').innerHTML = '';

                showStatus('✅ 문의가 접수되었습니다!', 'success');
                console.log('제출 완료');

            } catch (error) {
                console.error('문의 제출 실패:', error);
                alert('문의 제출 중 오류가 발생했습니다: ' + error.message);
            }
        }

        // 푸터에서 써니에게 묻기 클릭
        function openSunnySupport(event) {
            event.preventDefault();
            // 우측 사이드바로 스크롤
            const supportSection = document.querySelector('.sidebar-section');
            if (supportSection) {
                supportSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                // 문의 입력창 포커스
                setTimeout(() => {
                    document.getElementById('supportQuestion').focus();
                }, 500);
            }
        }

        // Supabase Realtime으로 답변 도착 감지 및 표시
        // TODO: 실제 구현 시 활성화
        /*
        const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

        // 답변 실시간 구독
        const channel = supabase
            .channel('support-answers')
            .on(
                'postgres_changes',
                {
                    event: 'UPDATE',
                    schema: 'public',
                    table: 'support_requests',
                    filter: `user_id=eq.${currentUser.id}`
                },
                (payload) => {
                    if (payload.new.answered_at) {
                        displaySupportResponse(
                            payload.new.question_text,
                            payload.new.answer_text,
                            payload.new.answered_at
                        );
                    }
                }
            )
            .subscribe();
        */

        // 관리자 답변 표시 (Realtime으로 자동 호출됨)
        function displaySupportResponse(question, answer, answeredAt) {
            const workspace = document.getElementById('textEditor');

            // AI Q&A와 동일한 형식으로 답변 표시
            workspace.value = `☀️ 써니의 답변\n\n📝 질문:\n${question}\n\n✅ 답변:\n${answer}\n\n답변 시간: ${new Date(answeredAt).toLocaleString('ko-KR')}\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n${workspace.value}`;

            // 알림 표시
            showStatus('☀️ 써니님의 답변이 도착했습니다!', 'success', 3000);
        }

        // 페이지 로드 시 서버 상태 체크
        window.addEventListener('load', async () => {
            try {
                const response = await fetch('http://localhost:3030/ping');
                const result = await response.json();
                if (result.status === 'ok') {
                    showStatus('🟢 Inbox 서버 연결됨', 'success', 2000);
                }
            } catch (error) {
                showStatus('🔴 Inbox 서버 미실행', 'error', 2000);
            }
        });

        // ESC 키로 모달 닫기
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const gridModal = document.getElementById('gridFullscreenModal');
                const translationModal = document.getElementById('translationFullviewModal');
                const addProjectModal = document.getElementById('addProjectModal');

                if (gridModal.classList.contains('active')) {
                    closeGridFullscreen();
                }
                if (translationModal.classList.contains('active')) {
                    closeTranslationFullview();
                }
                if (addProjectModal.classList.contains('active')) {
                    closeAddProjectModal();
                }
            }
        });

        // 프로젝트 그리드 전체화면 열기
        function openGridFullscreen() {
            const modal = document.getElementById('gridFullscreenModal');
            const gridContent = document.querySelector('.workspace-bottom .grid-content');
            const fullscreenContent = document.getElementById('fullscreenGridContent');

            // 그리드 콘텐츠 복사
            fullscreenContent.innerHTML = gridContent.innerHTML;

            // 모달 표시
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // 프로젝트 그리드 전체화면 닫기
        function closeGridFullscreen() {
            const modal = document.getElementById('gridFullscreenModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // 번역 전체보기 열기
        function openTranslationFullview() {
            const modal = document.getElementById('translationFullviewModal');
            const translatedText = document.getElementById('translatedText').textContent;
            const fullviewText = document.getElementById('fullviewTranslatedText');

            fullviewText.textContent = translatedText || '번역된 내용이 없습니다.';

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // 번역 전체보기 닫기
        function closeTranslationFullview() {
            const modal = document.getElementById('translationFullviewModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // 2D/3D 뷰 전환
        function switchView(viewType) {
            const buttons = document.querySelectorAll('.view-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            event.currentTarget.classList.add('active');

            // TODO: 실제 2D/3D 뷰 전환 로직 구현
            console.log('View switched to:', viewType);
        }

        // 매뉴얼 보기
        function openManual() {
            // HTML 매뉴얼 페이지 열기 (project-ssal-grid 폴더)
            window.open('../../../project-ssal-grid/manual/manual.html', '_blank');
        }

        // Viewer 열기
        function openViewer() {
            // viewer.html 페이지 열기 (project-ssal-grid 폴더)
            window.open('../../../project-ssal-grid/viewer/viewer.html', '_blank');
        }

        // 폴더 열기 함수 (Antigravity 또는 VSCode 선택)
        function openFolder(folderPath) {
            const fullPath = `C:/!SSAL_Works_Private/${folderPath}`;

            // 에디터 선택 모달 표시
            showEditorSelectModal(fullPath);
        }

        // 에디터 선택 모달 표시 함수 (드래그 가능한 팝업 스타일)
        function showEditorSelectModal(fullPath) {
            // 기존 모달이 있으면 제거
            const existingModal = document.getElementById('editorSelectModal');
            if (existingModal) {
                existingModal.remove();
            }

            // 폴더명 추출
            const folderName = fullPath.split('/').pop();

            const modalHTML = `
                <div id="editorSelectModal" style="
                    position: fixed !important;
                    top: 100px;
                    right: 50px;
                    width: 480px;
                    background: white;
                    border-radius: 12px;
                    box-shadow: 0 8px 32px rgba(0,0,0,0.25);
                    z-index: 10000;
                    overflow: hidden;
                    font-family: 'Malgun Gothic', '맑은 고딕', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
                ">
                    <!-- 헤더 (드래그 가능) -->
                    <div id="editorModalHeader" style="
                        background: linear-gradient(135deg, var(--tertiary) 0%, var(--tertiary-dark) 100%);
                        color: white;
                        padding: 12px 16px;
                        cursor: move;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        user-select: none;
                    ">
                        <span style="font-weight: 700; font-size: 14px;">📂 폴더 편집 안내</span>
                        <button onclick="closeEditorSelectModal()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; padding: 0 4px;">&times;</button>
                    </div>

                    <!-- 컨텐츠 -->
                    <div style="padding: 20px; font-size: 12px; line-height: 1.6; color: #212529;">
                        <h3 style="margin: 0 0 12px 0; color: var(--primary-dark); font-size: 14px; border-bottom: 2px solid var(--primary); padding-bottom: 8px;">
                            ${folderName} 폴더
                        </h3>

                        <p style="margin: 0 0 16px 0;">이 폴더의 내용을 편집하시겠습니까?</p>

                        <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                            <p style="margin: 0 0 8px 0; font-weight: 600; color: #333;">📍 폴더 경로</p>
                            <code style="font-size: 11px; color: #6c757d; word-break: break-all;">${fullPath}</code>
                        </div>

                        <p style="margin: 0 0 12px 0; font-weight: 600; color: #333;">아래 두 가지 중 하나를 선택하세요:</p>

                        <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 16px;">
                            <button onclick="openWithEditor('antigravity', '${fullPath}')" style="
                                padding: 12px 16px;
                                border: none;
                                border-radius: 8px;
                                background: linear-gradient(135deg, #4285F4, #34A853);
                                color: white;
                                cursor: pointer;
                                font-size: 13px;
                                font-weight: 600;
                                display: flex;
                                align-items: center;
                                gap: 10px;
                                transition: transform 0.2s, box-shadow 0.2s;
                            " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 4px 12px rgba(66,133,244,0.4)';"
                               onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 4 L10 4 C9 10, 8 16, 7 22 L2 22 C4 16, 6 10, 8 4 Z" fill="white"/>
                                    <path d="M14 4 L16 4 C18 10, 20 16, 22 22 L17 22 C16 16, 15 10, 14 4 Z" fill="white"/>
                                    <ellipse cx="12" cy="3" rx="6" ry="3" fill="white"/>
                                </svg>
                                <span>Antigravity 열기</span>
                            </button>
                            <button onclick="openWithEditor('vscode', '${fullPath}')" style="
                                padding: 12px 16px;
                                border: none;
                                border-radius: 8px;
                                background: linear-gradient(135deg, #007ACC, #0065A9);
                                color: white;
                                cursor: pointer;
                                font-size: 13px;
                                font-weight: 600;
                                display: flex;
                                align-items: center;
                                gap: 10px;
                                transition: transform 0.2s, box-shadow 0.2s;
                            " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 4px 12px rgba(0,122,204,0.4)';"
                               onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vscode/vscode-original.svg" alt="VS Code" style="width: 20px; height: 20px; filter: brightness(0) invert(1);">
                                <span>VS Code 열기</span>
                            </button>
                        </div>

                        <div style="background: #fffbeb; padding: 12px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                            <p style="margin: 0; font-size: 11px; color: #92400e;">
                                <strong>⚠️ 필수 프로그램 안내</strong><br>
                                위 프로그램이 설치되어 있어야 폴더가 열립니다.<br>
                                • <strong>Antigravity</strong>: Google Project IDX 기반 에디터<br>
                                • <strong>VS Code</strong>: Microsoft Visual Studio Code
                            </p>
                        </div>
                    </div>

                    <!-- 하단 버튼 -->
                    <div style="padding: 0 20px 20px 20px;">
                        <button onclick="closeEditorSelectModal()" style="
                            width: 100%;
                            padding: 10px;
                            border: 1px solid #dee2e6;
                            border-radius: 6px;
                            background: #f8f9fa;
                            color: #6c757d;
                            cursor: pointer;
                            font-size: 13px;
                            font-weight: 500;
                        ">취소</button>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // 드래그 기능 추가
            initEditorModalDrag();
        }

        // 에디터 모달 드래그 기능
        function initEditorModalDrag() {
            const modal = document.getElementById('editorSelectModal');
            const header = document.getElementById('editorModalHeader');

            if (!modal || !header) return;

            let isDragging = false;
            let offsetX, offsetY;

            header.onmousedown = function(e) {
                isDragging = true;
                offsetX = e.clientX - modal.offsetLeft;
                offsetY = e.clientY - modal.offsetTop;

                document.onmousemove = function(e) {
                    if (isDragging) {
                        modal.style.left = (e.clientX - offsetX) + 'px';
                        modal.style.top = (e.clientY - offsetY) + 'px';
                        modal.style.right = 'auto';
                    }
                };

                document.onmouseup = function() {
                    isDragging = false;
                    document.onmousemove = null;
                    document.onmouseup = null;
                };
            };
        }

        // 에디터 선택 모달 닫기
        function closeEditorSelectModal() {
            const modal = document.getElementById('editorSelectModal');
            if (modal) {
                modal.remove();
            }
        }

        // 선택한 에디터로 폴더 열기
        function openWithEditor(editor, fullPath) {
            closeEditorSelectModal();

            let editorUrl, editorName, downloadUrl;

            if (editor === 'antigravity') {
                editorUrl = `antigravity://file/${fullPath}`;
                editorName = 'Antigravity';
                downloadUrl = 'https://developers.google.com/antigravity';
            } else {
                editorUrl = `vscode://file/${fullPath}`;
                editorName = 'VS Code';
                downloadUrl = 'https://code.visualstudio.com/download';
            }

            // 숨겨진 iframe을 사용하여 커스텀 프로토콜 실행
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            document.body.appendChild(iframe);

            try {
                iframe.contentWindow.location.href = editorUrl;
            } catch (e) {
                // iframe 방식 실패 시 location.href 시도
                window.location.href = editorUrl;
            }

            // iframe 정리
            setTimeout(() => {
                if (iframe.parentNode) {
                    iframe.parentNode.removeChild(iframe);
                }
            }, 100);
        }

        // Claude Code 소식 펼치기/접기
        function toggleClaudeNews(element) {
            const newsList = element.nextElementSibling;
            const arrow = element.querySelector('.knowledge-arrow');

            if (newsList.style.display === 'none') {
                newsList.style.display = 'block';
                arrow.textContent = '▼';
            } else {
                newsList.style.display = 'none';
                arrow.textContent = '▶';
            }
        }

        // 프로젝트 목록 펼치기/접기
        function toggleProjectList() {
            const projectList = document.getElementById('projectList');
            const arrow = document.getElementById('projectListArrow');

            if (projectList.style.display === 'none') {
                projectList.style.display = 'flex';
                projectList.style.flexDirection = 'column';
                projectList.style.gap = '6px';
                arrow.textContent = '▲';
            } else {
                projectList.style.display = 'none';
                arrow.textContent = '▼';
            }
        }

        // 완료된 프로젝트 더보기 펼치기/접기
        function toggleCompletedProjects() {
            const completedList = document.getElementById('completedProjectsList');
            const arrow = document.getElementById('completedProjectsArrow');

            if (completedList.style.display === 'none') {
                completedList.style.display = 'flex';
                completedList.style.flexDirection = 'column';
                completedList.style.gap = '6px';
                arrow.textContent = '▲';
            } else {
                completedList.style.display = 'none';
                arrow.textContent = '▼';
            }
        }

        // 프로젝트 선택

        // 예시 프로젝트 보기
        function showExampleProject() {
            const workspace = document.getElementById('textEditor');
            
            workspace.value = `📚 SSAL Works (예시) 프로젝트

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

SSAL Works를 실제로 개발하면서 작성된 
모든 폴더와 파일을 그대로 저장해 놓았습니다.

참고용으로 자유롭게 둘러보세요!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📥 전체 파일 다운로드

Google Drive에서 프로젝트 전체를 다운로드하실 수 있습니다.

🔗 다운로드 링크: [준비 중]

※ 링크를 클릭하면 Google Drive 폴더가 열립니다.
   우측 상단 ⋮ 버튼 → "다운로드"를 클릭하면 
   ZIP 파일로 자동 압축되어 다운로드됩니다.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📂 포함 내용:

• 전체 프로젝트 디렉토리 구조
• 모든 Order Sheet
• 개발 과정 문서
• 작업 결과물
• 설정 파일

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 TIP: 이 예시를 참고하여 
    자신만의 프로젝트를 시작해보세요!
`;
        }

        function selectProject(projectName) {
            const workspace = document.getElementById('textEditor');
            const projectConfig = PROJECT_CONFIGS[projectName];

            // 선택된 프로젝트 전역 변수에 저장
            currentSelectedProject = projectName;

            // 모든 프로젝트에서 selected 클래스 제거
            document.querySelectorAll('.project-list-item').forEach(item => {
                item.classList.remove('selected');
            });

            // 클릭된 프로젝트에 selected 클래스 추가
            event.currentTarget.classList.add('selected');

            workspace.value = `📋 Project: ${projectName}\n\n`;
            workspace.value += `⚠️ 프로젝트 설정 확인\n\n`;
            workspace.value += `1. ${projectName} 프로젝트의 Inbox/ 폴더가 설치되어 있는지 확인하세요\n`;
            workspace.value += `   경로: ${projectConfig.inboxPath}\n\n`;
            workspace.value += `2. Inbox/ 폴더가 있다면 아래에 Order Sheet를 작성하세요\n\n`;
            workspace.value += `3. 작성 완료 후 "Download Order Sheet" 버튼을 클릭하면\n`;
            workspace.value += `   자동으로 해당 프로젝트의 Inbox/에 저장됩니다\n\n`;
            workspace.value += `━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n`;
            workspace.value += `여기에 Order Sheet를 작성하세요:\n\n`;

            console.log('Selected project:', projectName, 'Inbox path:', projectConfig.inboxPath);
        }

        // 프로젝트 목록에 새 프로젝트 추가
        function addProjectToList(name) {
            const projectList = document.getElementById('projectList');

            const newProject = document.createElement('div');
            newProject.className = 'project-list-item';
            newProject.onclick = function () { selectProject(name); };

            newProject.innerHTML = `
                <span class="project-name">${name}</span>
                <span class="project-status">진행중</span>
            `;

            projectList.appendChild(newProject);
        }

        // 프로젝트 추가 모달 열기
        function openAddProjectModal() {
            // 진행 중인 프로젝트가 있는지 확인
            const projectItems = document.querySelectorAll('.project-list-item');
            let hasInProgress = false;

            projectItems.forEach(item => {
                const status = item.querySelector('.project-status');
                if (status && status.textContent === '진행중') {
                    hasInProgress = true;
                }
            });

            if (hasInProgress) {
                alert('⚠️ 이미 진행 중인 프로젝트가 있습니다!\n\n현재 프로젝트를 완료한 후 새 프로젝트를 추가할 수 있습니다.');
                return;
            }

            const modal = document.getElementById('addProjectModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // 프로젝트 추가 모달 닫기
        function closeAddProjectModal() {
            const modal = document.getElementById('addProjectModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';

            // 폼 초기화
            document.getElementById('newProjectForm').reset();
        }

        // 프로젝트 완료 여부 확인 함수
        function isProjectCompleted() {
            // 모든 진행 프로세스의 완료율 확인
            const processItems = document.querySelectorAll('.process-major');
            let allCompleted = true;

            processItems.forEach(item => {
                const progress = item.getAttribute('data-progress');
                if (progress && parseInt(progress) < 100) {
                    allCompleted = false;
                }
            });

            return allCompleted;
        }

        // 새 프로젝트 추가 처리
        document.getElementById('newProjectForm')?.addEventListener('submit', async function (e) {
            e.preventDefault();

            const name = document.getElementById('projectName').value;
            const description = document.getElementById('projectDescription').value;

            if (!name) {
                alert('프로젝트명을 입력해주세요!');
                return;
            }

            // 진행 중인 프로젝트가 있는지 확인
            const projectItems = document.querySelectorAll('.project-list-item');
            let hasInProgress = false;
            projectItems.forEach(item => {
                const status = item.querySelector('.project-status');
                if (status && status.textContent === '진행중') {
                    hasInProgress = true;
                }
            });

            if (hasInProgress) {
                // 현재 프로젝트의 개발이 완료되었는지 확인
                if (!isProjectCompleted()) {
                    alert('⚠️ 현재 프로젝트의 개발이 완료되지 않았습니다!\n\n모든 진행 프로세스가 100%가 되어야 새 프로젝트를 시작할 수 있습니다.\n현재 진행 중인 프로젝트를 먼저 완료해주세요.');
                    return;
                }

                alert('⚠️ 진행 중인 프로젝트가 이미 있습니다!\n\n한 번에 하나의 프로젝트만 진행할 수 있습니다.\n현재 프로젝트를 완료한 후 새 프로젝트를 시작해주세요.\n\n💡 여러 프로젝트를 동시에 진행하시려면 새로운 계정으로 로그인하세요.');
                return;
            }

            // 프로젝트 구조 생성 중 표시
            showStatus('🚀 표준 프로젝트 구조 생성 중...', 'info');

            try {
                // 서버에 프로젝트 생성 요청
                const response = await fetch('http://localhost:3030/create-project', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        projectName: name,
                        projectPath: null  // 기본 경로 사용 (서버에서 결정)
                    })
                });

                const result = await response.json();

                if (result.success) {
                    // 프로젝트 목록에 추가
                    addProjectToList(name);

                    // 성공 안내 메시지를 에디터에 표시
                    const editor = document.getElementById('textEditor');
                    editor.value = `# ✅ 새 프로젝트 생성 완료!

## 프로젝트 정보
- **프로젝트명**: ${name}
- **생성 경로**: ${result.projectPath}
- **상태**: 진행중

---

## 🎉 생성된 표준 프로젝트 구조

표준 프로젝트 디렉토리가 자동으로 생성되었습니다!

### 📁 생성된 폴더 및 파일:

\`\`\`
${name}/
├── .claude/
│   └── CLAUDE.md               (Claude Code 프로젝트 설정)
│
├── 0_사업계획/
│   ├── 0-1_Vision_Mission/
│   ├── 0-2_Market_Analysis/
│   └── 0-3_Business_Model/
│
├── 1_기획/
│   ├── 1-1_Project_Plan/
│   ├── 1-2_UI_UX_Design/
│   └── 1-3_Database_Design/
│
├── 2_개발준비/
│   ├── 2-1_Tech_Stack/
│   ├── 2-2_Architecture/
│   ├── 2-3_Development_Setup/
│   └── 2-4_Project_Grid/
│
├── 3_개발/
│   ├── 3-1_Frontend/
│   ├── 3-2_Engines/
│   ├── 3-3_Authentication/
│   ├── 3-4_Backend_Infrastructure/
│   ├── 3-5_Backend_APIs/
│   ├── 3-6_Database/
│   ├── 3-7_External_Services/
│   ├── 3-8_Test/
│   ├── 3-9_Deployment/
│   └── 3-10_Stabilization/
│
├── 4_운영/
│   ├── 4-1_Monitoring/
│   ├── 4-2_Maintenance/
│   ├── 4-3_Backup/
│   └── 4-4_Security/
│
├── Web_ClaudeCode_Bridge/
│   ├── Inbox/                  (대시보드 → Claude Code)
│   ├── Outbox/                 (Claude Code → 대시보드)
│   ├── inbox_server.js
│   ├── package.json
│   └── .env.example
│
├── .gitignore
├── README.md
└── PROJECT_STRUCTURE.md
\`\`\`

---

## 💡 중요: 표준 구조는 자유롭게 수정 가능합니다!

위에 생성된 표준 프로젝트 구조는 **기본 템플릿**입니다.

### ✏️ 자유롭게 변경하세요:
- **폴더 추가/삭제**: 프로젝트 성격에 맞게 폴더를 추가하거나 불필요한 폴더를 삭제하세요
- **폴더 이름 변경**: 팀의 용어나 표준에 맞게 폴더명을 변경하세요
- **구조 재구성**: 프로젝트 규모와 복잡도에 따라 폴더 계층을 조정하세요
- **파일 수정**: README.md, GUIDE.md 등 모든 파일을 프로젝트에 맞게 수정하세요

**이 구조는 시작점일 뿐입니다!** 프로젝트의 특성과 팀의 워크플로우에 맞게 자유롭게 커스터마이징하세요.

---

## 🚀 다음 단계

### 1. 프로젝트 폴더로 이동
\`\`\`bash
cd "${result.projectPath}"
\`\`\`

### 2. Web_ClaudeCode_Bridge 설정
\`\`\`bash
cd Web_ClaudeCode_Bridge
npm install
\`\`\`

### 3. 환경 변수 설정
\`\`\`bash
cp .env.example .env
# .env 파일을 열어서 API 키 등을 설정하세요
\`\`\`

### 4. Inbox Server 시작
\`\`\`bash
node inbox_server.js
\`\`\`

### 5. Claude Code CLI 실행
프로젝트 루트 폴더에서:
\`\`\`bash
claude
\`\`\`

---

## 📬 Inbox/Outbox를 통한 Claude Code 대화

### Inbox (대시보드 → Claude Code)
이 대시보드에서 Order Sheet를 작성하고 "전송" 버튼을 누르면:
- \`Inbox/\` 폴더에 마크다운 파일로 저장됩니다
- Claude Code가 이 파일을 읽고 작업을 수행합니다

### Outbox (Claude Code → 대시보드)
Claude Code가 작업을 완료하면:
- 결과물을 \`Outbox/\` 폴더에 저장합니다
- 대시보드의 "📭 Outbox" 탭에서 확인할 수 있습니다

---

## 📚 참고 문서

각 폴더에는 다음 문서들이 자동 생성되어 있습니다:
- **README.md**: 해당 단계/카테고리의 목적과 개요
- **GUIDE.md**: 구체적인 작업 가이드 (소분류 폴더)
- **CLAUDE.md**: Claude Code 프로젝트 설정 (.claude/ 폴더)

---

## 🎯 지금 바로 시작하세요!

1. 왼쪽 사이드바에서 작업하려는 프로세스를 선택하세요
2. Order Sheet 템플릿이 자동으로 로드됩니다
3. 작업 내용을 작성하고 "Claude Code로 전송" 버튼을 클릭하세요
4. Claude Code가 자동으로 작업을 시작합니다!

**행운을 빕니다! 🚀**
`;

                    showStatus('✅ 프로젝트 생성 완료!', 'success');
                    closeAddProjectModal();

                } else {
                    throw new Error(result.error || '프로젝트 생성 실패');
                }

            } catch (error) {
                console.error('프로젝트 생성 오류:', error);
                showStatus(`❌ 프로젝트 생성 실패: ${error.message}`, 'error');
                alert(`프로젝트 생성 중 오류가 발생했습니다:\n\n${error.message}\n\n서버(inbox_server.js)가 실행 중인지 확인해주세요.`);
            }
        });

        // ==================== Service Introduction Modal ====================
        function openServiceIntro() {
            const modal = document.getElementById('serviceIntroModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeServiceIntro() {
            const modal = document.getElementById('serviceIntroModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // ESC 키로 닫기
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeGridFullscreen();
            }
        });

        // ==================== Multi-AI 질문 시스템 ====================

        // 현재 선택된 AI (기본값: chatgpt)
        let selectedAI = 'chatgpt';

        // AI 선택 함수
        function selectAI(aiType, event) {
            selectedAI = aiType;

            // 모든 버튼에서 active 클래스 제거
            document.querySelectorAll('.ai-selector-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // 클릭된 버튼에 active 클래스 추가
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }

        // 크레딧 충전 함수
        function rechargeCredit() {
            const currentBalance = parseInt(document.getElementById('perplexityCreditBalance').textContent.replace(/,/g, ''));
            const rechargeAmount = prompt('충전할 금액을 입력하세요 (원):', '10000');

            if (rechargeAmount === null) {
                return; // 취소
            }

            const amount = parseInt(rechargeAmount);

            if (isNaN(amount) || amount <= 0) {
                alert('올바른 금액을 입력해주세요!');
                return;
            }

            // 크레딧 충전
            const newBalance = currentBalance + amount;
            document.getElementById('perplexityCreditBalance').textContent = newBalance.toLocaleString();

            showStatus(`✅ ₩${amount.toLocaleString()} 충전 완료! 현재 잔액: ₩${newBalance.toLocaleString()}`, 'success');
        }

        // AI에게 질문하기 (통합 함수)
        async function askAI() {
            const questionInput = document.getElementById('aiQuestion');
            const question = questionInput.value.trim();
            const button = event.target;
            const loadingDiv = document.getElementById('aiLoading');
            const loadingText = document.getElementById('aiLoadingText');

            if (!question) {
                alert('질문을 입력해주세요!');
                return;
            }

            // AI 이름 매핑
            const aiNames = {
                'chatgpt': 'ChatGPT',
                'gemini': 'Gemini',
                'perplexity': 'Perplexity'
            };

            // AI 아이콘 매핑
            const aiIcons = {
                'chatgpt': '💬',
                'gemini': '🔷',
                'perplexity': '🔍'
            };

            const aiName = aiNames[selectedAI];
            const aiIcon = aiIcons[selectedAI];

            // 버튼 비활성화 및 로딩 표시
            const originalButtonText = button.textContent;
            button.disabled = true;
            button.textContent = '⏳ 질문 중...';
            button.style.opacity = '0.6';
            button.style.cursor = 'not-allowed';

            // 로딩 메시지 표시 (제거됨 - 버튼에만 표시)
            // loadingText.textContent = `${aiName}에게 질문 중...`;
            // loadingDiv.style.display = "block";

            // showStatus(`${aiIcon} ${aiName}에게 질문 중...`, "info");

            try {
                const response = await fetch(`http://localhost:3031/ask-${selectedAI}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question })
                });

                const result = await response.json();

                if (result.success) {
                    // Workspace에 질문과 답변 표시
                    const workspace = document.getElementById('textEditor');
                    workspace.value = `${aiIcon} ${aiName}에게 질문:
${result.question}

✅ ${aiName}의 답변:
${result.answer}`;

                    // 질문 이력 저장 (localStorage)
                    saveQuestionHistory(aiName, aiIcon, result.question, result.answer);

                    // showStatus(`✅ ${aiName} 응답 완료!`, "success");
                    questionInput.value = '';
                } else {
                    alert(`❌ 오류: ${result.error}`);
                    // showStatus(`❌ ${aiName} 질문 실패`, "error");
                }
            } catch (error) {
                alert(`❌ ${aiName} 서버에 연결할 수 없습니다.\n\n${aiName} API 키를 설정했는지 확인하세요.`);
                // showStatus(`❌ ${aiName} 서버 연결 실패`, "error");
            } finally {
                // 로딩 메시지 숨기기 (제거됨)
                // loadingDiv.style.display = "none";

                // 버튼 복원
                button.disabled = false;
                button.textContent = originalButtonText;
                button.style.opacity = '1';
                button.style.cursor = 'pointer';
            }
        }

        // ==================== 질문 이력 기능 (localStorage) ====================

        // 질문 이력 저장
        function saveQuestionHistory(aiName, aiIcon, question, answer) {
            // 기존 이력 불러오기
            const history = getQuestionHistory();

            // 새 항목 추가 (최신 항목이 맨 위)
            const newItem = {
                date: new Date().toISOString(),
                ai: aiName,
                icon: aiIcon,
                question: question,
                answer: answer
            };

            history.unshift(newItem); // 맨 앞에 추가

            // 최대 50개까지만 저장
            if (history.length > 50) {
                history.pop();
            }

            // localStorage에 저장
            localStorage.setItem('ai_question_history', JSON.stringify(history));

            // 질문 이력 UI 업데이트
            if (document.getElementById('questionHistoryList').style.display !== 'none') {
                renderQuestionHistory();
            }
        }

        // 질문 이력 불러오기
        function getQuestionHistory() {
            const data = localStorage.getItem('ai_question_history');
            return data ? JSON.parse(data) : [];
        }

        // 질문 이력 모달 열기
        function openQuestionHistoryModal() {
            const history = getQuestionHistory();
            const modalList = document.getElementById('questionHistoryModalList');

            if (history.length === 0) {
                modalList.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #6c757d;">
                        <div style="font-size: 48px; margin-bottom: 16px;">📋</div>
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">질문 / 답변 이력이 없습니다</div>
                        <div style="font-size: 14px;">AI에게 질문을 하면 질문과 답변이 이곳에 저장됩니다.</div>
                    </div>
                `;
            } else {
                modalList.innerHTML = history.map((item, index) => {
                    const date = new Date(item.date);
                    const dateStr = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;

                    return `
                        <div class="outbox-file-item" style="display: block; cursor: default;">
                            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
                                <div class="outbox-file-icon" style="font-size: 32px;">${item.icon}</div>
                                <div class="outbox-file-info" style="flex: 1;">
                                    <div class="outbox-file-name" style="font-size: 16px; font-weight: 700; color: var(--primary);">${item.ai}에게 질문한 이력</div>
                                    <div class="outbox-file-meta" style="font-size: 12px; color: #6c757d;">${dateStr}</div>
                                </div>
                                <button onclick="deleteHistoryItem(${index})"
                                    style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                                    삭제
                                </button>
                            </div>
                            <div style="margin-bottom: 12px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--primary);">
                                <div style="font-size: 13px; font-weight: 600; color: #495057; margin-bottom: 8px;">${item.ai}에게 질문:</div>
                                <div style="font-size: 14px; color: #212529; white-space: pre-wrap; line-height: 1.6;">${item.question}</div>
                            </div>
                            <div style="padding: 16px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196F3;">
                                <div style="font-size: 13px; font-weight: 600; color: #1565C0; margin-bottom: 8px;">${item.ai}의 답변:</div>
                                <div style="font-size: 14px; color: #212529; white-space: pre-wrap; line-height: 1.6;">${item.answer}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // 모달 열기
            const modal = document.getElementById('questionHistoryModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // 질문 이력 모달 닫기
        function closeQuestionHistoryModal() {
            const modal = document.getElementById('questionHistoryModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // 질문 이력 삭제
        function deleteHistoryItem(index) {
            if (!confirm('이 질문 이력을 삭제하시겠습니까?')) return;

            const history = getQuestionHistory();
            history.splice(index, 1);
            localStorage.setItem('ai_question_history', JSON.stringify(history));

            // 모달이 열려있으면 다시 렌더링
            const modal = document.getElementById('questionHistoryModal');
            if (modal.classList.contains('active')) {
                openQuestionHistoryModal();
            }
        }

        // ==================== Outbox 알림 시스템 ====================

        // Outbox 알림 박스 표시
        function showOutboxNotification(fileCount, files) {
            const notification = document.getElementById('outboxNotification');
            const message = document.getElementById('outboxNotificationMessage');

            const filenames = files.map(f => f.filename).join(', ');
            message.textContent = `새 파일 ${fileCount}개: ${filenames}`;

            notification.style.display = 'block';

            // 10초 후 자동 숨김
            setTimeout(() => {
                closeOutboxNotification();
            }, 10000);
        }

        // Outbox 알림 박스 닫기
        function closeOutboxNotification() {
            const notification = document.getElementById('outboxNotification');
            notification.style.display = 'none';
        }

        // 알림 박스에서 "열기" 버튼 클릭
        function loadFromOutboxNotification() {
            closeOutboxNotification();
            loadFromOutbox();
        }

        // Outbox 파일 개수 추적
        let lastOutboxCount = 0;
        let outboxCheckerInterval = null;

        // Outbox 감시 시작
        async function startOutboxWatcher() {
            try {
                // 초기 파일 개수 로드
                const response = await fetch('http://localhost:3030/outbox/files');
                const result = await response.json();
                if (result.success) {
                    lastOutboxCount = result.count;
                    console.log(`📤 Outbox Watcher 시작 - 현재 파일 ${lastOutboxCount}개`);
                }
            } catch (error) {
                console.log('⚠️ Outbox 서버 연결 실패 - 서버가 실행 중인지 확인하세요');
            }

            // 5초마다 Outbox 체크
            outboxCheckerInterval = setInterval(async () => {
                try {
                    const response = await fetch('http://localhost:3030/outbox/files');
                    const result = await response.json();

                    if (result.success && result.count > lastOutboxCount) {
                        const newFilesCount = result.count - lastOutboxCount;
                        const allNewFiles = result.files.slice(0, newFilesCount);

                        // _ack.json 파일은 알림에서 제외
                        const newFiles = allNewFiles.filter(file => !file.filename.includes('_ack.json'));

                        // 실제 알림할 파일이 있을 때만 콘솔 로그 표시
                        if (newFiles.length > 0) {
                            // 콘솔 로그만 표시 (알림 박스 제거)
                            console.log(`\n✨ Claude Code 작업 완료! 새 파일 ${newFiles.length}개 감지됨!`);
                            newFiles.forEach(file => {
                                console.log(`   📄 ${file.filename}`);
                            });
                            console.log(`\n👉 "Load from Outbox" 버튼을 클릭하세요!\n`);
                        }

                        lastOutboxCount = result.count;
                    }
                } catch (error) {
                    // 조용히 무시 (서버가 꺼져있을 수 있음)
                }
            }, 5000); // 5초마다 체크
        }

        // Outbox 감시 중지
        function stopOutboxWatcher() {
            if (outboxCheckerInterval) {
                clearInterval(outboxCheckerInterval);
                outboxCheckerInterval = null;
                console.log('📤 Outbox Watcher 중지됨');
            }
        }

        // 페이지 로드 시 자동 시작
        window.addEventListener('load', () => {
            startOutboxWatcher();
        });

        // 페이지 종료 시 감시 중지
        window.addEventListener('beforeunload', () => {
            stopOutboxWatcher();
        });

        // ============================================
        // Order 상태 추적 시스템
        // ============================================

        let orderStatusIntervals = {}; // Order ID별 polling interval 저장

        // Order 상태 추적 시작
        function startOrderStatusTracking(orderId) {
            console.log(`🔍 Order 상태 추적 시작: ${orderId}`);

            // 이미 추적 중이면 중지
            if (orderStatusIntervals[orderId]) {
                clearInterval(orderStatusIntervals[orderId]);
            }

            // 즉시 한 번 확인
            checkOrderStatus(orderId);

            // 3초마다 상태 확인
            orderStatusIntervals[orderId] = setInterval(() => {
                checkOrderStatus(orderId);
            }, 3000);
        }

        // Order 상태 확인
        async function checkOrderStatus(orderId) {
            try {
                const response = await fetch(`http://localhost:3030/order-status/${orderId}`);

                if (!response.ok) {
                    throw new Error(`Status check failed: ${response.status}`);
                }

                const result = await response.json();

                if (result.success) {
                    console.log(`📊 Order ${orderId} 상태:`, result.status);

                    // 상태에 따라 UI 업데이트
                    updateOrderStatus(orderId, result.status, result.message);

                    // 완료되면 polling 중지
                    if (result.status === '✅ 완료') {
                        stopOrderStatusTracking(orderId);

                        // 완료 알림
                        showStatus(`✅ Order ${orderId} 완료!`, 'success');

                        // 사용자에게 알림 (선택적)
                        if (Notification.permission === 'granted') {
                            new Notification('Order 완료!', {
                                body: `Order ${orderId}이(가) 완료되었습니다.`,
                                icon: '📬'
                            });
                        }
                    }
                }

            } catch (error) {
                console.error(`❌ Order ${orderId} 상태 확인 실패:`, error);
            }
        }

        // Order 상태 추적 중지
        function stopOrderStatusTracking(orderId) {
            if (orderStatusIntervals[orderId]) {
                clearInterval(orderStatusIntervals[orderId]);
                delete orderStatusIntervals[orderId];
                console.log(`⏹️  Order ${orderId} 상태 추적 중지`);
            }
        }

        // Order 상태 UI 업데이트
        function updateOrderStatus(orderId, status, message) {
            // Status 바에 표시 (#serverStatus 활용)
            const statusElement = document.querySelector('#serverStatus');
            if (statusElement) {
                statusElement.textContent = `📬 ${status} ${orderId}: ${message}`;
                statusElement.style.display = 'block';

                // 상태에 따라 색상 변경
                if (status === '✅ 완료') {
                    statusElement.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                } else if (status === '⏳ 처리 중') {
                    statusElement.style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
                } else {
                    statusElement.style.background = 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)';
                }
            }

            // Console에 로그
            console.log(`📬 ${orderId}: ${status} - ${message}`);
        }

        // 페이지 로드 시 알림 권한 요청 (선택적)
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

    </script>

    <!-- Project SAL Grid Fullscreen Modal -->
    <div id="gridFullscreenModal" class="grid-fullscreen-modal">
        <div class="grid-fullscreen-header">
            <div class="grid-fullscreen-title">📋 Project SAL Grid - Full View</div>
            <div class="view-toggle">
                <button class="view-btn active" onclick="switchView('2d')">2D Card</button>
                <button class="view-btn" onclick="switchView('3d')">3D Block</button>
            </div>
            <button class="grid-fullscreen-close" onclick="closeGridFullscreen()">✕ 닫기</button>
        </div>
        <div class="grid-fullscreen-content" id="fullscreenGridContent">
            <!-- 그리드 콘텐츠가 여기에 복사됩니다 -->
        </div>
    </div>

    <!-- Translation Fullview Modal -->
    <div id="translationFullviewModal" class="grid-fullscreen-modal">
        <div class="grid-fullscreen-header">
            <div class="grid-fullscreen-title">🌐 English Translation - Full View</div>
            <button class="grid-fullscreen-close" onclick="closeTranslationFullview()">✕ 닫기</button>
        </div>
        <div class="grid-fullscreen-content" style="padding: 40px;">
            <pre id="fullviewTranslatedText"
                style="font-family: 'Consolas', 'Monaco', monospace; font-size: 14px; line-height: 1.8; color: #495057; white-space: pre-wrap; word-wrap: break-word;"></pre>
        </div>
    </div>

    <!-- Service Introduction Modal -->
    <div id="serviceIntroModal" class="grid-fullscreen-modal">
        <div class="grid-fullscreen-header">
            <div class="grid-fullscreen-title">🌾 SSAL Works 서비스 소개</div>
            <button class="grid-fullscreen-close" onclick="closeServiceIntro()">✕ 닫기</button>
        </div>
        <div class="grid-fullscreen-content" style="padding: 40px; max-width: 800px; margin: 0 auto;">
            <div style="line-height: 1.8; color: #333;">
                <h1 style="font-size: 28px; margin-bottom: 16px; color: var(--primary-dark);">🌾 SSAL Works Platform:
                    AI 기반 웹사이트 개발 프로젝트 실행 및 관리 플랫폼</h1>

                <blockquote
                    style="border-left: 4px solid var(--primary); padding-left: 16px; margin: 20px 0; color: #555; font-style: italic;">
                    "기술은 몰라도, 내 사이트는 내가 만든다."<br>
                    AI를 트랙터처럼 운전하며, 나만의 디지털 밭을 일구는 곳.
                </blockquote>

                <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">

                <h2 style="font-size: 20px; margin-bottom: 12px; color: #333;">1. SSAL Works(쌀웍스)란?</h2>
                <p style="margin-bottom: 16px;">
                    <strong>SSAL Works</strong>는 비개발자가 AI(Claude Code)를 활용하여 웹사이트를 직접 개발할 수 있도록 돕는
                    <strong>"AI 기반 웹사이트 개발 프로젝트 실행 및 관리 플랫폼"</strong>입니다.
                </p>

                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <h3 style="font-size: 16px; margin-bottom: 10px; color: var(--primary);">🌾 이름의 유래 (Etymology)</h3>
                    <p style="margin-bottom: 10px; font-weight: 600;">SSAL은 단순한 곡식이 아닙니다. 창립자 Sunny와 3차원 좌표계의 결합입니다.</p>
                    <ul style="padding-left: 20px; margin: 0;">
                        <li style="margin-bottom: 8px;"><strong>S</strong> (Sunny): 창립자이자 모든 사용자를 대변하는 페르소나</li>
                        <li style="margin-bottom: 8px;"><strong>SAL</strong> (Spatial Coordinates): 프로젝트를 관리하는 3차원 좌표
                            <ul style="margin-top: 4px; color: #666; font-size: 13px;">
                                <li><strong>S</strong> (Stage): X축 (단계)</li>
                                <li><strong>A</strong> (Area): Y축 (영역)</li>
                                <li><strong>L</strong> (Level): Z축 (작업 레벨)</li>
                            </ul>
                        </li>
                        <li><strong>Rice (쌀)</strong>: 한국인에게 밥심이 필요하듯, <strong>"디지털 창작의 주식(主食)"</strong>이 되겠다는 의지를
                            담았습니다. 로고의 쌀알 3개는 이 3차원 좌표(S, A, L)를 상징합니다.</li>
                    </ul>
                </div>

                <div style="background: #e3f5f8; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <h3 style="font-size: 16px; margin-bottom: 10px; color: #20808D;">🚀 확장성 (Scalability)</h3>
                    <p style="margin-bottom: 0;">
                        SSAL Works는 <strong>"작업(Works)을 하는 공간"</strong>입니다. 현재는 웹사이트 개발(<strong>v1.0</strong>)에 집중하고 있지만,
                        이 PROJECT SAL Grid 시스템은 모든 프로젝트에 적용 가능합니다.
                        <br>
                        (예: 회계 감사, 책 집필, 다양한 프로젝트 관리 등)
                    </p>
                </div>

                <h2 style="font-size: 20px; margin-bottom: 12px; color: #333;">2. 핵심 철학: "머슬 메모리(Muscle Memory)의 외주화"
                </h2>
                <ul style="padding-left: 20px; margin-bottom: 30px;">
                    <li style="margin-bottom: 8px;"><strong>기존의 문제</strong>: 개발을 하려면 수많은 단축키, 문법, 툴 사용법을 손가락이 기억할 때까지
                        익혀야 했습니다. (높은 진입장벽)</li>
                    <li><strong>SSAL Works의 해답</strong>:
                        <ul style="margin-top: 4px; color: #555;">
                            <li>기술적인 <strong>"근육 기억(Muscle Memory)"</strong>은 AI(Claude Code)에게 전적으로 맡깁니다.</li>
                            <li>사용자는 <strong>"무엇을 만들 것인가(What to Build)"</strong>라는 본질적인 <strong>기획과 지시</strong>에만
                                집중합니다.</li>
                        </ul>
                    </li>
                </ul>

                <h2 style="font-size: 20px; margin-bottom: 12px; color: #333;">3. SSAL Works의 4대 핵심 기능</h2>
                <p style="margin-bottom: 16px;"><strong>실행이 가장 핵심입니다.</strong> 화면은 4분할되어 각 기능을 담당합니다.</p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <div style="border: 2px solid var(--primary); padding: 16px; border-radius: 8px; background: #f0fdf4;">
                        <h3 style="font-size: 16px; margin-bottom: 8px; color: var(--primary-dark);">1. 실행 (Execution) 🛠️</h3>
                        <p style="font-size: 13px; color: #666; margin-bottom: 8px;"><strong>② 중앙 Workspace "작업대"</strong></p>
                        <p style="font-size: 13px; color: #666;">
                            <strong>SSAL Works의 가장 핵심 기능입니다.</strong><br>
                            Order Sheet로 Claude Code에게 작업 지시 → AI가 실제 코드 작성/수정.<br>
                            Inbox/Outbox로 소통.
                        </p>
                    </div>
                    <div style="border: 1px solid #eee; padding: 16px; border-radius: 8px;">
                        <h3 style="font-size: 16px; margin-bottom: 8px; color: #333;">2. 관리 (Management) 🗺️🏗️</h3>
                        <p style="font-size: 13px; color: #666; margin-bottom: 8px;"><strong>① 좌측 사이드바 + ③ 하단 Grid</strong></p>
                        <p style="font-size: 13px; color: #666;">
                            프로젝트 네비게이션 + PROJECT SAL Grid.<br>
                            Stage(X)-Area(Y)-Level(Z)의 3차원 블록으로 Task 관리.
                        </p>
                    </div>
                    <div style="border: 1px solid #eee; padding: 16px; border-radius: 8px;">
                        <h3 style="font-size: 16px; margin-bottom: 8px; color: #333;">3. 학습 (Learning) 🎓</h3>
                        <p style="font-size: 13px; color: #666; margin-bottom: 8px;"><strong>④ 우측 사이드바 상단</strong></p>
                        <p style="font-size: 13px; color: #666;">
                            Books + FAQ + AI Q&A (ChatGPT, Gemini, Perplexity).<br>
                            프로젝트를 진행하면서 학습.
                        </p>
                    </div>
                    <div style="border: 1px solid #eee; padding: 16px; border-radius: 8px;">
                        <h3 style="font-size: 16px; margin-bottom: 8px; color: #333;">4. 멘토링 (Mentoring) 👨‍🏫</h3>
                        <p style="font-size: 13px; color: #666; margin-bottom: 8px;"><strong>④ 우측 사이드바 하단</strong></p>
                        <p style="font-size: 13px; color: #666;">
                            써니에게 묻기 - CPA + 엑셀러레이터의 비즈니스 자문.<br>
                            Human 멘토가 실시간으로 문제 해결.
                        </p>
                    </div>
                </div>

                <h2 style="font-size: 20px; margin-bottom: 12px; color: #333;">4. 왜 SSAL Works인가?</h2>
                <ul style="padding-left: 20px; margin-bottom: 30px;">
                    <li style="margin-bottom: 10px;"><strong>✅ DB 없는 가벼움</strong>: "내 컴퓨터가 곧 서버다." 복잡한 DB 설치 없이 폴더와
                        파일만으로 작동합니다.</li>
                    <li style="margin-bottom: 10px;"><strong>✅ 실패 없는 가이드</strong>: 막막한 흰 화면은 없습니다. 단계별 템플릿이 전문가 수준의 결과물로
                        인도합니다.</li>
                    <li><strong>✅ 강력한 동기부여</strong>: "당신의 성공이 우리의 목표입니다." 성공 시 50% 환불 정책으로 완주를 응원합니다.</li>
                </ul>

                <div
                    style="text-align: center; margin-top: 40px; padding: 20px; background: #f1f3f5; border-radius: 8px;">
                    <p style="font-weight: 600; color: var(--primary-dark); margin: 0;">SSAL Works Platform<br><span
                            style="font-weight: 400; font-size: 14px; color: #666;">"기술은 몰라도, 내 사이트는 내가 만든다"<br>
                            <strong>AI 기반 웹사이트 개발 프로젝트 실행 및 관리 플랫폼</strong>입니다.</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- 안내문 드래그 가능 팝업 -->
    <div id="guidePopup" style="display: none; position: fixed; top: 80px; right: 50px; width: 520px; max-height: calc(100vh - 150px); background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.25); z-index: 1000; overflow: hidden; font-family: 'Malgun Gothic', '맑은 고딕', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;">
        <div id="guidePopupHeader" style="background: linear-gradient(135deg, var(--tertiary) 0%, var(--tertiary-dark) 100%); color: white; padding: 12px 16px; cursor: move; display: flex; justify-content: space-between; align-items: center; user-select: none;">
            <span id="guidePopupTitle" style="font-weight: 700; font-size: 14px;">📖 안내문</span>
            <button onclick="closeGuidePopup()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; padding: 0 4px;">&times;</button>
        </div>
        <div id="guidePopupContent" style="padding: 20px; max-height: calc(100vh - 210px); overflow-y: auto; font-size: 12px; font-weight: 400; line-height: 1.6; color: #212529;">
            <!-- 안내문 내용이 여기에 로드됩니다 -->
        </div>
    </div>

    <!-- Add New Project Modal -->
    <div id="addProjectModal" class="grid-fullscreen-modal">
        <div class="grid-fullscreen-header">
            <div class="grid-fullscreen-title"><span style="color: #10B981; font-weight: 600;">➕</span> 새로운 Project 등록
            </div>
            <button class="grid-fullscreen-close" onclick="closeAddProjectModal()">✕ 닫기</button>
        </div>
        <div class="grid-fullscreen-content" style="padding: 40px; max-width: 600px; margin: 0 auto;">
            <form id="newProjectForm" style="display: flex; flex-direction: column; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #495057;">프로젝트명</label>
                    <input type="text" id="projectName" placeholder="예: My Awesome Project"
                        style="width: 100%; padding: 12px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #495057;">설명</label>
                    <textarea id="projectDescription" placeholder="프로젝트에 대한 간단한 설명을 입력하세요..."
                        style="width: 100%; padding: 12px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px; min-height: 100px; font-family: inherit;"></textarea>
                </div>
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button type="button" onclick="closeAddProjectModal()"
                        style="padding: 12px 24px; background: #495057; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; color: white;">취소</button>
                    <button type="submit"
                        style="padding: 12px 24px; background: var(--success); border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; color: white;">등록하기</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Outbox Files Modal -->
    <div id="outboxFilesModal" class="grid-fullscreen-modal">
        <div class="grid-fullscreen-header">
            <div class="grid-fullscreen-title">📤 Outbox - 파일 선택</div>
            <button class="grid-fullscreen-close" onclick="closeOutboxModal()">✕ 닫기</button>
        </div>
        <div class="grid-fullscreen-content" style="padding: 40px;">
            <div id="outboxFilesList" style="display: grid; gap: 12px;"></div>
        </div>
    </div>

    <!-- Question History Modal -->
    <div id="questionHistoryModal" class="grid-fullscreen-modal">
        <div class="grid-fullscreen-header">
            <div class="grid-fullscreen-title">📋 질문 / 답변 이력</div>
            <button class="grid-fullscreen-close" onclick="closeQuestionHistoryModal()">✕ 닫기</button>
        </div>
        <div class="grid-fullscreen-content" style="padding: 40px;">
            <div id="questionHistoryModalList" style="display: grid; gap: 12px;"></div>
        </div>
    </div>

    <style>
        .outbox-file-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .outbox-file-item:hover {
            border-color: var(--primary);
            background: #f8f9ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(107, 92, 204, 0.15);
        }

        .outbox-file-icon {
            font-size: 40px;
            flex-shrink: 0;
        }

        .outbox-file-info {
            flex: 1;
        }

        .outbox-file-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .outbox-file-meta {
            font-size: 13px;
            color: #666;
        }

        .outbox-file-badge {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .outbox-file-badge.html {
            background: #20808D;
        }

        .outbox-file-badge.json {
            background: #CC785C;
        }

        .outbox-file-badge.markdown {
            background: #10B981;
        }
    </style>


    <!-- Custom Confirm Dialog -->
    <div id="customConfirmDialog" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 9999; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 12px; padding: 32px; max-width: 400px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);">
            <h3 id="confirmDialogTitle" style="margin: 0 0 16px 0; font-size: 18px; font-weight: 600; color: #212529;">확인</h3>
            <p id="confirmDialogMessage" style="margin: 0 0 24px 0; font-size: 14px; color: #495057; line-height: 1.6;"></p>
            <div style="display: flex; gap: 12px; justify-content: flex-end;">
                <button id="confirmDialogCancel" 
                    style="padding: 12px 24px; background: #6c757d; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; color: white; transition: background 0.2s;"
                    onmouseover="this.style.background='#5a6268'" 
                    onmouseout="this.style.background='#6c757d'">취소</button>
                <button id="confirmDialogConfirm" 
                    style="padding: 12px 24px; background: var(--tertiary); border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; color: white; transition: background 0.2s;"
                    onmouseover="this.style.background='var(--tertiary-dark)'" 
                    onmouseout="this.style.background='var(--tertiary)'">확인</button>
            </div>
        </div>
    </div>

    <script>
        // Custom confirm dialog function
        function customConfirm(message, title = '확인') {
            return new Promise((resolve) => {
                const dialog = document.getElementById('customConfirmDialog');
                const titleEl = document.getElementById('confirmDialogTitle');
                const messageEl = document.getElementById('confirmDialogMessage');
                const confirmBtn = document.getElementById('confirmDialogConfirm');
                const cancelBtn = document.getElementById('confirmDialogCancel');

                titleEl.textContent = title;
                messageEl.textContent = message;
                dialog.style.display = 'flex';

                const handleConfirm = () => {
                    dialog.style.display = 'none';
                    cleanup();
                    resolve(true);
                };

                const handleCancel = () => {
                    dialog.style.display = 'none';
                    cleanup();
                    resolve(false);
                };

                const cleanup = () => {
                    confirmBtn.removeEventListener('click', handleConfirm);
                    cancelBtn.removeEventListener('click', handleCancel);
                };

                confirmBtn.addEventListener('click', handleConfirm);
                cancelBtn.addEventListener('click', handleCancel);
            });
        }

        // ================================================================
        // 사이드바 진행률 자동 업데이트 (Sidebar-Process-Tools 연동)
        // ================================================================
        const PROGRESS_SERVER = 'http://localhost:3032';

        async function calculateFolderProgress() {
            try {
                const response = await fetch(`${PROGRESS_SERVER}/check-folder-progress`);
                if (!response.ok) throw new Error('서버 연결 실패');
                const data = await response.json();

                if (data.business) updatePrepProgress('사업계획', data.business.progress);
                if (data.planning) updatePrepProgress('프로젝트 기획', data.planning.progress);

                console.log('📊 폴더 진행률:', `사업계획 ${data.business.progress}%, 프로젝트기획 ${data.planning.progress}%`);
            } catch (error) {
                console.warn('⚠️ 진행률 서버 미연결:', error.message);
            }
        }

        function updatePrepProgress(stageName, progress) {
            document.querySelectorAll('.process-prep').forEach(el => {
                const nameEl = el.querySelector('.process-prep-name');
                if (nameEl && nameEl.textContent.includes(stageName)) {
                    el.setAttribute('data-progress', progress);
                    const fillEl = el.querySelector('.process-progress-fill');
                    if (fillEl) fillEl.style.width = `${progress}%`;
                    const percentEl = el.querySelector('.process-percent');
                    if (percentEl) percentEl.textContent = `${progress}%`;
                    if (progress === 100) el.classList.add('completed');
                }
            });
        }

        async function calculateStageProgress() {
            try {
                const response = await fetch(`${PROGRESS_SERVER}/check-stage-progress`);
                if (!response.ok) return;
                const data = await response.json();
                Object.entries(data).forEach(([key, val]) => updateMajorProgressFromServer(key, val.progress));
            } catch (e) { /* 무시 */ }
        }

        function updateMajorProgressFromServer(stageKey, progress) {
            const map = { 's1': 'S1.', 's2': 'S2.', 's3': 'S3.', 's4': 'S4.', 's5': 'S5.', 's6': 'S6.' };
            const icon = map[stageKey];
            if (!icon) return;
            document.querySelectorAll('.process-major').forEach(el => {
                const iconEl = el.querySelector('.process-icon');
                if (iconEl && iconEl.textContent === icon) {
                    el.setAttribute('data-progress', progress);
                    const fillEl = el.querySelector('.process-progress-fill');
                    if (fillEl) fillEl.style.width = `${progress}%`;
                    const percentEl = el.querySelector('.process-percent');
                    if (percentEl) percentEl.textContent = `${progress}%`;
                    if (progress === 100) el.classList.add('completed');
                }
            });
        }

        // 페이지 로드 시 진행률 자동 업데이트 (일시 비활성화 - 서버 미구축)
        // window.addEventListener('load', () => {
        //     setTimeout(() => {
        //         calculateFolderProgress();
        //         calculateStageProgress();
        //     }, 1500);
        // });

        // // 30초마다 자동 갱신 (일시 비활성화 - 서버 미구축)
        // setInterval(() => {
        //     calculateFolderProgress();
        //     calculateStageProgress();
        // }, 30000);
    </script>

    <!-- Socket.io for real-time Order Sheet notifications -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
        // Socket.io 연결
        const notificationSocket = io('http://localhost:3030', {
            reconnection: true,
            reconnectionDelay: 1000,
            reconnectionAttempts: 10
        });

        notificationSocket.on('connect', () => {
            console.log('✅ Notification server connected');
        });

        notificationSocket.on('disconnect', () => {
            console.log('❌ Notification server disconnected');
        });

        // 새 Order 알림 수신
        notificationSocket.on('new-order-alert', (data) => {
            console.log('📩 New order notification:', data);
            showOrderNotification(data);
        });

        // 팝업 알림 표시 (중앙 모달 스타일)
        function showOrderNotification(data) {
            // 중앙 모달 팝업 생성
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed !important;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 420px;
                background: white;
                border-radius: 16px;
                box-shadow: 0 10px 40px rgba(0,0,0,0.2);
                z-index: 10001;
                overflow: hidden;
                font-family: 'Malgun Gothic', '맑은 고딕', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
                animation: modalZoomIn 0.3s ease-out;
            `;

            popup.innerHTML = `
                <div style="padding: 32px 24px 24px 24px; text-align: center;">
                    <div style="margin-bottom: 20px; font-size: 14px; font-weight: 400; line-height: 1.7; color: #333;">
                        <strong style="display: block; margin-bottom: 16px; font-size: 15px; color: #111;">이 페이지 내용:</strong>
                        <div style="text-align: left; background: #f8f9fa; padding: 14px; border-radius: 8px; margin-bottom: 12px;">
                            Order Sheet가 Inbox에 저장되었습니다.
                        </div>
                        <div style="text-align: left; background: #fff3cd; padding: 14px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #ffc107;">
                            <div style="margin-bottom: 8px;">원하는 Claude Code 세션에 가서</div>
                            <div style="font-weight: 600; color: #856404;">"Inbox에 저장된 Order Sheet를 확인해줘"</div>
                            <div style="margin-top: 8px;">라고 말씀해주세요.</div>
                        </div>
                        <div style="text-align: left; background: #f8f9fa; padding: 14px; border-radius: 8px;">
                            <strong>Order ID:</strong> <span style="color: #007bff; font-family: monospace;">${data.orderId}</span>
                        </div>
                    </div>
                    <button class="order-confirm-btn"
                        style="width: 100%; padding: 12px 24px; border: none; border-radius: 8px; background: #007bff; color: white; font-size: 14px; font-weight: 600; cursor: pointer; transition: background 0.2s;"
                        onmouseover="this.style.background='#0056b3';"
                        onmouseout="this.style.background='#007bff';">
                        확인
                    </button>
                </div>
            `;

            // 오버레이 (반투명 배경)
            const overlay = document.createElement('div');
            overlay.className = 'order-notification-overlay';
            overlay.style.cssText = `
                position: fixed !important;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10000;
                animation: fadeIn 0.3s ease-out;
            `;

            function closeModal() {
                overlay.style.animation = 'fadeOut 0.2s ease-in';
                popup.style.animation = 'modalZoomOut 0.2s ease-in';
                setTimeout(() => {
                    if (document.body.contains(overlay)) overlay.remove();
                    if (document.body.contains(popup)) popup.remove();
                }, 200);
            }

            overlay.onclick = (e) => {
                if (e.target === overlay) {
                    closeModal();
                }
            };

            document.body.appendChild(overlay);
            document.body.appendChild(popup);

            // 확인 버튼 클릭 시
            popup.querySelector('.order-confirm-btn').addEventListener('click', closeModal);

            // 사운드 재생
            playNotificationSound();

            // 10초 후 자동 닫기
            setTimeout(() => {
                if (document.body.contains(overlay)) {
                    closeModal();
                }
            }, 10000);
        }

        function playNotificationSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.value = 800;
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Sound play failed:', e);
            }
        }

        // CSS 애니메이션 추가
        const style = document.createElement('style');
        style.textContent = `
            @keyframes modalZoomIn {
                from {
                    transform: translate(-50%, -50%) scale(0.7);
                    opacity: 0;
                }
                to {
                    transform: translate(-50%, -50%) scale(1);
                    opacity: 1;
                }
            }
            @keyframes modalZoomOut {
                from {
                    transform: translate(-50%, -50%) scale(1);
                    opacity: 1;
                }
                to {
                    transform: translate(-50%, -50%) scale(0.7);
                    opacity: 0;
                }
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ========================================
        // 공지사항 기능 (Supabase 연동)
        // ========================================

        // Supabase 설정
        const SUPABASE_URL = 'https://zwjmfewyshhwpgwdtrus.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3am1mZXd5c2hod3Bnd2R0cnVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1NzE1NTEsImV4cCI6MjA3OTE0NzU1MX0.AJy34h5VR8QS6WFEcUcBeJJu8I3bBQ6UCk1I84Wb7y4';

        let supabaseClient;

        // Supabase 클라이언트 초기화
        function initSupabase() {
            if (typeof supabase !== 'undefined') {
                supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('✅ Supabase 클라이언트 초기화 완료 (Frontend)');
                loadNotices();
                loadAndRenderLearningContents(); // 학습 콘텐츠도 로드
                loadAndRenderFaqs(); // FAQ도 로드
            } else {
                console.warn('⚠️ Supabase 라이브러리가 로드되지 않았습니다.');
                setTimeout(initSupabase, 1000); // 1초 후 재시도
            }
        }

        // 공지사항 로드
        async function loadNotices() {
            console.log('📋 공지사항 로드 시작 (Frontend)');
            console.log('  - supabaseClient:', supabaseClient);
            console.log('  - URL:', SUPABASE_URL);

            try {
                if (!supabaseClient) {
                    throw new Error('Supabase 클라이언트가 초기화되지 않았습니다.');
                }

                console.log('📤 Supabase 쿼리 시작...');

                const { data, error } = await supabaseClient
                    .from('notices')
                    .select('*')
                    .order('important', { ascending: false })
                    .order('created_at', { ascending: false })
                    .limit(3);

                console.log('📥 Supabase 응답:');
                console.log('  - data:', data);
                console.log('  - error:', error);

                if (error) {
                    console.error('❌ Supabase 오류 상세:');
                    console.error('  - code:', error.code);
                    console.error('  - message:', error.message);
                    console.error('  - details:', error.details);
                    console.error('  - hint:', error.hint);
                    throw error;
                }

                console.log('✅ 공지사항 로드 성공:', data.length, '개');
                renderNotices(data);

            } catch (error) {
                console.error('❌ 공지사항 로드 오류:', error);
                const noticesList = document.getElementById('noticesList');
                if (noticesList) {
                    noticesList.innerHTML = `
                        <div style="text-align: center; padding: 20px; color: #dc3545; font-size: 12px;">
                            공지사항을 불러오는데 실패했습니다.<br>
                            <span style="font-size: 11px; color: #6c757d;">콘솔(F12)에서 오류를 확인하세요.</span>
                        </div>
                    `;
                }
            }
        }

        // 공지사항 렌더링
        function renderNotices(notices) {
            const noticesList = document.getElementById('noticesList');

            if (!noticesList) {
                console.error('❌ noticesList 요소를 찾을 수 없습니다.');
                return;
            }

            if (!notices || notices.length === 0) {
                noticesList.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #6c757d; font-size: 14px;">
                        등록된 공지사항이 없습니다.
                    </div>
                `;
                return;
            }

            noticesList.innerHTML = notices.map(notice => {
                // DOMPurify가 있으면 사용, 없으면 기본 텍스트만
                const safeTitle = typeof DOMPurify !== 'undefined'
                    ? DOMPurify.sanitize(notice.title, { ALLOWED_TAGS: [] })
                    : notice.title.replace(/</g, '&lt;').replace(/>/g, '&gt;');

                return `
                    <div class="notice-item" onclick="showNoticeDetail('${notice.id}', this)">
                        <span class="notice-bullet">●</span>
                        <div class="notice-title">
                            ${safeTitle}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 공지사항 상세 보기
        async function showNoticeDetail(noticeId, clickedElement) {
            console.log('📄 공지사항 상세 보기:', noticeId);

            try {
                if (!supabaseClient) {
                    throw new Error('Supabase 클라이언트가 초기화되지 않았습니다.');
                }

                const { data: notice, error } = await supabaseClient
                    .from('notices')
                    .select('*')
                    .eq('id', noticeId)
                    .single();

                if (error) throw error;

                // DOMPurify가 있으면 사용, 없으면 기본 텍스트만
                const safeTitle = typeof DOMPurify !== 'undefined'
                    ? DOMPurify.sanitize(notice.title, { ALLOWED_TAGS: [] })
                    : notice.title.replace(/</g, '&lt;').replace(/>/g, '&gt;');

                const safeContent = typeof DOMPurify !== 'undefined'
                    ? DOMPurify.sanitize(notice.content.replace(/\n/g, '<br>'), { ALLOWED_TAGS: ['br'] })
                    : notice.content.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n/g, '<br>');

                const createdDate = new Date(notice.created_at).toLocaleDateString('ko-KR');
                const importanceBadge = notice.important
                    ? '<span style="display: inline-block; background: #dc3545; color: white; padding: 2px 8px; border-radius: 4px; font-size: 11px; margin-left: 8px;">중요</span>'
                    : '';

                // 클릭한 공지사항 항목 위치 계산
                const rect = clickedElement.getBoundingClientRect();

                console.log('📍 클릭한 요소 위치:', {
                    top: rect.top,
                    left: rect.left,
                    width: rect.width,
                    height: rect.height
                });

                // 모달 생성
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed !important;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    z-index: 10000;
                `;

                const modal = document.createElement('div');

                // 모달 위치 계산
                const modalWidth = 600;

                // 가로: 공지사항 항목과 같은 위치 (왼쪽 정렬)
                let modalLeft = rect.left;

                // 오른쪽으로 화면 벗어나면 왼쪽으로 조정
                if (modalLeft + modalWidth > window.innerWidth - 20) {
                    modalLeft = window.innerWidth - modalWidth - 20;
                }

                // 왼쪽으로 너무 벗어나면 최소 여백 확보
                if (modalLeft < 20) {
                    modalLeft = 20;
                }

                // 세로: 공지사항 바로 옆(아래 또는 위)에 표시
                const idealModalHeight = 500; // 팝업 이상적인 높이
                const spaceBelow = window.innerHeight - rect.bottom - 20; // 아래쪽 여유 공간
                const spaceAbove = rect.top - 20; // 위쪽 여유 공간

                let modalTop;
                let modalMaxHeight;

                if (spaceBelow >= 300) {
                    // 아래쪽에 공간 있음 → 공지사항 바로 아래에 표시
                    modalTop = rect.bottom + 10;
                    modalMaxHeight = Math.min(idealModalHeight, spaceBelow - 10);
                } else if (spaceAbove >= 300) {
                    // 위쪽에 공간 있음 → 공지사항 바로 위에 표시
                    modalMaxHeight = Math.min(idealModalHeight, spaceAbove - 10);
                    modalTop = rect.top - modalMaxHeight - 10;
                } else {
                    // 양쪽 다 부족 → 더 큰 쪽에 표시
                    if (spaceBelow >= spaceAbove) {
                        modalTop = rect.bottom + 10;
                        modalMaxHeight = spaceBelow - 10;
                    } else {
                        modalMaxHeight = spaceAbove - 10;
                        modalTop = rect.top - modalMaxHeight - 10;
                    }
                }

                // 최소 높이 보장 (너무 작으면 화면 중앙)
                if (modalMaxHeight < 200) {
                    modalMaxHeight = 400;
                    modalTop = (window.innerHeight - modalMaxHeight) / 2;
                }

                console.log('📍 팝업 위치:', {
                    '클릭한 요소 top': rect.top,
                    '클릭한 요소 left': rect.left,
                    'modalLeft': modalLeft,
                    'modalTop': modalTop,
                    'modalWidth': modalWidth,
                    'modalMaxHeight': modalMaxHeight,
                    'window.innerHeight': window.innerHeight
                });

                modal.style.cssText = `
                    position: fixed !important;
                    left: ${modalLeft}px;
                    top: ${modalTop}px;
                    background: white;
                    border-radius: 12px;
                    max-width: 600px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
                `;

                modal.innerHTML = `
                    <div style="padding: 24px; border-bottom: 1px solid #dee2e6;">
                        <h3 style="margin: 0; font-size: 20px; color: #212529;">
                            📢 ${safeTitle}${importanceBadge}
                        </h3>
                        <div style="margin-top: 8px; font-size: 13px; color: #6c757d;">
                            작성일: ${createdDate}
                        </div>
                    </div>
                    <div style="padding: 24px; line-height: 1.6; color: #495057; font-size: 14px;">
                        ${safeContent}
                    </div>
                    <div style="padding: 16px 24px; border-top: 1px solid #dee2e6; text-align: right;">
                        <button onclick="this.closest('.notice-modal-overlay').remove()"
                                style="padding: 8px 24px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">
                            닫기
                        </button>
                    </div>
                `;

                overlay.className = 'notice-modal-overlay';
                overlay.appendChild(modal);
                overlay.onclick = (e) => {
                    if (e.target === overlay) {
                        overlay.remove();
                    }
                };

                document.body.appendChild(overlay);

            } catch (error) {
                console.error('❌ 공지사항 상세 조회 오류:', error);
                alert('공지사항을 불러오는데 실패했습니다.');
            }
        }

        // ================================================
        // 학습용 콘텐츠 관련 기능
        // ================================================

        // 전역 변수: 학습 콘텐츠 데이터
        let allLearningContents = [];

        /**
         * 학습 콘텐츠 로드 및 렌더링
         */
        async function loadAndRenderLearningContents() {
            console.log('📚 학습 콘텐츠 로드 시작 (Frontend)');

            try {
                if (!supabaseClient) {
                    console.warn('⚠️ Supabase 클라이언트가 아직 초기화되지 않았습니다. 재시도 중...');
                    setTimeout(loadAndRenderLearningContents, 1000);
                    return;
                }

                const { data, error } = await supabaseClient
                    .from('learning_contents')
                    .select('*')
                    .order('depth1')
                    .order('depth2')
                    .order('display_order');

                if (error) throw error;

                console.log('✅ 학습 콘텐츠 로드 성공:', data.length, '개');

                // 전역 변수에 저장
                allLearningContents = data;

                // 트리 렌더링
                renderLearningContentsTree(data);

            } catch (error) {
                console.error('❌ 학습 콘텐츠 로드 오류:', error);
                // 오류 시 기존 하드코딩된 데이터 유지
            }
        }

        /**
         * 학습 콘텐츠 트리 렌더링
         */
        function renderLearningContentsTree(contents) {
            const treeContainer = document.getElementById('learningContentsTree');
            if (!treeContainer) return;

            // depth1별로 그룹화
            const depth1Groups = {};
            contents.forEach(item => {
                if (!depth1Groups[item.depth1]) {
                    depth1Groups[item.depth1] = [];
                }
                depth1Groups[item.depth1].push(item);
            });

            let html = '';

            Object.keys(depth1Groups).sort().forEach(depth1Name => {
                const depth1Items = depth1Groups[depth1Name];

                // depth2별로 그룹화
                const depth2Groups = {};
                depth1Items.forEach(item => {
                    if (item.depth2) {
                        if (!depth2Groups[item.depth2]) {
                            depth2Groups[item.depth2] = [];
                        }
                        depth2Groups[item.depth2].push(item);
                    }
                });

                html += `
                    <div class="knowledge-item">
                        <div class="knowledge-major" onclick="toggleKnowledge(this)">
                            <span class="knowledge-icon"></span>
                            <span class="knowledge-name">${depth1Name}</span>
                            <span class="knowledge-arrow">▶</span>
                        </div>
                        <div class="knowledge-medium-list">
                `;

                // depth2 렌더링
                Object.keys(depth2Groups).sort().forEach(depth2Name => {
                    const depth2Items = depth2Groups[depth2Name];

                    html += `
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>${depth2Name}</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                    `;

                    // depth3 렌더링
                    depth2Items
                        .filter(item => item.depth3)
                        .sort((a, b) => (a.display_order || 0) - (b.display_order || 0))
                        .forEach(item => {
                            const url = item.url || '#';
                            html += `
                                <div class="knowledge-small">
                                    <span class="knowledge-small-bullet">●</span>
                                    <span><a href="${url}" target="_blank" style="color: inherit; text-decoration: none;">${item.depth3}</a></span>
                                </div>
                            `;
                        });

                    html += `
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            });

            treeContainer.innerHTML = html;
        }

        /**
         * 학습 콘텐츠 검색 (실시간)
         */
        function searchLearningContents(query) {
            const searchInput = document.getElementById('learningSearchInput');
            const searchResults = document.getElementById('learningSearchResults');
            const contentsTree = document.getElementById('learningContentsTree');

            if (!query || query.trim() === '') {
                // 검색어 없으면 원래 트리 표시
                searchResults.style.display = 'none';
                contentsTree.style.display = 'block';

                // 검색창 스타일 초기화
                searchInput.style.borderColor = '#dee2e6';
                searchInput.style.boxShadow = 'none';
                return;
            }

            // 검색창 스타일 변경
            searchInput.style.borderColor = '#F59E0B';
            searchInput.style.boxShadow = '0 0 0 2px rgba(245, 158, 11, 0.1)';

            // 검색어로 필터링
            const searchTerm = query.toLowerCase();
            const results = allLearningContents.filter(item => {
                return (item.depth1 && item.depth1.toLowerCase().includes(searchTerm)) ||
                       (item.depth2 && item.depth2.toLowerCase().includes(searchTerm)) ||
                       (item.depth3 && item.depth3.toLowerCase().includes(searchTerm)) ||
                       (item.description && item.description.toLowerCase().includes(searchTerm));
            });

            // 검색 결과 렌더링
            if (results.length === 0) {
                searchResults.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #6c757d; font-size: 13px;">
                        검색 결과가 없습니다.
                    </div>
                `;
            } else {
                let html = `
                    <div style="margin-bottom: 12px; padding: 8px; background: rgba(245, 158, 11, 0.08); border-radius: 6px; font-size: 12px; color: #495057;">
                        🔍 검색 결과 (${results.length}개)
                        <button onclick="clearSearch()" style="float: right; background: none; border: none; cursor: pointer; color: #6c757d; font-size: 16px;">×</button>
                    </div>
                    <div style="max-height: 400px; overflow-y: auto;">
                `;

                results.forEach(item => {
                    if (item.depth3) {
                        const url = item.url || '#';
                        html += `
                            <div style="padding: 8px; margin-bottom: 6px; background: white; border: 1px solid #dee2e6; border-radius: 4px; font-size: 12px;">
                                <div style="font-weight: 700; color: #212529; margin-bottom: 2px;">
                                    <a href="${url}" target="_blank" style="color: inherit; text-decoration: none;">${item.depth3}</a>
                                </div>
                                <div style="font-size: 11px; color: #6c757d;">
                                    📂 ${item.depth1} > ${item.depth2}
                                </div>
                            </div>
                        `;
                    }
                });

                html += `</div>`;
                searchResults.innerHTML = html;
            }

            // 검색 결과 표시, 트리 숨김
            searchResults.style.display = 'block';
            contentsTree.style.display = 'none';
        }

        /**
         * 검색 초기화
         */
        function clearSearch() {
            const searchInput = document.getElementById('learningSearchInput');
            searchInput.value = '';
            searchLearningContents('');
        }

        // ================================================
        // FAQ 관련 기능
        // ================================================

        // 전역 변수: FAQ 데이터
        let allFaqs = [];

        /**
         * FAQ 로드 및 렌더링
         */
        async function loadAndRenderFaqs() {
            console.log('🙋 FAQ 로드 시작 (Frontend)');

            const loadingEl = document.getElementById('faqLoading');
            const containerEl = document.getElementById('faqContainer');

            try {
                if (!supabaseClient) {
                    console.warn('⚠️ Supabase 클라이언트가 아직 초기화되지 않았습니다. 재시도 중...');
                    setTimeout(loadAndRenderFaqs, 1000);
                    return;
                }

                const { data, error } = await supabaseClient
                    .from('faqs')
                    .select('*')
                    .order('depth1')
                    .order('depth2')
                    .order('depth3');

                if (error) throw error;

                console.log('✅ FAQ 로드 성공:', data.length, '개');

                // 전역 변수에 저장
                allFaqs = data;

                // 트리 렌더링
                renderFaqTree(data);

                // 로딩 메시지 숨기기
                if (loadingEl) loadingEl.style.display = 'none';

            } catch (error) {
                console.error('❌ FAQ 로드 오류:', error);

                // 오류 메시지 표시
                if (containerEl) {
                    containerEl.innerHTML = `
                        <div style="padding: 12px; text-align: center; color: #dc3545; font-size: 13px;">
                            ❌ FAQ를 불러오는데 실패했습니다.<br/>
                            <small>${error.message}</small>
                        </div>
                    `;
                }
                if (loadingEl) loadingEl.style.display = 'none';
            }
        }

        /**
         * FAQ 트리 렌더링
         */
        function renderFaqTree(faqs) {
            const containerEl = document.getElementById('faqContainer');
            if (!containerEl) return;

            // depth1별로 그룹화
            const depth1Groups = {};
            faqs.forEach(item => {
                if (!depth1Groups[item.depth1]) {
                    depth1Groups[item.depth1] = [];
                }
                depth1Groups[item.depth1].push(item);
            });

            let html = '';

            Object.keys(depth1Groups).sort().forEach(depth1Name => {
                const depth1Items = depth1Groups[depth1Name];

                // depth2별로 그룹화
                const depth2Groups = {};
                depth1Items.forEach(item => {
                    if (item.depth2) {
                        if (!depth2Groups[item.depth2]) {
                            depth2Groups[item.depth2] = [];
                        }
                        depth2Groups[item.depth2].push(item);
                    }
                });

                html += `
                    <div class="knowledge-item">
                        <div class="knowledge-major" onclick="toggleKnowledge(this)">
                            <span class="knowledge-icon"></span>
                            <span class="knowledge-name">${depth1Name}</span>
                            <span class="knowledge-arrow">▶</span>
                        </div>
                        <div class="knowledge-medium-list">
                `;

                // depth2 렌더링
                Object.keys(depth2Groups).sort().forEach(depth2Name => {
                    const depth2Items = depth2Groups[depth2Name];

                    html += `
                        <div class="knowledge-medium" onclick="toggleKnowledgeSmall(this)">
                            <div class="knowledge-medium-content">
                                <span class="knowledge-medium-bullet">●</span>
                                <span>${depth2Name}</span>
                            </div>
                            <span class="knowledge-medium-arrow">▶</span>
                        </div>
                        <div class="knowledge-small-list">
                    `;

                    // depth3 렌더링 (질문 클릭 시 답변 모달)
                    depth2Items
                        .filter(item => item.depth3)
                        .sort((a, b) => (a.depth3 || '').localeCompare(b.depth3 || ''))
                        .forEach(item => {
                            html += `
                                <div class="knowledge-small" onclick="showFaqAnswer('${item.id}')" style="cursor: pointer;">
                                    <span class="knowledge-small-bullet">●</span>
                                    <span>${item.depth3}</span>
                                </div>
                            `;
                        });

                    html += `
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            });

            containerEl.innerHTML = html;
        }

        /**
         * FAQ 답변 모달 표시
         */
        async function showFaqAnswer(faqId) {
            try {
                // 전역 변수에서 FAQ 찾기
                const faq = allFaqs.find(f => f.id === faqId);

                if (!faq) {
                    alert('FAQ를 찾을 수 없습니다.');
                    return;
                }

                // DOMPurify로 HTML 정화
                const safeAnswer = DOMPurify.sanitize(faq.answer);

                // 모달 생성
                const overlay = document.createElement('div');
                const modal = document.createElement('div');

                modal.innerHTML = `
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px 24px; display: flex; justify-content: space-between; align-items: center; border-radius: 12px 12px 0 0;">
                        <div>
                            <div style="font-size: 18px; font-weight: 700; color: white; margin-bottom: 4px;">
                                ${faq.depth3}
                            </div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.9);">
                                📂 ${faq.depth1} > ${faq.depth2}
                            </div>
                        </div>
                        <button onclick="this.closest('.faq-modal-overlay').remove()"
                                style="background: rgba(255, 255, 255, 0.2); border: none; color: white; font-size: 24px; cursor: pointer; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'"
                                onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'">
                            ×
                        </button>
                    </div>
                    <div style="padding: 24px; line-height: 1.8; color: #495057; font-size: 14px; max-height: 60vh; overflow-y: auto;">
                        ${safeAnswer}
                    </div>
                    <div style="padding: 16px 24px; border-top: 1px solid #dee2e6; text-align: right; background: #f8f9fa;">
                        <button onclick="this.closest('.faq-modal-overlay').remove()"
                                style="padding: 10px 24px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; transition: all 0.2s;"
                                onmouseover="this.style.background='#5a6268'"
                                onmouseout="this.style.background='#6c757d'">
                            닫기
                        </button>
                    </div>
                `;

                overlay.className = 'faq-modal-overlay';
                overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); display: flex; align-items: center; justify-content: center; z-index: 10000;';

                modal.style.cssText = 'background: white; border-radius: 12px; max-width: 700px; width: 90%; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);';

                overlay.appendChild(modal);
                overlay.onclick = (e) => {
                    if (e.target === overlay) {
                        overlay.remove();
                    }
                };

                document.body.appendChild(overlay);

            } catch (error) {
                console.error('❌ FAQ 답변 표시 오류:', error);
                alert('FAQ 답변을 불러오는데 실패했습니다.');
            }
        }

        // 페이지 로드 시 Supabase 초기화
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initSupabase);
        } else {
            initSupabase();
        }

        // ========== Mobile Responsive Functions ==========

        // Mobile sidebar toggle functionality
        (function() {
            let sidebarState = 'both'; // 'both', 'left', 'right', 'none'

            function initMobileSidebar() {
                // Create toggle button if it doesn't exist
                if (!document.querySelector('.mobile-sidebar-toggle')) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.className = 'mobile-sidebar-toggle';
                    toggleBtn.innerHTML = '☰';
                    toggleBtn.setAttribute('aria-label', '사이드바 토글');
                    toggleBtn.addEventListener('click', toggleSidebars);
                    document.body.appendChild(toggleBtn);
                }

                // Handle window resize
                window.addEventListener('resize', handleResize);
                handleResize();
            }

            function toggleSidebars() {
                const leftSidebar = document.querySelector('.left-sidebar');
                const rightSidebar = document.querySelector('.right-sidebar');
                const toggleBtn = document.querySelector('.mobile-sidebar-toggle');

                switch(sidebarState) {
                    case 'both':
                        // Show both -> Hide both
                        leftSidebar.classList.add('collapsed');
                        rightSidebar.classList.add('collapsed');
                        toggleBtn.innerHTML = '◀▶';
                        toggleBtn.setAttribute('aria-label', '사이드바 모두 표시');
                        sidebarState = 'none';
                        break;
                    case 'none':
                        // Hide both -> Show left only
                        leftSidebar.classList.remove('collapsed');
                        rightSidebar.classList.add('collapsed');
                        toggleBtn.innerHTML = '◀';
                        toggleBtn.setAttribute('aria-label', '우측 사이드바 표시');
                        sidebarState = 'left';
                        break;
                    case 'left':
                        // Show left -> Show right only
                        leftSidebar.classList.add('collapsed');
                        rightSidebar.classList.remove('collapsed');
                        toggleBtn.innerHTML = '▶';
                        toggleBtn.setAttribute('aria-label', '좌측 사이드바 표시');
                        sidebarState = 'right';
                        break;
                    case 'right':
                        // Show right -> Show both
                        leftSidebar.classList.remove('collapsed');
                        rightSidebar.classList.remove('collapsed');
                        toggleBtn.innerHTML = '☰';
                        toggleBtn.setAttribute('aria-label', '사이드바 숨기기');
                        sidebarState = 'both';
                        break;
                }
            }

            function handleResize() {
                const leftSidebar = document.querySelector('.left-sidebar');
                const rightSidebar = document.querySelector('.right-sidebar');
                const toggleBtn = document.querySelector('.mobile-sidebar-toggle');

                if (window.innerWidth > 768) {
                    // Desktop mode
                } else {
                    // Mobile: Hide all sidebars initially
                    if (leftSidebar) leftSidebar.classList.remove('open');
                    if (rightSidebar) rightSidebar.classList.remove('open');
                    sidebarState = 'none';
                }
                if (window.innerWidth > 768) {
                    // Desktop: Show all sidebars, hide toggle
                    if (leftSidebar) leftSidebar.classList.remove('collapsed');
                    if (rightSidebar) rightSidebar.classList.remove('collapsed');
                    sidebarState = 'both';
                    if (toggleBtn) toggleBtn.innerHTML = '☰';
                }
            }

            // Initialize when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initMobileSidebar);
            } else {
                initMobileSidebar();
            }
        })();

        // ========== 사이드바 토글 시스템 ========== //
        function toggleLeftSidebar() {
            const leftSidebar = document.querySelector('.left-sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            if (leftSidebar.classList.contains('open')) {
                closeLeftSidebar();
            } else {
                closeRightSidebar();
                leftSidebar.classList.add('open');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeLeftSidebar() {
            const leftSidebar = document.querySelector('.left-sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            leftSidebar.classList.remove('open');
            const rightSidebar = document.querySelector('.right-sidebar');
            if (!rightSidebar.classList.contains('open')) {
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        function toggleRightSidebar() {
            const rightSidebar = document.querySelector('.right-sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            if (rightSidebar.classList.contains('open')) {
                closeRightSidebar();
            } else {
                closeLeftSidebar();
                rightSidebar.classList.add('open');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeRightSidebar() {
            const rightSidebar = document.querySelector('.right-sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            rightSidebar.classList.remove('open');
            const leftSidebar = document.querySelector('.left-sidebar');
            if (!leftSidebar.classList.contains('open')) {
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        function closeAllSidebars() {
            const leftSidebar = document.querySelector('.left-sidebar');
            const rightSidebar = document.querySelector('.right-sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            leftSidebar.classList.remove('open');
            rightSidebar.classList.remove('open');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeAllSidebars();
        });
    </script>

    <!-- FAB 컨테이너 -->
    <div class="fab-container">
        <button class="fab-btn fab-menu" onclick="toggleLeftSidebar()">◀</button>
        <button class="fab-btn fab-info" onclick="toggleRightSidebar()">▶</button>
    </div>
</body>

</html>
