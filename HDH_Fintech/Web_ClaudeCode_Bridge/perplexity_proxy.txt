// Perplexity API ì—”ë“œí¬ì¸íŠ¸
app.post('/perplexity/ask', async (req, res) => {
    try {
        const { question } = req.body;

        if (!question) {
            return res.status(400).json({
                success: false,
                error: 'ì§ˆë¬¸ì´ í•„ìš”í•©ë‹ˆë‹¤.'
            });
        }

        console.log('ğŸ”® Perplexity ì§ˆë¬¸:', question.substring(0, 50) + '...');

        // AI_Link ì„œë²„ë¡œ í”„ë¡ì‹œ
        const aiResponse = await fetch('http://localhost:3031/ask-perplexity', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question })
        });

        const result = await aiResponse.json();

        if (result.success) {
            console.log('âœ… Perplexity ì‘ë‹µ ì„±ê³µ');
            res.json({
                success: true,
                question: question,
                answer: result.answer,
                timestamp: new Date().toISOString()
            });
        } else {
            throw new Error(result.error || 'Perplexity API ì˜¤ë¥˜');
        }

    } catch (error) {
        console.error('âŒ Perplexity API ì˜¤ë¥˜:', error.message);
        res.status(500).json({
            success: false,
            error: error.message
        });
    }
});
